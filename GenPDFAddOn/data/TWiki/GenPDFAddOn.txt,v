head	1.18;
access;
symbols;
locks
	apache:1.18; strict;
comment	@# @;


1.18
date	2005.06.13.23.04.55;	author WadeTurland;	state Exp;
branches;
next	1.17;

1.17
date	2005.06.13.21.23.25;	author WadeTurland;	state Exp;
branches;
next	1.16;

1.16
date	2005.06.13.16.39.14;	author WadeTurland;	state Exp;
branches;
next	1.15;

1.15
date	2005.04.12.16.03.31;	author BrianSpinar;	state Exp;
branches;
next	1.14;

1.14
date	2005.04.08.00.45.21;	author BrianSpinar;	state Exp;
branches;
next	1.13;

1.13
date	2005.03.23.01.27.04;	author BrianSpinar;	state Exp;
branches;
next	1.12;

1.12
date	2005.03.22.23.20.31;	author BrianSpinar;	state Exp;
branches;
next	1.11;

1.11
date	2005.02.08.20.23.40;	author BrianSpinar;	state Exp;
branches;
next	1.10;

1.10
date	2005.02.08.18.58.38;	author BrianSpinar;	state Exp;
branches;
next	1.9;

1.9
date	2005.02.02.19.57.19;	author BrianSpinar;	state Exp;
branches;
next	1.8;

1.8
date	2005.02.02.18.05.01;	author BrianSpinar;	state Exp;
branches;
next	1.7;

1.7
date	2005.01.31.05.09.29;	author BrianSpinar;	state Exp;
branches;
next	1.6;

1.6
date	2005.01.31.03.44.42;	author BrianSpinar;	state Exp;
branches;
next	1.5;

1.5
date	2005.01.31.02.53.32;	author BrianSpinar;	state Exp;
branches;
next	1.4;

1.4
date	2005.01.31.02.16.50;	author BrianSpinar;	state Exp;
branches;
next	1.3;

1.3
date	2005.01.30.22.48.03;	author BrianSpinar;	state Exp;
branches;
next	1.2;

1.2
date	2005.01.30.06.50.41;	author BrianSpinar;	state Exp;
branches;
next	1.1;

1.1
date	2005.01.30.05.51.27;	author BrianSpinar;	state Exp;
branches;
next	;


desc
@none
@


1.18
log
@none
@
text
@%META:TOPICINFO{author="WadeTurland" date="1118703895" format="1.0" version="1.18"}%
<!-- PDFSTART -->
---+!! Generate PDF Add-On
<!-- PDFSTOP -->
%TOC%
<!-- PDFSTART -->

This is substantial re-write of the TWiki:Codev.PrintUsingPDF pdf script. It essentially accomplishes the same goal but with more integration with TWiki (e.g. use of TWiki variables for configuration and the TWiki rendering methods instead of using a hacked version of the =TWiki::view= for generating HTML) as well as more modular code structure (i.e. most of the logic is moved to a perl package).

We began using the TWiki:Codev.PrintUsingPDF pdf script to publish pages but found it somewhat TWiki unfriendly (no offense to the authors as it's a great idea). This version allows most of the script configuration (such as page size, table of contents, etc.) via preference variables in TWiki. It also allows header, footer, and title page configuration via TWiki topics.

This add-on has only been tried with the Cairo version of TWiki. We've made no attempt to determine if it will run on earlier versions. We've been running it in-house at my company for a while (and it seems to work fairly well), but it has obviously not undergone any significant level of testing.

---++ Usage

	* Like the TWiki:Codev.PrintUsingPDF pdf script, a page can be published by substituting =genpdf= for =view= in the topic URL.
	* To make it even easier for novice TWiki users to use, we added a link (like edit and attach) to our =view.tmpl= to publish the current page (using the current topic as the document title). The line we added to our template is:
		* =&lt;a href="%<nop>SCRIPTURLPATH%/genpdf%<nop>SCRIPTSUFFIX%/%<nop>WEB%/%<nop>TOPIC%?pdftitle=%<nop>TOPIC%"&gt;PDF&lt;/a&gt;=
	* You may also choose to replace the Printable (?skin=print) targets in your favourite skin with
<verbatim>
[[%SCRIPTURL%/genpdf/%WEB%/%TOPIC%][Printable]]
</verbatim>

---++ Configuring the Script

The script can be configured either via URL parameters or web preference variables. URL parameters have precedence over web preference variables. If neither of these are present, the script will use hard-coded default variables. The general script configuration variables are explained in the next section while header/footer and title page configuration are explained in subsequent sections.

---+++ General Configuration

The following table shows the various configuration variables and their meaning. The first column gives the variable to use if passed in the URL. The second column shows the variable to use if using a TWiki preference variable (i.e. Set VARIABLE = ). The third column gives the default value if neither the URL nor TWiki preference variable is used. Note that URL variables have precedence over TWiki preference variables. For a more detailed description of the HTMLDOC related variables, see the HTMLDOC documentation at http://www.htmldoc.org.

%TABLE{ cellpadding="3" columnwidths="15%, 15%, 15%, 15%, 40%"}%
| *URL Variable* | *Twiki Preference Variable* | *Default Value* | *Example* | *Explanation* |
| =pdfbanner= | GENPDFADDON_BANNER | | Foobar Documentation System | Used to override the banner of a title page. |
| =pdftitle= | GENPDFADDON_TITLE | | Writing Foobars | |
| =pdfsubtitle= | GENPDFADDON_SUBTITLE | | A short guide to creating foobar documents | |
| =pdfheadertopic= | GENPDFADDON_HEADERTOPIC | | !GenPDFHeaderFooterTopic | The name of a topic that defines headers and footers using &lt;-- HEADER LEFT "foobar" --> syntax |
| =pdftitletopic= | GENPDFADDON_TITLETOPIC | | !GenPDFTitleTopic | The name of a topic that defines the layout of the title page |
| =skin= | GENPDFADDON_SKIN | =print.pattern= | =print.nat= | Default skin to use for PDF generation |
| =pdfformat= | GENPDFADDON_FORMAT | =pdf14= | =pdf12= | HTMLDOC output format |
| =pdftoclevels= |GENPDFADDON_TOCLEVELS | =5= | =3= | Number of levels to include in the PDF table of contents (use 0 to disable the generation of a table of contents). Note that HTMLDOC generates a table of contents based on HTML headers in the page. |
| =pdfpagesize= | GENPDFADDON_PAGESIZE | =a4= | =letter= | The page size for PDF output |
| =pdforientation= | GENPDFADDON_ORIENTATION | =portrait= | =landscape= | The page orientation (e.g. landscape or portrait) |
| =pdfwidth= | GENPDFADDON_WIDTH | =860= | =1060= | The pixel width of the browser (used to scale images--images wider than this will be truncated) |
| =pdfheadershift= | GENPDFADDON_HEADERSHIFT | =0= | =+3= | Shift all headers up or down (for negative values) by this amount (e.g. H1 would become H3 for a value of 2). |
| =pdfkeywords= | GENPDFADDON_KEYWORDS | =%<nop>FORMFIELD{"KeyWords"}%= | 'foo, bar, baz, zip' | Used for PDF Keywords META info to help search engines |
| =pdfsubject= | GENPDFADDON_SUBJECT | =%<nop>FORMFIELD{"TopicHeadline"}%= | 'Foobar document creation' | Used for PDF Subject META info to help search engines |
| =pdftocheader= | GENPDFADDON_TOCHEADER | =...= | =l..= | See http://www.htmldoc.org/ |
| =pdftocfooter= | GENPDFADDON_TOCFOOTER | =..i= | =.i.= | See http://www.htmldoc.org/ |
| =pdfheadfootfont= | GENPDFADDON_HEADFOOTFONT | | Helvetica-Bold | Font specification for headers and footers. |
| =pdflogoimage= | GENPDFADDON_LOGOIMAGE | | http:<nop>//my.server.com/path/to/logo.jpeg | The logo that will appear in a header or footer if you specify 'l' in the string (see http://www.htmldoc.org) |
| =pdfnumberedtoc= | GENPDFADDON_NUMBEREDTOC | =undef= | True | Option flag for getting numbered headings and Table of Contents. Set it to anything for true. |
| =pdfpermissions= | GENPDFADDON_PERMISSIONS | =undef= | print,no-copy | PDF Security permissions to disable print/copy etc. By default the PDF is not protected. |
| =pdfmargins= | GENPDFADDON_MARGINS | =undef= | =top:0.5in,bottom:2.5cm,left:12pt,right:15mm= | Specify the page margins (white space to edge of page) |

If using TWiki preference variables, copy them to the appropriate web preferences page.

%SEARCH{"GENPDFADDON_" topic="%TOPIC%" type="literal" casesensitive="on" limit="21" nosearch="on" nosummary="on" header="	* Settings for the %TWIKIWEB%.%TOPIC% Plugin" nototal="on" multiple="on" format="		* #Set $pattern(.*(G.*?N_.*? ).*) = "}%

---+++ Limiting the PDF Generation Region

The add-on allows the user to define the region of the topic that should be included in the PDF generation (much like the TWiki %<nop>STARTINCLUDE% and %<nop>STOPINCLUDE% variables. In this case, HTML comments are used instead. Everything between these two comments will be included in the PDF generation. The rest of topic will be excluded.

	* Use =&lt;!-- PDFSTART --&gt;= to mark the starting point in the topic for PDF generation.
	* Use =&lt;!-- PDFSTOP --&gt;= to mark the stopping point in the topic for PDF generation.

Note that there can be multiple PDFSTART and PDFSTOP comment pairs in a single topic to selectively include/exclude multiple sections of the topic in the PDF document. (If you view this page in =raw= mode or edit it, you'll see an example of multiple PDFSTART/PDFSTOP sections to exclude the TWiki table of contents). If no PDFSTART/PDFSTOP comment pair appears in the topic, the entire topic text is used. In general, this should not be a problem except for title topics that include forms as the form meta-data will show up in a fairly illegible manner at the end of the document. Therefore, for topics that reference forms, a PDFSTART comment should be placed at the beginning of the topic and a PDFSTOP should be placed at the end.

%T% __NOTE:__ all %META: tags are removed from the base topic. If you want to display form data, you should add %<nop>FORMFIELD{"field"}% tags to the topic or title topic.

---+++ Creating and Configuring a Title Page

The add-on allows the user to use a topic as a title page for PDF generation. Earlier versions of the add-on required that the title page be expressed using pure HTML as the title page topic was not TWiki rendered. The latest version of add-on, however, does full TWiki rendering of the title topic page like any other TWiki topic. In addition, the following variables can be passed with the URL to override their settings elsewhere (e.g. in the web preferences or TWiki preferences pages).

Also note that the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of title topic. An example title page can be found at GenPDFExampleTitleTopic.

---+++ Creating and Configuring Headers and Footers

The add-on also allows the user to configure header and footer formats for both the main section of the document and the table of contents. Configuring the main header and footer is much like configuring a title page. You can select a TWiki topic to use for the header and footer. Remember to wrap the HTML comments that HTMLDOC uses for the header and footer between &lt;!-- PDFSTART --&gt; and &lt;!-- PDFSTOP --&gt; tags. The add-on will perform TWiki common variable substition within the HTMLDOC header/footer HTML comments. This will allow TWiki variables (such as %<nop>REVINFO{web="%<nop>WEB%" topic="%<nop>BASETOPIC%"}%) to be embedded in the headers and footers.

See the HTMLDOC documentation at http://www.htmldoc.org for details of the format of the header and footers. In addition, the =genpdf= script will perform variable substition for the %<nop>GENPDFADDON _BANNER%, %<nop>GENPDFADDON _TITLE%, and %<nop>GENPDFADDON _SUBTITLE% variables as it does for the title page. Finally, the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of header/footer topic. An example header/footer page can be found at GenPDFExampleHeaderFooterTopic.

---++ Add-On Installation Instructions

__Note:__ You do not need to install anything on the browser to use this add-on. The following instructions are for the administrator who installs the add-on on the server where TWiki is running. 

	* Download the ZIP file from the Add-on Home (see below)
	* Unzip ==%TOPIC%.zip== in your twiki installation directory. Content:
	  | *File:* | *Description:* |
	  | ==data/TWiki/%TOPIC%.txt== | Add-on topic |
	  | ==data/TWiki/%TOPIC%.txt,v== | Add-on topic repository |
	  | ==data/TWiki/GenPDFExampleTitleTopic.txt== | Example title topic |
	  | ==data/TWiki/GenPDFExampleTitleTopic.txt,v== | Example title topic repository |
	  | ==data/TWiki/GenPDFExampleHeaderFooterTopic.txt== | Example header and footer topic |
	  | ==data/TWiki/GenPDFExampleHeaderFooterTopic.txt,v== | Example header and footer topic repository |
	  | ==bin/genpdf== | Add-on script |
	  | ==lib/TWiki/Contrib/GenPDF.pm== | Add-on perl package |
	* Adjust the script ownership to match your webserver configuration (e.g. =chown nobody genpdf=) if needed.
	* Make sure the script is executable (e.g =chmod 755 genpdf=).
	* *Adjust the perl path in the genpdf script to match your perl installation location.*
	* %X% Add the variable =$htmldocCmd = /path/to/htmldoc;= to your =lib/TWiki.cfg= file so TWiki can find the location of the htmldoc executable. Look for $fgrepCmd.
	* Test if the installation was successful:
		* If it doesn't work, check your webserver logs for any problems. The most common issue is probably an htmldoc installation problem.

---++ Known Bugs
	* Comments in the header/footer topic must be separated by newlines.
	* *Verbatim text runs off the page.* This is a limitation of HTMLDOC. Preformatted text may run off the edge of the page and be truncated.
	* *HTMLDOC crashes with segmentation faults.* Eg it fails to generate TWiki.TWikiDocumentation. I managed to get it to work a few times, but it generally fails. The error returned is =Conversion failed: 'Inappropriate ioctl for device' at /var/www/twiki/lib/TWiki/Contrib/GenPDF.pm line XXX=
	* *Some pages don't have a header.* HTMLDOC breaks the page for every level 1 heading (Eg. &lt;h1&gt;) but it doesn't write a header for the new page, so topics with lots of level 1 headings and not much content don't seem to have any headers. Therefore I patched htmldoc-1.8.24 to force a header for every new page:
<verbatim>
*** htmldoc-1.8.24/htmldoc/ps-pdf.cxx	Sat Oct 30 05:53:59 2004
--- htmldoc-1.8.24/htmldoc/ps-pdf_force_header.cxx		Tue Jun 13 02:12:28 2005
***************
*** 1465,1471 ****

		pspdf_prepare_heading(page, print_page, pages[page].header, top,
									 page_text, sizeof(page_text),
!								 page > chapter_starts[chapter] ||
										OutputType != OUTPUT_BOOK);
		pspdf_prepare_heading(page, print_page, pages[page].footer, 0,
									 page_text, sizeof(page_text));
--- 1465,1472 ----

		pspdf_prepare_heading(page, print_page, pages[page].header, top,
									 page_text, sizeof(page_text),
! /*							 page > chapter_starts[chapter] || */
!								 1 || /* force heading onto chapter front page */
										OutputType != OUTPUT_BOOK);
		pspdf_prepare_heading(page, print_page, pages[page].footer, 0,
									 page_text, sizeof(page_text));
</verbatim>

---++ Add-On History
	* Version 0.4 (13 Jun 2005)
		* Better security (now calls =system($TWiki::htmldocCmd, @@htmldocArgs)= )
		* Checks return code of htmldoc and returns an error on failure
		* Validation of preferences
		* %X% Preferences changed to comply with TWikiPlugins standard
		* Better HTML3.2 compatibility for htmldoc 1.8.24 (downgrades a few elements)
		* Full integration of PDF META tags (optionally using 2 FORMFIELDs):
			* ==%<nop>FORMFIELD{"Topic<nop>Headine"}%== for PDF Subject field
			* ==%<nop>FORMFIELD{"Key<nop>Words"}%== for PDF Keywords field
			* all other PDF fields use topic info
		* More htmldoc options (margins, permissions, numbered TOC, logoimage, headfootfont) using preferences
		* Removed ==%<nop>TOC%== fields so it only uses HTMLDOC's TOC
		* Title topic _and_ header/footer topics are now fully rendered
		* Fixed the heading shifting function
		* Fully qualify links, making the document portable
		* HTMLDOC output goes to a temp file instead of stdout
		* Temp files now use 'GenPDFAddOn' prefix. (Eg. /tmp/GenPDFAddOn1wr3C48ibd.html)
	* Version 0.3 (12 Apr 2005)
		* Added full TWiki rendering to title topic page
		* Added TWiki common variable expansion to header/footer topic page
	* Version 0.2 (26 Mar 2005)
		* Fixed bug with table of contents generation (i.e. it was always generated even if =pdftoclevels= was set to 0)
		* Now allow multiple =PDFSTART/PDFSTOP= pairs within a single page to include/exclude multiple sections of the same page
		* Added Main.BrentRoberts fix to allow operation with latest version (1.8.24) of HTMLDOC
	* Version 0.1 (30 Jan 2005)
		* Initial version

---++ Add-On Info

|  Add-on Author: | TWiki:Main/BrianSpinar, TWiki:Main/WadeTurland |
|  Add-on Version: | 13 Jun 2005 (v0.4) |
|  Change History: | See Add-On History section above |
|  CPAN Dependencies: | File::Temp (if for some reason you don't already have it installed ) |
|  Other Dependencies: | HTMLDOC (http://www.htmldoc.org) |
|  Perl Version: | 5.005 or above |
|  License: | GPL |
|  Add-on Home: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC% |
|  Feedback: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev |
|  Appraisal: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal |


__Related Topic:__ %TWIKIWEB%.TWikiAddOns
<!-- PDFSTOP -->

-- TWiki:Main/WadeTurland - 13 Jun 2005%BR%
-- TWiki:Main/BrianSpinar - 12 Apr 2005

@


1.17
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="WadeTurland" date="1118697805" format="1.0" version="1.17"}%
d51 3
a53 3
| =pdflogoimage= | GENPDFADDON_LOGOIMAGE | | http://my.server.com/path/to/logo.jpeg | The logo that will appear in a header or footer if you specify 'l' in the string (see http://www.htmldoc.org) |
| =pdfnumberedtoc= | GENPDFADDON_NUMBEREDTOC | =undef= | True | Option flag for getting numbered headings and Table of Contents. Set it to anything for true. Eg. Set GENPDFADDON_NUMBEREDTOC = True |
| =pdfpermissions= | GENPDFADDON_PERMISSIONS | =undef= | print,no-copy | PDF Security permissions to disable print/copy etc. By default the PDF is unencrypted. |
d58 2
d69 1
a69 1
__NOTE:__ all %META: tags are removed from the base topic. If you want to display form data, you should add %<nop>FORMFIELD{"field"}% tags to the topic or title topic.
a74 8
The table below explains the variables related to title topic formatting.
%TABLE{ cellpadding="3" columnwidths="15%, 15%, 15%, 55%"}%
| *URL Variable* | *Twiki Preference Variable* | *Default Value* | *Explanation* |
| =pdftitletopic= | GENPDFADDON_TITLETOPIC | =N/A= | The topic to use for the title page of the PDF document |
| =pdfbanner= | GENPDFADDON_BANNER | =N/A= | This can be used to make substitions for %<nop>GENPDFADDON_BANNER% in the title page topic |
| =pdftitle= | GENPDFADDON_TITLE | =N/A= | This can be used to make substitions for %<nop>GENPDFADDON_TITLE% in the title page topic |
| =pdfsubtitle= | GENPDFADDON_SUBTITLE | =N/A= | This can be used to make substitions for %<nop>GENPDFADDON_SUBTITLE% in the title page topic |

d81 1
a81 8
See the HTMLDOC documentation at http://www.htmldoc.org for details of the format of the header and footers. In addition, the =genpdf= script will perform variable substition for the %<nop>GENPDFADDON_BANNER%, %<nop>GENPDFADDON_TITLE%, and %<nop>GENPDFADDON_SUBTITLE% variables as it does for the title page. Finally, the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of header/footer topic. An example header/footer page can be found at GenPDFExampleHeaderFooterTopic.

The table below explains the variables related to header and footer formatting.
%TABLE{ cellpadding="3" columnwidths="15%, 15%, 15%, 55%"}%
| *URL Variable* | *Twiki Preference Variable* | *Default Value* | *Explanation* |
| =pdfheadertopic= | PDFHEADERTOPIC | =N/A= | The topic to use for the main header and footers of the PDF document |
| =pdftocheader= | PDFTOCHEADER | =...= | The header format for the table of contents (see the documentation at http://www.htmldoc.org) |
| =pdftocfooter= | PDFTOCFOOTER | =..i= | The footer format for the table of contents (see the documentation at http://www.htmldoc.org) |
d101 1
a101 1
	* Add the variable =$htmldocCmd = /path/to/htmldoc;= to your =lib/TWiki.cfg= file so TWiki can find the location of the htmldoc executable. Look for $fgrepCmd.
d138 1
a138 1
		* Preferences changed to comply with TWikiPlugins standard
@


1.16
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="WadeTurland" date="1118680754" format="1.0" version="1.16"}%
d37 1
a37 1
| =pdfheadertopic= | GENPDFADDON_HEADERTOPIC | | !GenPDFHeaderFooterTopic | The name of a topic that defines headers and footers using &lt!-- HEADER LEFT "foobar" --> syntax |
d114 1
a114 1
	* Add the variable =$htmldocCmd = /path/to/htmldoc;= to your =lib/TWiki.cfg= file so TWiki can find the location of the htmldoc executable.
d120 3
a122 2
	* HTMLDOC crashes with segmentation faults. Eg it fails to generate TWiki.TWikiDocumentation. I managed to get it to work a few times, but it generally fails. The error returned is =Conversion failed: 'Inappropriate ioctl for device' at /var/www/twiki/lib/TWiki/Contrib/GenPDF.pm line XXX=
	* HTMLDOC breaks the page for every level 1 heading (Eg. &lt;h1&gt;) but it doesn't write a header for the new page, therefore topics with lots of level 1 headings and not much content don't seem to have any headers so I patched htmldoc-1.8.24 to force a header for every new page:
d125 1
a125 1
--- htmldoc-1.8.24/htmldoc/ps-pdf_force_header.cxx		Tue Jun 14 02:12:28 2005
@


1.15
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1113321811" format="1.0" version="1.15"}%
d12 1
a12 1
This is the initial (very much beta) version of this add-on and has only been tried with the Cairo version of TWiki. I've made no attempt to determine if it will run on earlier versions. We've been running it in-house at my company for a while (and it seems to work fairly well), but it has obviously not undergone any significant level of testing.
d19 4
d32 23
a54 10
%TABLE{ cellpadding="3" columnwidths="15%, 15%, 15%, 55%"}%
| *URL Variable* | *Twiki Preference Variable* | *Default Value* | *Explanation* |
| =N/A= | HTMLDOCLOC | =/usr/local/bin/htmldoc= | The location of the HTMLDOC program |
| =skin= | PDFSKIN | =print.pattern= | Default skin to use for PDF generation |
| =pdfformat= | PDFFORMAT | =pdf14= | HTMLDOC output format |
| =pdftoclevels= |PDFTOCLEVELS | =5= | Number of levels to include in the PDF table of contents (use 0 to disable the generation of a table of contents). Note that HTMLDOC generates a table of contents based on HTML headers in the page. |
| =pdfpagesize= | PDFPAGESIZE | =a4= | The page size for PDF output |
| =pdforientation= | PDFORIENTATION | =portrait= | The page orientation (e.g. landscape or portrait) |
| =pdfwidth= | PDFWIDTH | =860= | The pixel width of the browser (used to scale images--images wider than this will be truncated) |
| =shift= | PDFHEADERSHIFT | =0= |Shift all headers up or down (for negative values) by this amount (e.g. H1 would become H3 for a value of 2). *Note: The version of code attached currently has this feature disabled.* |
d65 3
a67 1
Note that there can be multiple PDFSTART and PDFSTOP comment pairs in a single topic to selectively include/exclude multiple sections of the topic in the PDF document. (If you view this page in =raw= mode or edit it, you'll see an example of multiple PDFSTART/PDFSTOP sections to exclude the TWiki table of contents). If no PDFSTART/PDFSTOP comment pair appears in the topic, the entire topic text is used. In general, this should not be a problem except for topics that include forms as the form meta-data will show up in a fairly illegible manner at the end of the document. Therefore, for topics that reference forms, a PDFSTART comment should be placed at the beginning of the topic and a PDFSTOP should be placed at the end.
d73 1
d76 4
a79 4
| =pdftitletopic= | PDFTITLETOPIC | =N/A= | The topic to use for the title page of the PDF document |
| =pdfbanner= | PDFBANNER | =N/A= | This can be used to make substitions for %<nop>PDFBANNER% in the title page topic |
| =pdftitle= | PDFTITLE | =N/A= | This can be used to make substitions for %<nop>PDFTITLE% in the title page topic |
| =pdfsubtitle= | PDFSUBTITLE | =N/A= | This can be used to make substitions for %<nop>PDFSUBTITLE% in the title page topic |
d81 1
a81 1
Also note that the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of title topic. An example title page can be found at GenPDFExampleTitleTopic. Note that the example page is from a non-rendering version of the add-on and is expressed in pure HTML.
d85 1
a85 1
The add-on also allows the user to configure header and footer formats for both the main section of the document and the table of contents. Configuring the main header and footer is much like configuring a title page. You can select a TWiki topic to use for the header and footer. Unlike the title page, this page should be expressed as pure HTML (not TWiki mark-up) as it is not rendered before being used. This is also required by HTMLDOC as it uses HTML comments for the header and footer expression. However, the add-on will perform TWiki common variable substition within the HTMLDOC header/footer HTML comments. This will allow TWiki variables (such as %<nop>REVINFO%) to be embedded in the headers and footers.
d87 1
a87 1
See the HTMLDOC documentation at http://www.htmldoc.org for details of the format of the header and footers. In addition, the =genpdf= script will perform variable substition for the %<nop>PDFBANNER%, %<nop>PDFTITLE%, and %<nop>PDFSUBTITLE% variables as it deos for the title page. Finally, the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of header/footer topic. An example header/footer page can be found at GenPDFExampleHeaderFooterTopic.
d89 1
a89 1
The table below explains the other variables related to header and footer formatting.
d113 2
a114 2
	* *Adjust the perl path in the script to match your perl installation location (the one in the zip file has =/usr/local/bin/perl=).*
	* Make sure you set the HTMLDOCLOC preference variable in you TWiki web to the location of the htmldoc executable.
d116 28
a143 1
		* If it doesn't work, check your webserver logs for any problems. The most common issue is probably an htmldoc installation (or executable path--HTMLDOCLOC value) problem.
d146 17
d175 2
a176 2
|  Add-on Author: | TWiki:Main/BrianSpinar |
|  Add-on Version: | 12 Apr 2005 (v0.3) |
d190 1
@


1.14
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1112921121" format="1.0" version="1.14"}%
d52 1
a52 1
The add-on allows the user to use a topic as a title page for PDF generation. The title page can also be configured with a couple TWiki variables for some amount of flexibility. Note that the title page topic should be expressed as pure HTML (not TWiki mark-up) as it is not rendered before being used (this may change in the future--see the actual perl package for the rationale of this design decision). The only exception to this is the substition of variables listed in the table below.
d61 1
a61 1
Also note that the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of title topic. An example title page can be found at GenPDFExampleTitleTopic.
d65 3
a67 1
The add-on also allows the user to configure header and footer formats for both the main section of the document and the table of contents. Configuring the main header and footer is much like configuring a title page. You can select a TWiki topic to use for the header and footer. Like the title page, this page should be expressed as pure HTML (not TWiki mark-up) as it is not rendered before being used. See the HTMLDOC documentation at http://www.htmldoc.org for details of the format of the header and footers. In addition, the =genpdf= script will perform variable substition for the %<nop>PDFBANNER%, %<nop>PDFTITLE%, and %<nop>PDFSUBTITLE% variables as it deos for the title page. Finally, the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of header/footer topic. An example header/footer page can be found at GenPDFExampleHeaderFooterTopic.
d99 4
a102 1
	* Version 0.2
d106 1
a106 1
	* Version 0.1
d112 2
a113 3
|  Add-on Version: | 30 Jan 2005 (v0.2) |
|  Change History: | <!-- versions below in reverse order -->  |
|  30 Jan 2005: | Initial version |
d116 1
a116 1
|  Perl Version: | 5.005 |
d126 1
a126 1
-- TWiki:Main/BrianSpinar - 22 Mar 2005
@


1.13
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1111541224" format="1.0" version="1.13"}%
d90 1
a90 1
	* Make sure the script is executable (e.g chmod 755 genpdf).
d100 1
a100 1
		* Added BrentRoberts fix to allow operation with latest version (1.8.24) of HTMLDOC
@


1.12
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1111533631" format="1.0" version="1.12"}%
d107 1
a107 1
|  Add-on Version: | 30 Jan 2005 (v0.1) |
d121 1
@


1.11
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107894220" format="1.0" version="1.11"}%
d12 1
a12 3
This is the initial (very much beta) version of this add-on and has only been tried with the Cairo version of TWiki. I've made no attempt to determine if it will run on earlier versions. We've been running it in-house at my company for only a couple weeks now (and it seems to work fairly well), but it has obviously not undergone any significant level of testing.

__Note: I could not get this to work with the latest version (1.8.24) of HTMLDOC and didn't want to spend a lot of time figuring out why (it seems the new CGI feature in HTMLDOC breaks stuff). It does, however, seem to work fine with version 1.8.23 of HTMLDOC.__
d94 9
a102 1
		* If it doesn't work, check your webserver logs for any problems. The most common issue is probably an htmldoc installation (or executable path--HTMLDOCLOC value) problem. Also, as mentioned at the top of this topic, this add-on does not seem to work with version 1.8.24 (the latest) of htmldoc. It does, however, work with the previous version (1.8.23) of htmldoc.
d111 1
a111 1
|  Other Dependencies: | HTMLDOC (http://www.htmldoc.org) version 1.8.23 only (I've had problems getting 1.8.24 to work with this Add-On) |
d116 2
d121 1
a121 1
-- TWiki:Main/BrianSpinar - 30 Jan 2005
@


1.10
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107889118" format="1.0" version="1.10"}%
d46 1
d50 2
@


1.9
log
@none
@
text
@d1 2
a2 1
%META:TOPICINFO{author="BrianSpinar" date="1107374239" format="1.0" version="1.9"}%
d4 1
d6 1
d109 1
a109 1

@


1.8
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107367501" format="1.0" version="1.8"}%
d43 2
a44 2
	* Use =<!-- PDFSTART -->= to mark the starting point in the topic for PDF generation.
	* Use =<!-- PDFSTOP -->= to mark the stopping point in the topic for PDF generation.
@


1.7
log
@none
@
text
@d1 2
a2 1
%META:TOPICINFO{author="BrianSpinar" date="1107148169" format="1.0" version="1.7"}%
a3 1
---+ Generate PDF Add-On
d17 1
a17 1
		* =<a href="%<nop>SCRIPTURLPATH%/genpdf%<nop>SCRIPTSUFFIX%/%<nop>WEB%/%<nop>TOPIC%?pdftitle=%<nop>TOPIC%">PDF</a>=
d36 1
a36 1
| =shift= | PDFHEADERSHIFT | =0= |Shift all headers up or down (for negative values) by this amount (e.g. H1 would become H3 for a value of 2) |
d87 1
a87 1
	* Adjust the perl path in the script to match your perl installation location (e.g. =/usr/local/bin=).
a103 1
|  Appraisal: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal |
@


1.6
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107143082" format="1.0" version="1.6"}%
d11 1
a11 1
__Note: I could not get this to work with the latest version (1.8.24) of HTMLDOC and didn't want to spend a lot of time figuring out why. It does, however, seem to work fine with version 1.8.23 of HTMLDOC.__
@


1.5
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107140012" format="1.0" version="1.5"}%
d5 1
a5 1
This is substantial re-write of the TWiki:Codev.PrintUsingPDF pdf script. It essentially accomplishes the same goal but with more integration to TWiki (e.g. use of TWiki variables for configuration and the TWiki rendering methods instead of using a hacked version of the =TWiki::view=) as well as more modular code structure (i.e. most of the logic is moved to a perl package).
d15 1
a15 1
	* Like the TWiki:Codev.PrintUsingPDF pdf script, a page can be published by substituting =pdf= for =view= in the topic URL.
d17 1
a17 1
		* =&lt;a href="%<nop>SCRIPTURLPATH%/genpdf%<nop>SCRIPTSUFFIX%/%<nop>WEB%/%<nop>TOPIC%?pdftitle=%<nop>TOPIC%"&gt;PDF&lt;/a&gt;=
d21 1
a21 1
The script can be configured either via URL parameters or web preference variables. URL parameters have precendence over web preference variables. If neither of these are present, the script will use hard-coded default variables. The general script configuration variables are explained in the next section while header/footer and title page configuration is explained in subsequent sections.
d25 1
a25 1
The following table shows the various conifguration variables and their meaning. The first column gives the variable to use if passed in the URL. The second column shows the variable to use if using a TWiki preference variable (i.e. Set VARIABLE = ). The third column gives the default value if neither the URL or TWiki preference variable is used. Note that URL variables have precendence over TWiki preference variables. For a more detailed description of the HTMLDOC related variables, see the HTMLDOC documentation at http://www.htmldoc.org.
d35 2
a36 2
| =pdfwidth= | PDFWIDTH | =860= | The pizel width of the browser (used to scale images--images wider than this will be truncated) |
| =shift= | PDFHEADERSHIFT | =0= |Shift all headers upp or down (for negative values) by this amount (e.g. H1 would become H3 for a value of 2) |
d42 3
a44 3
The Add-On allows the user to define the region of the topic that should be included in the PDF generation (much like the TWiki %<nop>STARTINCLUDE% and %<nop>STOPINCLUDE% variables. In this case, however, HTML comments are used instead. Everything between these two comments will be included in the PDF generation.
	* Use =&lt;!-- PDFSTART --&gt;= to mark the starting point in the topic for PDF generation.
	* Use =&lt;!-- PDFSTOP --&gt;= to mark the stopping point in the topic for PDF generation.
d48 1
a48 1
The add-on allows the user to use a topic as a title page for PDF generation. The title page can also be configured with a couple TWiki variables for some amount of flexibility. Note that the title page topic should be expressed as pure HTML (not TWiki mark-up) as it is not rendered before being used (this may change in the future--see the actual code for the rationale of this design decision). The only exception to this is the substition of variables listed in the table below.
d61 1
a61 1
The add-on also allows the user to configure header and footer formats for both the main section of the document and the table of contents. Configuring the main header and footer is much like configuring a title page. You can select a Twiki topic to use for the header and footer. Like the title page, this page should be expressed as pure HTML (not TWiki mark-up) as it is not rendered before being used. See the HTMLDOC documentation at http://www.htmldoc.org for details of the format of the header and footers. In addition, the genpdf script will perform variable substition for the %<nop>PDFBANNER%, %<nop>PDFTITLE%, and %<nop>PDFSUBTITLE% variables as it deos for the title page. Finally, the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of title topic. An example title page can be found at GenPDFExampleHeaderFooterTopic.
d88 1
d90 1
a90 1
		* If it doesn't work, check your webserver logs for any problems. The most common issue is probably an htmldoc installation (or executable path) problem. Also, as mentioned at the top of this topic, this add-on does not seem to work with version 1.8.24 (the latest) of htmldoc. It does, however, work with the previous version (1.8.23) of htmldoc.
d96 1
a96 1
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
@


1.4
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107137810" format="1.0" version="1.4"}%
d5 1
a5 1
This is substantial re-write of the TWiki:Codev.PrintUsingPDF pdf script. It essentially accomplishes the same goal but with more integration to TWiki and more modular code structure (i.e. most of the logic is moved to a perl package). We began using the TWiki:Codev.PrintUsingPDF pdf script to publish pages but found it somewhat user unfriendly to anyone who wasn;t comfortable typing long URL's with many parameters to simply publish a page. This version allows most of the script configuration (such as page size, table of contents, etc.) via preference variables in TWiki. It also allows header, footer, and title page configuration via TWiki topics.
d7 3
a9 1
This is the initial (very much beta) version of this add-on and has only been tried with the Cairo version of TWiki. I've made no attempt to determine if it will run on earlier versions. We've been running it in-house at my company for a couple weeks now (and it seems to work fairly well), but it has obviously not undergone any significant level of testing.
d79 4
d89 1
a89 1
		* If it doesn't work, check your webserver logs for any problems. The most common issue is probably an htmldoc installation (or executable path) problem. Also, as mentioned at the top of this topic, this add-on does not seem to work with version 1.8.24 (the latest) of htmldoc. It does, however, work with the previous version (1.8.23).
d97 1
a97 1
|  CPAN Dependencies: | File::Temp |
@


1.3
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107125283" format="1.0" version="1.3"}%
d9 1
a9 1
__Note: I could not get this to work with the latest version (1.8.24) of HTMLDOC. It does, however, seem to work fine with version 1.8.23 of HTMLDOC.__
d46 1
a46 1
The Add-On allows you to use a topic as a title page for PDF generation. The title page can also be configured with a couple TWiki variables for some amount of flexibility. Note that the title page topic should be expressed as pure HTML (not TWiki mark-up) as it is not rendered before being used (this may change in the future--see the actual code for the rationale of this design decision). The only exception to this is the substition of variables listed in the table below.
d55 1
a55 1
Also note that the PDFSTART and PDFSTOP HTML comments should be placed at the beginning and end of title topic. An example title page can be found at GenPDFExampleTitlePage.
d57 10
a66 1
---+++ Creating and Configuring Complex Headers and Footers
d79 3
d83 1
a83 1
		* _describe, with example_
@


1.2
log
@none
@
text
@d1 1
a1 1
%META:TOPICINFO{author="BrianSpinar" date="1107067841" format="1.0" version="1.2"}%
d7 3
a9 1
*Note:* This is the initial (very much beta) version of this add-on and has only been tried with the Cairo version of TWiki. I've made no attempt to determine if it will run on earlier versions. We've been running it in-house at my company for a couple weeks now (and it seems to work fairly well), but it has obviously not undergone any significant level of testing.
d23 20
a42 3
The following table shows the 
The following preference variables should be cut, pasted, and uncommented to the appropriate web preferences page.
	* The variable controls the 
d46 11
d80 1
a80 1
|  Other Dependencies: | HTMLDOC (http://www.htmldoc.org) |
@


1.1
log
@none
@
text
@d1 2
a2 1
%META:TOPICINFO{author="BrianSpinar" date="1107064287" format="1.0" version="1.1"}%
d5 3
a7 1
short description here
d11 17
a27 2
	* 
	* 
d46 1
a46 1
|  Add-on Version: | 30 Jan 2005 (v1.000) |
d49 2
a50 2
|  CPAN Dependencies: | none |
|  Other Dependencies: | none |
@
