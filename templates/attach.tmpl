<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
<HEAD>
  <TITLE> %WIKITOOLNAME% . %WEB% . %TOPIC% (attach)</TITLE>
  <BASE href="%SCRIPTURL%/view%SCRIPTSUFFIX%/%WEB%/%TOPIC%"> <META NAME="ROBOTS" CONTENT="NOINDEX"> %HTTP_EQUIV_ON_VIEW%
<SCRIPT LANGUAGE="JavaScript">
<!--HIDE
function initForm() {
   document.main.filepath.focus();
}
function launchWindow( theWeb, theTopic ) {
  win = open("%SCRIPTURLPATH%/view%SCRIPTSUFFIX%/" + theWeb + "/" + theTopic + "?skin=plain", theTopic, "titlebar=0,width=500,height=480,resizable,scrollbars");
  if( win ) {
    win.focus();
  }
  return false;
}
//STOP HIDING-->
</SCRIPT>
</HEAD>
<BODY bgcolor="#ffffff"  onLoad="initForm()" >
<FORM name="main" enctype="multipart/form-data" action="%SCRIPTURLPATH%/upload%SCRIPTSUFFIX%/%WEB%/%TOPIC%" method="post">
<TABLE width="100%" border="0" cellpadding="3" cellspacing="0">
  <TR>
    <TD BGCOLOR="%WEBBGCOLOR%" rowspan="2" valign="top" width="1%">
      <A href="%WIKIHOMEURL%"><IMG src="%PUBURLPATH%/wikiHome.gif" border="0"></A>
    </TD>
    <TD>
      <B>%WIKITOOLNAME% . %WEB% . </B><FONT size="+2"><B>%TOPIC%</B> (attach)</FONT>
    </TD>
  </TR>
  <TR BGCOLOR="%WEBBGCOLOR%">
    <TD COLSPAN="2">
      Attach file to topic <B>%TOPIC%</B>
    </TD>
  </TR>
</TABLE>
%ATTACHTABLE%
<P>
<B>%ACTION% <code>%FILENAME%</code></B>
<TABLE width="100%">
  <TR>
    <TD ALIGN="right">
      %PREVIOUS%
    </TD><TD>
      <code>%FILEPATH%</code> %FILEUSER%
    </TD>
  </TR>
  <TR>
    <TD ALIGN="right">
      Local file:
    </TD><TD>
      <INPUT TYPE="hidden" NAME="filename" VALUE="%FILENAME%">
      <INPUT TYPE="file" NAME="filepath" VALUE="%FILEPATH%" SIZE="50">
    </TD>
  </TR>
  <TR>
    <TD ALIGN="right">
      Comment:
    </TD><TD>
      <INPUT TYPE="text" NAME="filecomment" VALUE="%FILECOMMENT%" MAXLENGTH="50" SIZE="50">
    </TD>
  </TR>
  <TR>
    <TD ALIGN="right">
      Link:
    </TD><TD>
      <INPUT TYPE="checkbox" NAME="createlink" %ATTACHLINKBOX%> Create a link to the attached file at the end of the topic.
    </TD>
  </TR>
  <TR>
    <TD ALIGN="right">
      <I>Hide file:</I>
    </TD><TD>
      <INPUT TYPE="checkbox" NAME="hidefile" %HIDEFILE%> <I>Hide attachment in normal topic view.</I>
    </TD>
  </TR>

</TABLE>
Notes:
<UL>
<LI> <B>Link checkbox: </B>In case the attached file is a JPG or GIF image and you check the box, it will create an inline image (e.g. show the image) at the end of the topic.
<LI> <B>Bug: </B>There is a bug with Internet Explorer. In case you get an "Internal Server Error" message when you upload a file, you need to try again. It works the second time.
<!--FIXME Codev to TWiki-->
<LI> <B>Properties: </B>Can be changed without uploading a file; see <A target="HiddenAttachment" onClick="return launchWindow('%TWIKIWEB%','HiddenAttachment')" href="%SCRIPTURLPATH%/view%SCRIPTSUFFIX%/Codev/HiddenAttachment">HiddenAttachment</A>
 and <A target="DeletedAttachment" onClick="return launchWindow('%TWIKIWEB%','DeletedAttachment')" href="%SCRIPTURLPATH%/view%SCRIPTSUFFIX%/Codev/DeletedAttachment">DeletedAttachment</A>
</UL>
<TABLE width="100%" border="0" cellpadding="3" cellspacing="0">
  <TR BGCOLOR="%WEBBGCOLOR%">
    <TD valign="top">
      Topic <B>%TOPIC%</B> . {
      <INPUT type="submit" name="uploadButton" value=" &nbsp; Upload file &nbsp; "> &nbsp;
      <INPUT type="submit" name="changeButton" value="Change properties"> &nbsp;
      <A href="%SCRIPTURLPATH%/view%SCRIPTSUFFIX%/%WEB%/%TOPIC%">cancel</A>
      }
    </TD>
<!-- FIXME: Hidden until implemented
    <TD>
    <a href="!!!">Delete attachment</a> <a href="FIXME">&nbsp;(Help)</a>
    &nbsp;|&nbsp;<a href="%SCRIPTURLPATH%/rename%SCRIPTSUFFIX%/%WEB%/%TOPIC%?attachment=%FILENAME%">Move attachment</a> <a href="FIXME">&nbsp;(Help)</a>
    </TD
-->
  </TR>
</TABLE>
<TABLE width="100%" border="0" cellpadding="3" cellspacing="0">
  <TR>
    <TD valign="top">
      &nbsp;
    </TD>
    <TD width="50%" valign="top">
      %WEBCOPYRIGHT%
    </TD>
  </TR>
</TABLE>
</FORM>
</BODY></HTML>

