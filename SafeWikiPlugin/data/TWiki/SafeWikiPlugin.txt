---+!! !SafeWikiPlugin
<!--
One line description, required for extensions repository catalog.
   * Set SHORTDESCRIPTION = Secure your TWiki so it can't be attacked using cross-scripting
-->
<img style="float:right" src="%ATTACHURL%/safewiki.png" />
%SHORTDESCRIPTION%

%TOC%

This plugin is helps prevent evil people from using your wiki to mount
[[http://en.wikipedia.org/wiki/Cross-site_scripting][cross-scripting]]
attacks.

Cross-scripting attacks don't just affect public wiki sites. For example,
a footpad could mail one of your users with a crafted URL that, when
clicked on, compromises your entire corporate intranet. *All* wikis, public
or private, need protection against these attacks.

The plugin works by filtering the HTML output by TWiki as late as
possible in the rendering process. It removes anything dodgy from the
HTML, such as inline script tags, event handlers
containing complex script, and URIs that refer to objects outside a
controlled range of sites.

Whenever anything is filtered, a report is written to the TWiki warning
log.

Note that some extensions depend on Javascript to work, and a number
have not been coded with due consideration for security. If you find that
!SafeWikiPlugin kills one or more of your other extensions, then you are
advised to seek fixes from the authors of those extensions.

!SafeWikiPlugin also has a 'clean html' switch that can make it report
an error if malformed HTML is generated by TWiki. 

---++ Gory Details

The values of all on* handlers (such as =onload=, =onmouseover=, =onblur=
etc) are automatically compared against a list of filter-in regular
expressions, one of which must match, or the handler will be replaced
by disarming string.

By default only simple function calls with atomic parameters are
permitted in on* handlers. For example:
=javascript: fn(param1, "param2")= is permitted,
but =javascript: alert(window.open("http://evilsite.cn"))= is not.

Inline scripts (SCRIPT tags without a =src= parameter) are always
filtered out (removed). URIs used in certain parameters are compared
against a list of filter-in regular expressions, one of which must match
or the URI will be replaced with a disarming string.

By default the following URI parameters are checked against the
whitelist:
| *Tag* | *Parameter* |
| APPLET | archive, code, codebase |
| EMBED | src, pluginspace, pluginurl |
| OBJECT | archive, codebase |
| SCRIPT | src |
You can also enable filtering for *all* URIs, in which case URIs
such as those used in the =action= attribute of =FORM= tags will also be
filtered.

The filter-in regular expressions and the disarming strings are all
defined using the =configure= interface. See the setup for SafeWikiPlugin
for more help.

---++ Installation Instructions

%$INSTALL_INSTRUCTIONS%

No further steps are required to install on TWiki 4.2. To install on older TWiki 4 versions, you will have to patch TWiki.pm as follows:

   1 Edit lib/TWiki.pm
   1 Locate the 'writeCompletePage' function
   1 Immediately before the line that reads:
<verbatim>
    unless( $this->inContext('command_line')) {
</verbatim>
add these lines:
<verbatim>
   require TWiki::Plugins::SafeWikiPlugin;
   TWiki::Plugins::SafeWikiPlugin::completePageHandler($text, $contentType);
</verbatim>
If your version of TWiki doesn't support plugin configuration from the =configure= interface, you will have to paste the contents of =lib/TWiki/Plugins/SafeWikiPlugin/Config.spec= into the end of =lib/LocalSite.cfg= and edit the configuration manually.

---++ Plugin Info

Another great TWiki extension from the <a style="text-decoration:none" href="http://wikiring.com"><img src="%ATTACHURLPATH%/wikiringlogo20x20.png" alt="" /> *WikiRing* </a> - working together to improve your wiki experience!

Sponsors for support and improvements are always welcome.

|  Plugin Author(s): | Crawford Currie http://wikiring.com from an original idea by Sven Dowideit http://wikiring.com |
|  Copyright: | &copy; |
|  License: | [[http://www.gnu.org/licenses/gpl.html][GPL (Gnu General Public License)]] |
|  Plugin Version: | %$VERSION% |
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
|  Dependencies: | %$DEPENDENCIES% |
|  Plugin Home: | http://twiki.org/cgi-bin/view/Plugins/SafeWikiPlugin |
|  Feedback: | http://twiki.org/cgi-bin/view/Plugins/SafeWikiPluginDev |
|  Appraisal: | http://twiki.org/cgi-bin/view/Plugins/SafeWikiPluginAppraisal |

__Related Topics:__ %TWIKIWEB%.TWikiPlugins, %TWIKIWEB%.DeveloperDocumentationCategory, %TWIKIWEB%.AdminDocumentationCategory, %TWIKIWEB%.TWikiPreferences

<!-- Do _not_ attempt to edit this topic; it is auto-generated. Please add comments/questions/remarks to the feedback topic on twiki.org instead. -->

%META:FILEATTACHMENT{name="wikiringlogo20x20.png" attr="h" comment="" version="1"}%
%META:FILEATTACHMENT{name="safewiki.png" attr="h" comment="" version="1"}%
