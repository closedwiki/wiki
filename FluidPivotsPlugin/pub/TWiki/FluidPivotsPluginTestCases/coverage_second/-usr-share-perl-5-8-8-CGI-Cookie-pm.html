<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 0.61
Devel::Cover is copyright 2001-2006, Paul Johnson (pjcj@cpan.org)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: /usr/share/perl/5.8.8/CGI/Cookie.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">/usr/share/perl/5.8.8/CGI/Cookie.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">61.9%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s">package CGI::Cookie;</td></tr>
<tr><td class="h">2</td><td colspan="6"></td></tr><tr><td class="h">3</td><td></td><td></td><td></td><td></td><td></td><td class="s"># See the bottom of this file for the POD documentation.  Search for the</td></tr>
<tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td class="s"># string &#39;=head&#39;.</td></tr>
<tr><td class="h">5</td><td colspan="6"></td></tr><tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td class="s"># You can run this file through either pod2man or pod2html to produce pretty</td></tr>
<tr><td class="h">7</td><td></td><td></td><td></td><td></td><td></td><td class="s"># documentation in manual or html file format (these utilities are part of the</td></tr>
<tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Perl 5 distribution).</td></tr>
<tr><td class="h">9</td><td colspan="6"></td></tr><tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Copyright 1995-1999, Lincoln D. Stein.  All rights reserved.</td></tr>
<tr><td class="h">11</td><td></td><td></td><td></td><td></td><td></td><td class="s"># It may be used and modified freely, but I do request that this copyright</td></tr>
<tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s"># notice remain attached to the file.  You may modify this module as you </td></tr>
<tr><td class="h">13</td><td></td><td></td><td></td><td></td><td></td><td class="s"># wish, but if you redistribute a modified version, please attach a note</td></tr>
<tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s"># listing the modifications you have made.</td></tr>
<tr><td class="h">15</td><td colspan="6"></td></tr><tr><td class="h">16</td><td></td><td></td><td></td><td></td><td></td><td class="s">$CGI::Cookie::VERSION=&#39;1.26&#39;;</td></tr>
<tr><td class="h">17</td><td colspan="6"></td></tr><tr><td class="h">18</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L18">1</a></div></td><td><div>6</div><div>2</div><div>11</div></td><td class="s">use CGI::Util qw(rearrange unescape escape);</td></tr>
<tr><td class="h">19</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">use overload &#39;&quot;&quot;&#39; =&gt; \&amp;as_string,</td></tr>
<tr><td class="h">20</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;cmp&#39; =&gt; \&amp;compare,</td></tr>
<tr><td class="h">21</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L21">1</a></div></td><td><div>8</div><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&#39;fallback&#39;=&gt;1;</td></tr>
<tr><td class="h">22</td><td colspan="6"></td></tr><tr><td class="h">23</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Turn on special checking for Doug MacEachern&#39;s modperl</td></tr>
<tr><td class="h">24</td><td></td><td></td><td></td><td></td><td></td><td class="s">my $MOD_PERL = 0;</td></tr>
<tr><td class="h">25</td><td></td><td></td><td></td><td></td><td></td><td class="s">if (exists $ENV{MOD_PERL}) {</td></tr>
<tr><td class="h">26</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;if (exists $ENV{MOD_PERL_API_VERSION} &amp;&amp; $ENV{MOD_PERL_API_VERSION} == 2) {</td></tr>
<tr><td class="h">27</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$MOD_PERL = 2;</td></tr>
<tr><td class="h">28</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require Apache2::RequestUtil;</td></tr>
<tr><td class="h">29</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;require APR::Table;</td></tr>
<tr><td class="h">30</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">31</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$MOD_PERL = 1;</td></tr>
<tr><td class="h">32</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;require Apache;</td></tr>
<tr><td class="h">33</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">34</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">35</td><td colspan="6"></td></tr><tr><td class="h">36</td><td></td><td></td><td></td><td></td><td></td><td class="s"># fetch a list of cookies from the environment and</td></tr>
<tr><td class="h">37</td><td></td><td></td><td></td><td></td><td></td><td class="s"># return as a hash.  the cookies are parsed as normal</td></tr>
<tr><td class="h">38</td><td></td><td></td><td></td><td></td><td></td><td class="s"># escaped URL data.</td></tr>
<tr><td class="h">39</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub fetch {</td></tr>
<tr><td class="h">40</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L40">1</a></div></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">41</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L41">50</a></div></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $raw_cookie = get_raw_cookie(@_) or return;</td></tr>
<tr><td class="h">42</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $class-&gt;parse($raw_cookie);</td></tr>
<tr><td class="h">43</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">44</td><td colspan="6"></td></tr><tr><td class="h">45</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Fetch a list of cookies from the environment or the incoming headers and</td></tr>
<tr><td class="h">46</td><td></td><td></td><td></td><td></td><td></td><td class="s"># return as a hash. The cookie values are not unescaped or altered in any way.</td></tr>
<tr><td class="h">47</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;sub raw_fetch {</td></tr>
<tr><td class="h">48</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L48">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">49</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L49">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;my $raw_cookie = get_raw_cookie(@_) or return;</td></tr>
<tr><td class="h">50</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;my %results;</td></tr>
<tr><td class="h">51</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;my($key,$value);</td></tr>
<tr><td class="h">52</td><td colspan="6"></td></tr><tr><td class="h">53</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;my(@pairs) = split(&quot;; ?&quot;,$raw_cookie);</td></tr>
<tr><td class="h">54</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;foreach (@pairs) {</td></tr>
<tr><td class="h">55</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;s/\s*(.*?)\s*/$1/;</td></tr>
<tr><td class="h">56</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L56">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (/^([^=]+)=(.*)/) {</td></tr>
<tr><td class="h">57</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key = $1;</td></tr>
<tr><td class="h">58</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value = $2;</td></tr>
<tr><td class="h">59</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">60</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else {</td></tr>
<tr><td class="h">61</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key = $_;</td></tr>
<tr><td class="h">62</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$value = &#39;&#39;;</td></tr>
<tr><td class="h">63</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">64</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$results{$key} = $value;</td></tr>
<tr><td class="h">65</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">66</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L66">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;return \%results unless wantarray;</td></tr>
<tr><td class="h">67</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;return %results;</td></tr>
<tr><td class="h">68</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">69</td><td colspan="6"></td></tr><tr><td class="h">70</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get_raw_cookie {</td></tr>
<tr><td class="h">71</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L71">1</a></div></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;my $r = shift;</td></tr>
<tr><td class="h">72</td><td><div class="c3">1</div><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L72">0</a></div><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L72">50</a></div></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L72">0</a></div></td><td></td><td><div>6</div><div>0</div></td><td class="s">&nbsp;&nbsp;$r ||= eval { $MOD_PERL == 2                    ? </td></tr>
<tr><td class="h">73</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apache2::RequestUtil-&gt;request() :</td></tr>
<tr><td class="h">74</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Apache-&gt;request } if $MOD_PERL;</td></tr>
<tr><td class="h">75</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L75">50</a></div></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;if ($r) {</td></tr>
<tr><td class="h">76</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$raw_cookie = $r-&gt;headers_in-&gt;{&#39;Cookie&#39;};</td></tr>
<tr><td class="h">77</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">78</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L78">50</a></div></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L78">33</a></div></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($MOD_PERL &amp;&amp; !exists $ENV{REQUEST_METHOD}) {</td></tr>
<tr><td class="h">79</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Run $r-&gt;subprocess_env; before calling fetch()&quot;;</td></tr>
<tr><td class="h">80</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">81</td><td><div class="c3">1</div></td><td></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L81">33</a></div></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$raw_cookie = $ENV{HTTP_COOKIE} || $ENV{COOKIE};</td></tr>
<tr><td class="h">82</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">83</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">84</td><td colspan="6"></td></tr><tr><td class="h">85</td><td colspan="6"></td></tr><tr><td class="h">86</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub parse {</td></tr>
<tr><td class="h">87</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L87">1</a></div></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;my ($self,$raw_cookie) = @_;</td></tr>
<tr><td class="h">88</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;my %results;</td></tr>
<tr><td class="h">89</td><td colspan="6"></td></tr><tr><td class="h">90</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;my(@pairs) = split(&quot;; ?&quot;,$raw_cookie);</td></tr>
<tr><td class="h">91</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;foreach (@pairs) {</td></tr>
<tr><td class="h">92</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;s/\s*(.*?)\s*/$1/;</td></tr>
<tr><td class="h">93</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my($key,$value) = split(&quot;=&quot;,$_,2);</td></tr>
<tr><td class="h">94</td><td colspan="6"></td></tr><tr><td class="h">95</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Some foreign cookies are not in name=value format, so ignore</td></tr>
<tr><td class="h">96</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# them.</td></tr>
<tr><td class="h">97</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L97">50</a></div></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;next if !defined($value);</td></tr>
<tr><td class="h">98</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @values = ();</td></tr>
<tr><td class="h">99</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L99">50</a></div></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if ($value ne &#39;&#39;) {</td></tr>
<tr><td class="h">100</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@values = map unescape($_),split(/[&amp;;]/,$value.&#39;&amp;dmy&#39;);</td></tr>
<tr><td class="h">101</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pop @values;</td></tr>
<tr><td class="h">102</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">103</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$key = unescape($key);</td></tr>
<tr><td class="h">104</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# A bug in Netscape can cause several cookies with same name to</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# appear.  The FIRST one in HTTP_COOKIE is the most recent version.</td></tr>
<tr><td class="h">106</td><td><div class="c3">2</div></td><td></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L106">50</a></div></td><td></td><td><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$results{$key} ||= $self-&gt;new(-name=&gt;$key,-value=&gt;\@values);</td></tr>
<tr><td class="h">107</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">108</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L108">50</a></div></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;return \%results unless wantarray;</td></tr>
<tr><td class="h">109</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;return %results;</td></tr>
<tr><td class="h">110</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">111</td><td colspan="6"></td></tr><tr><td class="h">112</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">113</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L113">3</a></div></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;my $class = shift;</td></tr>
<tr><td class="h">114</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L114">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;$class = ref($class) if ref($class);</td></tr>
<tr><td class="h">115</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;my($name,$value,$path,$domain,$secure,$expires) =</td></tr>
<tr><td class="h">116</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;rearrange([NAME,[VALUE,VALUES],PATH,DOMAIN,SECURE,EXPIRES],@_);</td></tr>
<tr><td class="h">117</td><td colspan="6"></td></tr><tr><td class="h">118</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# Pull out our parameters.</td></tr>
<tr><td class="h">119</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;my @values;</td></tr>
<tr><td class="h">120</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L120">100</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;if (ref($value)) {</td></tr>
<tr><td class="h">121</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L121">50</a></div><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L121">0</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if (ref($value) eq &#39;ARRAY&#39;) {</td></tr>
<tr><td class="h">122</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@values = @$value;</td></tr>
<tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} elsif (ref($value) eq &#39;HASH&#39;) {</td></tr>
<tr><td class="h">124</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@values = %$value;</td></tr>
<tr><td class="h">125</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">126</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">127</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@values = ($value);</td></tr>
<tr><td class="h">128</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;}</td></tr>
<tr><td class="h">129</td><td colspan="6"></td></tr><tr><td class="h">130</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;bless my $self = {</td></tr>
<tr><td class="h">131</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;name&#39;=&gt;$name,</td></tr>
<tr><td class="h">132</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;value&#39;=&gt;[@values],</td></tr>
<tr><td class="h">133</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},$class;</td></tr>
<tr><td class="h">134</td><td colspan="6"></td></tr><tr><td class="h">135</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# IE requires the path and domain to be present for some reason.</td></tr>
<tr><td class="h">136</td><td><div class="c3">3</div></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L136">100</a></div></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;$path   ||= &quot;/&quot;;</td></tr>
<tr><td class="h">137</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# however, this breaks networks which use host tables without fully qualified</td></tr>
<tr><td class="h">138</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;# names, so we comment it out.</td></tr>
<tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;#    $domain = CGI::virtual_host()    unless defined $domain;</td></tr>
<tr><td class="h">140</td><td colspan="6"></td></tr><tr><td class="h">141</td><td><div class="c3">3</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L141">50</a></div></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;$self-&gt;path($path)     if defined $path;</td></tr>
<tr><td class="h">142</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L142">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;$self-&gt;domain($domain) if defined $domain;</td></tr>
<tr><td class="h">143</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L143">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;$self-&gt;secure($secure) if defined $secure;</td></tr>
<tr><td class="h">144</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L144">50</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;$self-&gt;expires($expires) if defined $expires;</td></tr>
<tr><td class="h">145</td><td></td><td></td><td></td><td></td><td></td><td class="s">#  $self-&gt;max_age($expires) if defined $expires;</td></tr>
<tr><td class="h">146</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;return $self;</td></tr>
<tr><td class="h">147</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">148</td><td colspan="6"></td></tr><tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub as_string {</td></tr>
<tr><td class="h">150</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L150">3</a></div></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">151</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L151">50</a></div></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;&quot; unless $self-&gt;name;</td></tr>
<tr><td class="h">152</td><td colspan="6"></td></tr><tr><td class="h">153</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my(@constant_values,$domain,$path,$expires,$max_age,$secure);</td></tr>
<tr><td class="h">154</td><td colspan="6"></td></tr><tr><td class="h">155</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L155">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push(@constant_values,&quot;domain=$domain&quot;)   if $domain = $self-&gt;domain;</td></tr>
<tr><td class="h">156</td><td><div class="c3">3</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L156">50</a></div></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push(@constant_values,&quot;path=$path&quot;)       if $path = $self-&gt;path;</td></tr>
<tr><td class="h">157</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L157">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push(@constant_values,&quot;expires=$expires&quot;) if $expires = $self-&gt;expires;</td></tr>
<tr><td class="h">158</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L158">50</a></div></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push(@constant_values,&quot;max-age=$max_age&quot;) if $max_age = $self-&gt;max_age;</td></tr>
<tr><td class="h">159</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L159">50</a></div></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push(@constant_values,&quot;secure&quot;) if $secure = $self-&gt;secure;</td></tr>
<tr><td class="h">160</td><td colspan="6"></td></tr><tr><td class="h">161</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my($key) = escape($self-&gt;name);</td></tr>
<tr><td class="h">162</td><td><div class="c3">3</div></td><td></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L162">50</a></div><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--condition.html#L162">50</a></div></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my($cookie) = join(&quot;=&quot;,($key||&#39;&#39;),join(&quot;&amp;&quot;,map escape($_||&#39;&#39;),$self-&gt;value));</td></tr>
<tr><td class="h">163</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>19</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return join(&quot;; &quot;,$cookie,@constant_values);</td></tr>
<tr><td class="h">164</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">165</td><td colspan="6"></td></tr><tr><td class="h">166</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub compare {</td></tr>
<tr><td class="h">167</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L167">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">168</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $value = shift;</td></tr>
<tr><td class="h">169</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$self&quot; cmp $value;</td></tr>
<tr><td class="h">170</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">171</td><td colspan="6"></td></tr><tr><td class="h">172</td><td></td><td></td><td></td><td></td><td></td><td class="s"># accessors</td></tr>
<tr><td class="h">173</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub name {</td></tr>
<tr><td class="h">174</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L174">6</a></div></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">175</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">176</td><td><div class="c3">6</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L176">50</a></div></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;name&#39;} = $name if defined $name;</td></tr>
<tr><td class="h">177</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{&#39;name&#39;};</td></tr>
<tr><td class="h">178</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">179</td><td colspan="6"></td></tr><tr><td class="h">180</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub value {</td></tr>
<tr><td class="h">181</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L181">4</a></div></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">182</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $value = shift;</td></tr>
<tr><td class="h">183</td><td><div class="c3">4</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L183">50</a></div></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (defined $value) {</td></tr>
<tr><td class="h">184</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @values;</td></tr>
<tr><td class="h">185</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L185">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref($value)) {</td></tr>
<tr><td class="h">186</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L186">0</a></div><div class="c0" title="-/-"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L186">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if (ref($value) eq &#39;ARRAY&#39;) {</td></tr>
<tr><td class="h">187</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@values = @$value;</td></tr>
<tr><td class="h">188</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif (ref($value) eq &#39;HASH&#39;) {</td></tr>
<tr><td class="h">189</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@values = %$value;</td></tr>
<tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">191</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">192</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@values = ($value);</td></tr>
<tr><td class="h">193</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">194</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;value&#39;} = [@values];</td></tr>
<tr><td class="h">195</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">196</td><td><div class="c3">4</div><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L196">100</a></div></td><td></td><td></td><td><div>29</div><div>29</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return wantarray ? @{$self-&gt;{&#39;value&#39;}} : $self-&gt;{&#39;value&#39;}-&gt;[0]</td></tr>
<tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">198</td><td colspan="6"></td></tr><tr><td class="h">199</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub domain {</td></tr>
<tr><td class="h">200</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L200">3</a></div></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">201</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $domain = shift;</td></tr>
<tr><td class="h">202</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L202">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;domain&#39;} = lc $domain if defined $domain;</td></tr>
<tr><td class="h">203</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{&#39;domain&#39;};</td></tr>
<tr><td class="h">204</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">205</td><td colspan="6"></td></tr><tr><td class="h">206</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub secure {</td></tr>
<tr><td class="h">207</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L207">3</a></div></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">208</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $secure = shift;</td></tr>
<tr><td class="h">209</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L209">50</a></div></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;secure&#39;} = $secure if defined $secure;</td></tr>
<tr><td class="h">210</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{&#39;secure&#39;};</td></tr>
<tr><td class="h">211</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">212</td><td colspan="6"></td></tr><tr><td class="h">213</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expires {</td></tr>
<tr><td class="h">214</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L214">3</a></div></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">215</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $expires = shift;</td></tr>
<tr><td class="h">216</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L216">50</a></div></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;expires&#39;} = CGI::Util::expires($expires,&#39;cookie&#39;) if defined $expires;</td></tr>
<tr><td class="h">217</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{&#39;expires&#39;};</td></tr>
<tr><td class="h">218</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">219</td><td colspan="6"></td></tr><tr><td class="h">220</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub max_age {</td></tr>
<tr><td class="h">221</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L221">3</a></div></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">222</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;my $expires = shift;</td></tr>
<tr><td class="h">223</td><td><div class="c3">3</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L223">50</a></div></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;$self-&gt;{&#39;max-age&#39;} = CGI::Util::expire_calc($expires)-time() if defined $expires;</td></tr>
<tr><td class="h">224</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;return $self-&gt;{&#39;max-age&#39;};</td></tr>
<tr><td class="h">225</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">226</td><td colspan="6"></td></tr><tr><td class="h">227</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub path {</td></tr>
<tr><td class="h">228</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--subroutine.html#L228">6</a></div></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $self = shift;</td></tr>
<tr><td class="h">229</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $path = shift;</td></tr>
<tr><td class="h">230</td><td><div class="c3">6</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl-5-8-8-CGI-Cookie-pm--branch.html#L230">100</a></div></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$self-&gt;{&#39;path&#39;} = $path if defined $path;</td></tr>
<tr><td class="h">231</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>53</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $self-&gt;{&#39;path&#39;};</td></tr>
<tr><td class="h">232</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">233</td><td colspan="6"></td></tr><tr><td class="h">234</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h">235</td><td colspan="6"></td></tr><tr><td class="h">236 - 478</td><td colspan="5"></td><td class="s"><pre>=head1 NAME

CGI::Cookie - Interface to Netscape Cookies

=head1 SYNOPSIS

    use CGI qw/:standard/;
    use CGI::Cookie;

    # Create new cookies and send them
    $cookie1 = new CGI::Cookie(-name=&gt;&#39;ID&#39;,-value=&gt;123456);
    $cookie2 = new CGI::Cookie(-name=&gt;&#39;preferences&#39;,
                               -value=&gt;{ font =&gt; Helvetica,
                                         size =&gt; 12 } 
                               );
    print header(-cookie=&gt;[$cookie1,$cookie2]);

    # fetch existing cookies
    %cookies = fetch CGI::Cookie;
    $id = $cookies{&#39;ID&#39;}-&gt;value;

    # create cookies returned from an external source
    %cookies = parse CGI::Cookie($ENV{COOKIE});

=head1 DESCRIPTION

CGI::Cookie is an interface to Netscape (HTTP/1.1) cookies, an
innovation that allows Web servers to store persistent information on
the browser&#39;s side of the connection.  Although CGI::Cookie is
intended to be used in conjunction with CGI.pm (and is in fact used by
it internally), you can use this module independently.

For full information on cookies see 

	http://www.ics.uci.edu/pub/ietf/http/rfc2109.txt

=head1 USING CGI::Cookie

CGI::Cookie is object oriented.  Each cookie object has a name and a
value.  The name is any scalar value.  The value is any scalar or
array value (associative arrays are also allowed).  Cookies also have
several optional attributes, including:

=over 4

=item B&lt;1. expiration date&gt;

The expiration date tells the browser how long to hang on to the
cookie.  If the cookie specifies an expiration date in the future, the
browser will store the cookie information in a disk file and return it
to the server every time the user reconnects (until the expiration
date is reached).  If the cookie species an expiration date in the
past, the browser will remove the cookie from the disk file.  If the
expiration date is not specified, the cookie will persist only until
the user quits the browser.

=item B&lt;2. domain&gt;

This is a partial or complete domain name for which the cookie is 
valid.  The browser will return the cookie to any host that matches
the partial domain name.  For example, if you specify a domain name
of &quot;.capricorn.com&quot;, then Netscape will return the cookie to
Web servers running on any of the machines &quot;www.capricorn.com&quot;, 
&quot;ftp.capricorn.com&quot;, &quot;feckless.capricorn.com&quot;, etc.  Domain names
must contain at least two periods to prevent attempts to match
on top level domains like &quot;.edu&quot;.  If no domain is specified, then
the browser will only return the cookie to servers on the host the
cookie originated from.

=item B&lt;3. path&gt;

If you provide a cookie path attribute, the browser will check it
against your script&#39;s URL before returning the cookie.  For example,
if you specify the path &quot;/cgi-bin&quot;, then the cookie will be returned
to each of the scripts &quot;/cgi-bin/tally.pl&quot;, &quot;/cgi-bin/order.pl&quot;, and
&quot;/cgi-bin/customer_service/complain.pl&quot;, but not to the script
&quot;/cgi-private/site_admin.pl&quot;.  By default, the path is set to &quot;/&quot;, so
that all scripts at your site will receive the cookie.

=item B&lt;4. secure flag&gt;

If the &quot;secure&quot; attribute is set, the cookie will only be sent to your
script if the CGI request is occurring on a secure channel, such as SSL.

=back

=head2 Creating New Cookies

	$c = new CGI::Cookie(-name    =&gt;  &#39;foo&#39;,
                             -value   =&gt;  &#39;bar&#39;,
                             -expires =&gt;  &#39;+3M&#39;,
                             -domain  =&gt;  &#39;.capricorn.com&#39;,
                             -path    =&gt;  &#39;/cgi-bin/database&#39;,
                             -secure  =&gt;  1
	                    );

Create cookies from scratch with the B&lt;new&gt; method.  The B&lt;-name&gt; and
B&lt;-value&gt; parameters are required.  The name must be a scalar value.
The value can be a scalar, an array reference, or a hash reference.
(At some point in the future cookies will support one of the Perl
object serialization protocols for full generality).

B&lt;-expires&gt; accepts any of the relative or absolute date formats
recognized by CGI.pm, for example &quot;+3M&quot; for three months in the
future.  See CGI.pm&#39;s documentation for details.

B&lt;-domain&gt; points to a domain name or to a fully qualified host name.
If not specified, the cookie will be returned only to the Web server
that created it.

B&lt;-path&gt; points to a partial URL on the current server.  The cookie
will be returned to all URLs beginning with the specified path.  If
not specified, it defaults to &#39;/&#39;, which returns the cookie to all
pages at your site.

B&lt;-secure&gt; if set to a true value instructs the browser to return the
cookie only when a cryptographic protocol is in use.

=head2 Sending the Cookie to the Browser

Within a CGI script you can send a cookie to the browser by creating
one or more Set-Cookie: fields in the HTTP header.  Here is a typical
sequence:

  my $c = new CGI::Cookie(-name    =&gt;  &#39;foo&#39;,
                          -value   =&gt;  [&#39;bar&#39;,&#39;baz&#39;],
                          -expires =&gt;  &#39;+3M&#39;);

  print &quot;Set-Cookie: $c\n&quot;;
  print &quot;Content-Type: text/html\n\n&quot;;

To send more than one cookie, create several Set-Cookie: fields.

If you are using CGI.pm, you send cookies by providing a -cookie
argument to the header() method:

  print header(-cookie=&gt;$c);

Mod_perl users can set cookies using the request object&#39;s header_out()
method:

  $r-&gt;headers_out-&gt;set(&#39;Set-Cookie&#39; =&gt; $c);

Internally, Cookie overloads the &quot;&quot; operator to call its as_string()
method when incorporated into the HTTP header.  as_string() turns the
Cookie&#39;s internal representation into an RFC-compliant text
representation.  You may call as_string() yourself if you prefer:

  print &quot;Set-Cookie: &quot;,$c-&gt;as_string,&quot;\n&quot;;

=head2 Recovering Previous Cookies

	%cookies = fetch CGI::Cookie;

B&lt;fetch&gt; returns an associative array consisting of all cookies
returned by the browser.  The keys of the array are the cookie names.  You
can iterate through the cookies this way:

	%cookies = fetch CGI::Cookie;
	foreach (keys %cookies) {
	   do_something($cookies{$_});
        }

In a scalar context, fetch() returns a hash reference, which may be more
efficient if you are manipulating multiple cookies.

CGI.pm uses the URL escaping methods to save and restore reserved characters
in its cookies.  If you are trying to retrieve a cookie set by a foreign server,
this escaping method may trip you up.  Use raw_fetch() instead, which has the
same semantics as fetch(), but performs no unescaping.

You may also retrieve cookies that were stored in some external
form using the parse() class method:

       $COOKIES = `cat /usr/tmp/Cookie_stash`;
       %cookies = parse CGI::Cookie($COOKIES);

If you are in a mod_perl environment, you can save some overhead by
passing the request object to fetch() like this:

   CGI::Cookie-&gt;fetch($r);

=head2 Manipulating Cookies

Cookie objects have a series of accessor methods to get and set cookie
attributes.  Each accessor has a similar syntax.  Called without
arguments, the accessor returns the current value of the attribute.
Called with an argument, the accessor changes the attribute and
returns its new value.

=over 4

=item B&lt;name()&gt;

Get or set the cookie&#39;s name.  Example:

	$name = $c-&gt;name;
	$new_name = $c-&gt;name(&#39;fred&#39;);

=item B&lt;value()&gt;

Get or set the cookie&#39;s value.  Example:

	$value = $c-&gt;value;
	@new_value = $c-&gt;value([&#39;a&#39;,&#39;b&#39;,&#39;c&#39;,&#39;d&#39;]);

B&lt;value()&gt; is context sensitive.  In a list context it will return
the current value of the cookie as an array.  In a scalar context it
will return the B&lt;first&gt; value of a multivalued cookie.

=item B&lt;domain()&gt;

Get or set the cookie&#39;s domain.

=item B&lt;path()&gt;

Get or set the cookie&#39;s path.

=item B&lt;expires()&gt;

Get or set the cookie&#39;s expiration time.

=back


=head1 AUTHOR INFORMATION

Copyright 1997-1998, Lincoln D. Stein.  All rights reserved.  

This library is free software; you can redistribute it and/or modify
it under the same terms as Perl itself.

Address bug reports and comments to: lstein@cshl.org

=head1 BUGS

This section intentionally left blank.

=head1 SEE ALSO

L&lt;CGI::Carp&gt;, L&lt;CGI&gt;

=cut</pre></td></tr>
</table>
</body>
</html>
