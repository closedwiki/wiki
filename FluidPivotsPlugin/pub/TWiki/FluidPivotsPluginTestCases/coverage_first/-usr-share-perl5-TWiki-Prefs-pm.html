<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 0.61
Devel::Cover is copyright 2001-2006, Paul Johnson (pjcj@cpan.org)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: /usr/share/perl5/TWiki/Prefs.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">/usr/share/perl5/TWiki/Prefs.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c1">82.1%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Module of TWiki Enterprise Collaboration Platform, http://TWiki.org/</td></tr>
<tr><td class="h">2</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">3</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Copyright (C) 2000-2007 Peter Thoeny, peter@thoeny.org</td></tr>
<tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td class="s"># and TWiki Contributors. All Rights Reserved. TWiki Contributors</td></tr>
<tr><td class="h">5</td><td></td><td></td><td></td><td></td><td></td><td class="s"># are listed in the AUTHORS file in the root of this distribution.</td></tr>
<tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td class="s"># NOTE: Please extend that file, not this notice.</td></tr>
<tr><td class="h">7</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is free software; you can redistribute it and/or</td></tr>
<tr><td class="h">9</td><td></td><td></td><td></td><td></td><td></td><td class="s"># modify it under the terms of the GNU General Public License</td></tr>
<tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td class="s"># as published by the Free Software Foundation; either version 2</td></tr>
<tr><td class="h">11</td><td></td><td></td><td></td><td></td><td></td><td class="s"># of the License, or (at your option) any later version. For</td></tr>
<tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s"># more details read LICENSE in the root of this distribution.</td></tr>
<tr><td class="h">13</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is distributed in the hope that it will be useful,</td></tr>
<tr><td class="h">15</td><td></td><td></td><td></td><td></td><td></td><td class="s"># but WITHOUT ANY WARRANTY; without even the implied warranty of</td></tr>
<tr><td class="h">16</td><td></td><td></td><td></td><td></td><td></td><td class="s"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</td></tr>
<tr><td class="h">17</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">18</td><td></td><td></td><td></td><td></td><td></td><td class="s"># As per the GPL, removal of this notice is prohibited.</td></tr>
<tr><td class="h">19</td><td colspan="6"></td></tr><tr><td class="h">20</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L20">1</a></div></td><td><div>4</div><div>5</div><div>5</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">21</td><td colspan="6"></td></tr><tr><td class="h">22 - 41</td><td colspan="5"></td><td class="s"><pre>=pod

---+ package TWiki::Prefs

The Prefs class is a singleton that implements management of preferences.
It uses a stack of TWiki::Prefs::PrefsCache objects to store the
preferences for global, web, user and topic contexts, and provides
the means to look up preferences in these.

Preferences from different places stack on top of each other, so there
are global preferences, then site, then web (and subweb and subsubweb),
then topic, included topic and so on. Each level of the stack is tagged with
a type identifier.

The module also maintains a separate of the preferences found in every topic
and web it reads. This supports the lookup of preferences for webs and topics
that are not on the stack, and must not be chained in (you can&#39;t allow
a user to override protections from their home topic!)

=cut</pre></td></tr>
<tr><td class="h">42</td><td colspan="6"></td></tr><tr><td class="h">43</td><td></td><td></td><td></td><td></td><td></td><td class="s">package TWiki::Prefs;</td></tr>
<tr><td class="h">44</td><td colspan="6"></td></tr><tr><td class="h">45</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L45">1</a></div></td><td><div>9</div><div>2</div><div>9</div></td><td class="s">use TWiki::Prefs::PrefsCache;</td></tr>
<tr><td class="h">46</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L46">1</a></div></td><td><div>6</div><div>3</div><div>4</div></td><td class="s">use Assert;</td></tr>
<tr><td class="h">47</td><td colspan="6"></td></tr><tr><td class="h">48 - 55</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ClassMethod new( $session [, $cache] )

Creates a new Prefs object. If $cache is defined, it will be
pushed onto the stack.

=cut</pre></td></tr>
<tr><td class="h">56</td><td colspan="6"></td></tr><tr><td class="h">57</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">58</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L58">5</a></div></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $class, $session, $cache ) = @_;</td></tr>
<tr><td class="h">59</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>48</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = bless( {}, $class );</td></tr>
<tr><td class="h">60</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($session-&gt;isa( &#39;TWiki&#39;)) if DEBUG;</td></tr>
<tr><td class="h">61</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{session} = $session;</td></tr>
<tr><td class="h">62</td><td><div class="c3">5</div><div class="c0">0</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L62">50</a></div></td><td></td><td></td><td><div>25</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{PREFS}}, $cache ) if defined( $cache );</td></tr>
<tr><td class="h">63</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $this-&gt;{TOPICS} - hash of TWiki::Prefs objects, for solitary topics</td></tr>
<tr><td class="h">64</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# $this-&gt;{WEBS} - hash of TWiki::Prefs objects, for solitary webs</td></tr>
<tr><td class="h">65</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# remember what &quot;Local&quot; means</td></tr>
<tr><td class="h">66</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>37</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{LOCAL} = $session-&gt;{webName}.&#39;.&#39;.$this-&gt;{session}-&gt;{topicName};</td></tr>
<tr><td class="h">67</td><td colspan="6"></td></tr><tr><td class="h">68</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this;</td></tr>
<tr><td class="h">69</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">70</td><td colspan="6"></td></tr><tr><td class="h">71 - 79</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod finish
Complete processing after the client&#39;s HTTP request has been responded
to. 
   1 breaking circular references to allow garbage collection in persistent
     environments

=cut</pre></td></tr>
<tr><td class="h">80</td><td colspan="6"></td></tr><tr><td class="h">81</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub finish {</td></tr>
<tr><td class="h">82</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L82">1</a></div></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">83</td><td colspan="6"></td></tr><tr><td class="h">84</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{TEXT}      =  {};</td></tr>
<tr><td class="h">85</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{TOPICS}    =  {};</td></tr>
<tr><td class="h">86</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prefswebs       =  $this-&gt;{WEBS};</td></tr>
<tr><td class="h">87</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;while (my ($pref_key,$wprefs) = each %$prefswebs) {</td></tr>
<tr><td class="h">88</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$wprefs-&gt;{PREFS} = ();</td></tr>
<tr><td class="h">89</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">90</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{WEBS}      =  {};</td></tr>
<tr><td class="h">91</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td><div>4</div><div>716</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;@{$this-&gt;{PREFS}}  =  ();</td></tr>
<tr><td class="h">92</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">93</td><td colspan="6"></td></tr><tr><td class="h">94 - 104</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod pushPreferences( $web, $topic, $type )
   * =$web= - web to read from
   * =$topic= - topic to read
   * =$type= - DEFAULT, SITE, USER, SESSION, WEB, TOPIC or PLUGIN
   * =$prefix= - key prefix for all preferences (used for plugins)
Reads preferences from the given topic, and pushes them onto the
preferences stack.

=cut</pre></td></tr>
<tr><td class="h">105</td><td colspan="6"></td></tr><tr><td class="h">106</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub pushPreferences {</td></tr>
<tr><td class="h">107</td><td><div class="c3">22</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L107">22</a></div></td><td><div>96</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $web, $topic, $type, $prefix ) = @_;</td></tr>
<tr><td class="h">108</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td><div>50</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Prefs&#39;)) if DEBUG;</td></tr>
<tr><td class="h">109</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $top;</td></tr>
<tr><td class="h">110</td><td colspan="6"></td></tr><tr><td class="h">111</td><td><div class="c3">22</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L111">100</a></div></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $this-&gt;{PREFS} ) {</td></tr>
<tr><td class="h">112</td><td><div class="c3">17</div><div class="c3">17</div></td><td></td><td></td><td></td><td><div>52</div><div>78</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$top = $this-&gt;{PREFS}[$#{$this-&gt;{PREFS}}];</td></tr>
<tr><td class="h">113</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">114</td><td colspan="6"></td></tr><tr><td class="h">115</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td><div>129</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $req =</td></tr>
<tr><td class="h">116</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new TWiki::Prefs::PrefsCache(</td></tr>
<tr><td class="h">117</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this, $top, $type, $web, $topic, $prefix );</td></tr>
<tr><td class="h">118</td><td colspan="6"></td></tr><tr><td class="h">119</td><td><div class="c3">22</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L119">50</a></div></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $req ) {</td></tr>
<tr><td class="h">120</td><td><div class="c3">22</div><div class="c3">22</div></td><td></td><td></td><td></td><td><div>58</div><div>91</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{PREFS}}, $req );</td></tr>
<tr><td class="h">121</td><td><div class="c3">22</div></td><td></td><td></td><td></td><td><div>99</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$req-&gt;finalise( $this );</td></tr>
<tr><td class="h">122</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">123</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">124</td><td colspan="6"></td></tr><tr><td class="h">125 - 132</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod pushWebPreferences( $web )

Pushes web preferences. Web preferences for a particular web depend
on the preferences of all containing webs.

=cut</pre></td></tr>
<tr><td class="h">133</td><td colspan="6"></td></tr><tr><td class="h">134</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub pushWebPreferences {</td></tr>
<tr><td class="h">135</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L135">5</a></div></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $web ) = @_;</td></tr>
<tr><td class="h">136</td><td colspan="6"></td></tr><tr><td class="h">137</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @webPath = split( /[\/\.]/, $web );</td></tr>
<tr><td class="h">138</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $path = &#39;&#39;;</td></tr>
<tr><td class="h">139</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $tmp ( @webPath ) {</td></tr>
<tr><td class="h">140</td><td><div class="c3">5</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L140">50</a></div></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path .= &#39;/&#39; if $path;</td></tr>
<tr><td class="h">141</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$path .= $tmp;</td></tr>
<tr><td class="h">142</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;pushPreferences( $path, $TWiki::cfg{WebPrefsTopicName}, &#39;WEB&#39; );</td></tr>
<tr><td class="h">143</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">145</td><td colspan="6"></td></tr><tr><td class="h">146 - 151</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod pushGlobalPreferences()
Add global preferences to this preferences stack.

=cut</pre></td></tr>
<tr><td class="h">152</td><td colspan="6"></td></tr><tr><td class="h">153</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub pushGlobalPreferences {</td></tr>
<tr><td class="h">154</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L154">1</a></div></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">155</td><td colspan="6"></td></tr><tr><td class="h">156</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Default prefs first, from read-only web</td></tr>
<tr><td class="h">157</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $prefs = $this-&gt;pushPreferences(</td></tr>
<tr><td class="h">158</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::cfg{SystemWebName},</td></tr>
<tr><td class="h">159</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::cfg{SitePrefsTopicName},</td></tr>
<tr><td class="h">160</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;DEFAULT&#39; );</td></tr>
<tr><td class="h">161</td><td colspan="6"></td></tr><tr><td class="h">162</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">163</td><td colspan="6"></td></tr><tr><td class="h">164</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub pushGlobalPreferencesSiteSpecific {</td></tr>
<tr><td class="h">165</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L165">1</a></div></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">166</td><td colspan="6"></td></tr><tr><td class="h">167</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Then local site prefs</td></tr>
<tr><td class="h">168</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L168">50</a></div></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $TWiki::cfg{LocalSitePreferences} ) {</td></tr>
<tr><td class="h">169</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my( $lweb, $ltopic ) = $this-&gt;{session}-&gt;normalizeWebTopicName(</td></tr>
<tr><td class="h">170</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;undef, $TWiki::cfg{LocalSitePreferences} );</td></tr>
<tr><td class="h">171</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;pushPreferences( $lweb, $ltopic, &#39;SITE&#39; );</td></tr>
<tr><td class="h">172</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">173</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">174</td><td colspan="6"></td></tr><tr><td class="h">175 - 180</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod pushPreferencesValues( $type, \%values )
Push a new preference level using type and values given

=cut</pre></td></tr>
<tr><td class="h">181</td><td colspan="6"></td></tr><tr><td class="h">182</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub pushPreferenceValues {</td></tr>
<tr><td class="h">183</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L183">1</a></div></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type, $values ) = @_;</td></tr>
<tr><td class="h">184</td><td colspan="6"></td></tr><tr><td class="h">185</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L185">50</a></div></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return unless $values;</td></tr>
<tr><td class="h">186</td><td colspan="6"></td></tr><tr><td class="h">187</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $top;</td></tr>
<tr><td class="h">188</td><td><div class="c3">1</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L188">50</a></div></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $this-&gt;{PREFS} ) {</td></tr>
<tr><td class="h">189</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td><div>4</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$top = $this-&gt;{PREFS}[$#{$this-&gt;{PREFS}}];</td></tr>
<tr><td class="h">190</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">191</td><td colspan="6"></td></tr><tr><td class="h">192</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $req = new TWiki::Prefs::PrefsCache( $this, $top, $type );</td></tr>
<tr><td class="h">193</td><td colspan="6"></td></tr><tr><td class="h">194</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $key ( keys %$values ) {</td></tr>
<tr><td class="h">195</td><td><div class="c3">6</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Prefs-pm--condition.html#L195">50</a></div></td><td></td><td><div>31</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $val = $values-&gt;{$key} || &#39;&#39;;</td></tr>
<tr><td class="h">196</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$req-&gt;insert( &#39;Set&#39;, $key, $val );</td></tr>
<tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">198</td><td colspan="6"></td></tr><tr><td class="h">199</td><td><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{PREFS}}, $req );</td></tr>
<tr><td class="h">200</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$req-&gt;finalise( $this );</td></tr>
<tr><td class="h">201</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">202</td><td colspan="6"></td></tr><tr><td class="h">203 - 210</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod mark()
Return a marker representing the current top of the preferences
stack. Used to remember the stack when new web and topic preferences
are pushed during a topic include.

=cut</pre></td></tr>
<tr><td class="h">211</td><td colspan="6"></td></tr><tr><td class="h">212</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub mark {</td></tr>
<tr><td class="h">213</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L213">6</a></div></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">214</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td><div>16</div><div>30</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return scalar( @{$this-&gt;{PREFS}} );</td></tr>
<tr><td class="h">215</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">216</td><td colspan="6"></td></tr><tr><td class="h">217 - 223</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod resetTo( $mark )
Resets the preferences stack to the given mark, to recover after a topic
include.

=cut</pre></td></tr>
<tr><td class="h">224</td><td colspan="6"></td></tr><tr><td class="h">225</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub restore {</td></tr>
<tr><td class="h">226</td><td><div class="c3">6</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L226">6</a></div></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $where ) = @_;</td></tr>
<tr><td class="h">227</td><td><div class="c3">6</div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT( $where ) if DEBUG;</td></tr>
<tr><td class="h">228</td><td><div class="c3">6</div><div class="c3">6</div></td><td></td><td></td><td></td><td><div>15</div><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;splice( @{$this-&gt;{PREFS}}, $where );</td></tr>
<tr><td class="h">229</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">230</td><td colspan="6"></td></tr><tr><td class="h">231 - 241</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getPreferencesValue( $key ) -&gt; $value
   * =$key - key to look up

Returns the value of the preference =$key=, or undef.

Looks up local preferences when the level
topic is the same as the current web,topic in the session.

=cut</pre></td></tr>
<tr><td class="h">242</td><td colspan="6"></td></tr><tr><td class="h">243</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPreferencesValue {</td></tr>
<tr><td class="h">244</td><td><div class="c3">640</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L244">640</a></div></td><td><div>2160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $key ) = @_;</td></tr>
<tr><td class="h">245</td><td colspan="6"></td></tr><tr><td class="h">246</td><td><div class="c3">640</div><div class="c3">640</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L246">50</a></div></td><td></td><td></td><td><div>1558</div><div>3374</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return undef unless @{$this-&gt;{PREFS}};</td></tr>
<tr><td class="h">247</td><td><div class="c3">640</div><div class="c3">640</div></td><td></td><td></td><td></td><td><div>2082</div><div>2668</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $top = $this-&gt;{PREFS}[$#{$this-&gt;{PREFS}}];</td></tr>
<tr><td class="h">248</td><td><div class="c3">640</div></td><td></td><td></td><td></td><td><div>2511</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $lk = $this-&gt;{LOCAL}.&#39;-&#39;.$key;</td></tr>
<tr><td class="h">249</td><td><div class="c3">640</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L249">50</a></div></td><td></td><td></td><td><div>3020</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( defined( $top-&gt;{locals}{$lk} )){</td></tr>
<tr><td class="h">250</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $top-&gt;{locals}{$lk};</td></tr>
<tr><td class="h">251</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">252</td><td><div class="c3">640</div></td><td></td><td></td><td></td><td><div>3497</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $top-&gt;{values}{$key};</td></tr>
<tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">254</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">255</td><td colspan="6"></td></tr><tr><td class="h">256 - 261</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod isFinalised( $key )
Return true if $key is finalised somewhere in the prefs stack

=cut</pre></td></tr>
<tr><td class="h">262</td><td colspan="6"></td></tr><tr><td class="h">263</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub isFinalised {</td></tr>
<tr><td class="h">264</td><td><div class="c3">322</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L264">322</a></div></td><td><div>1048</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $key ) = @_;</td></tr>
<tr><td class="h">265</td><td colspan="6"></td></tr><tr><td class="h">266</td><td><div class="c3">322</div><div class="c3">322</div></td><td></td><td></td><td></td><td><div>822</div><div>1376</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $level ( @{$this-&gt;{PREFS}} ) {</td></tr>
<tr><td class="h">267</td><td><div class="c3">1556</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L267">100</a></div></td><td></td><td></td><td><div>8363</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $level-&gt;{final}{$key};</td></tr>
<tr><td class="h">268</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">269</td><td colspan="6"></td></tr><tr><td class="h">270</td><td><div class="c3">288</div></td><td></td><td></td><td></td><td><div>1580</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">271</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">272</td><td colspan="6"></td></tr><tr><td class="h">273 - 283</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getTopicPreferencesValue( $key, $web, $topic ) -&gt; $value

Recover a preferences value that is defined in a specific topic. Does
not recover web, user or global settings.

Intended for use in protections mechanisms, where the order doesn&#39;t match
the prefs stack.

=cut</pre></td></tr>
<tr><td class="h">284</td><td colspan="6"></td></tr><tr><td class="h">285</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getTopicPreferencesValue {</td></tr>
<tr><td class="h">286</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L286">2</a></div></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $key, $web, $topic ) = @_;</td></tr>
<tr><td class="h">287</td><td colspan="6"></td></tr><tr><td class="h">288</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L288">50</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Prefs-pm--condition.html#L288">33</a></div></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return undef unless defined $web &amp;&amp; defined $topic;</td></tr>
<tr><td class="h">289</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wtn = $web.&#39;.&#39;.$topic;</td></tr>
<tr><td class="h">290</td><td colspan="6"></td></tr><tr><td class="h">291</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L291">100</a></div></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless( $this-&gt;{TOPICS}{$wtn} ) {</td></tr>
<tr><td class="h">292</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{TOPICS}{$wtn} =</td></tr>
<tr><td class="h">293</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new TWiki::Prefs::PrefsCache( $this, undef, &#39;TOPIC&#39;, $web, $topic );</td></tr>
<tr><td class="h">294</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">295</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{TOPICS}{$wtn}-&gt;{values}{$key};</td></tr>
<tr><td class="h">296</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">297</td><td colspan="6"></td></tr><tr><td class="h">298 - 304</td><td colspan="5"></td><td class="s"><pre>=pod

---++ getTextPreferencesValue( $key, $text, $meta, $web, $topic ) -&gt; $value
Get a preference value from the settings in the text (and/or optional $meta).
The values read are *not* cached.

=cut</pre></td></tr>
<tr><td class="h">305</td><td colspan="6"></td></tr><tr><td class="h">306</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getTextPreferencesValue {</td></tr>
<tr><td class="h">307</td><td><div class="c3">14</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L307">14</a></div></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $key, $text, $meta, $web, $topic ) = @_;</td></tr>
<tr><td class="h">308</td><td colspan="6"></td></tr><tr><td class="h">309</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wtn = $web.&#39;.&#39;.$topic;</td></tr>
<tr><td class="h">310</td><td colspan="6"></td></tr><tr><td class="h">311</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td><div>80</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $cache = </td></tr>
<tr><td class="h">312</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new TWiki::Prefs::PrefsCache( $this, undef, &#39;TOPIC&#39; );</td></tr>
<tr><td class="h">313</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$cache-&gt;loadPrefsFromText( $text, $meta, $web, $topic );</td></tr>
<tr><td class="h">314</td><td colspan="6"></td></tr><tr><td class="h">315</td><td><div class="c3">14</div></td><td></td><td></td><td></td><td><div>92</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $cache-&gt;{values}{$key};</td></tr>
<tr><td class="h">316</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">317</td><td colspan="6"></td></tr><tr><td class="h">318 - 329</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getWebPreferencesValue( $key, $web ) -&gt; $value

Recover a preferences value that is defined in the webhome topic of
a specific web.. Does not recover user or global settings, but
does recover settings from containing webs.

Intended for use in protections mechanisms, where the order doesn&#39;t match
the prefs stack.

=cut</pre></td></tr>
<tr><td class="h">330</td><td colspan="6"></td></tr><tr><td class="h">331</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getWebPreferencesValue {</td></tr>
<tr><td class="h">332</td><td><div class="c3">28</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L332">28</a></div></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $key, $web ) = @_;</td></tr>
<tr><td class="h">333</td><td colspan="6"></td></tr><tr><td class="h">334</td><td><div class="c3">28</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L334">50</a></div></td><td></td><td></td><td><div>121</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return undef unless defined $web;</td></tr>
<tr><td class="h">335</td><td colspan="6"></td></tr><tr><td class="h">336</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td><div>116</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $wtn = $web.&#39;.&#39;.$TWiki::cfg{WebPrefsTopicName};</td></tr>
<tr><td class="h">337</td><td colspan="6"></td></tr><tr><td class="h">338</td><td><div class="c3">28</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L338">100</a></div></td><td></td><td></td><td><div>157</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless( $this-&gt;{WEBS}{$wtn} ) {</td></tr>
<tr><td class="h">339</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $blank = new TWiki::Prefs( $this-&gt;{session} );</td></tr>
<tr><td class="h">340</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$blank-&gt;pushWebPreferences( $web );</td></tr>
<tr><td class="h">341</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>25</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{WEBS}{$wtn} = $blank;</td></tr>
<tr><td class="h">342</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">343</td><td colspan="6"></td></tr><tr><td class="h">344</td><td><div class="c3">28</div></td><td></td><td></td><td></td><td><div>134</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{WEBS}{$wtn}-&gt;getPreferencesValue( $key );</td></tr>
<tr><td class="h">345</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">346</td><td colspan="6"></td></tr><tr><td class="h">347 - 353</td><td colspan="5"></td><td class="s"><pre>=pod

---++ObjectMethod stringify() -&gt; $text

Generate a TML-formatted version of the current preferences

=cut</pre></td></tr>
<tr><td class="h">354</td><td colspan="6"></td></tr><tr><td class="h">355</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub stringify {</td></tr>
<tr><td class="h">356</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Prefs-pm--subroutine.html#L356">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $html ) = @_;</td></tr>
<tr><td class="h">357</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $s = &#39;&#39;;</td></tr>
<tr><td class="h">358</td><td colspan="6"></td></tr><tr><td class="h">359</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my %shown;</td></tr>
<tr><td class="h">360</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L360">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$html = 1 unless defined $html;</td></tr>
<tr><td class="h">361</td><td colspan="6"></td></tr><tr><td class="h">362</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $ptr ( reverse @{$this-&gt;{PREFS}} ) {</td></tr>
<tr><td class="h">363</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s .= $ptr-&gt;stringify($html, \%shown);</td></tr>
<tr><td class="h">364</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">365</td><td colspan="6"></td></tr><tr><td class="h">366</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Prefs-pm--branch.html#L366">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $html ) {</td></tr>
<tr><td class="h">367</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return CGI::table({style=&gt;&#39;width: 100%&#39;,class=&gt;&#39;twikiTable&#39;}, $s);</td></tr>
<tr><td class="h">368</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">369</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $s;</td></tr>
<tr><td class="h">370</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">371</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">372</td><td colspan="6"></td></tr><tr><td class="h">373</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
