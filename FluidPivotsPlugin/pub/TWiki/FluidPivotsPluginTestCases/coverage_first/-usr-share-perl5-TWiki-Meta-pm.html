<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 0.61
Devel::Cover is copyright 2001-2006, Paul Johnson (pjcj@cpan.org)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: /usr/share/perl5/TWiki/Meta.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">/usr/share/perl5/TWiki/Meta.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">36.0%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Module of TWiki Enterprise Collaboration Platform, http://TWiki.org/</td></tr>
<tr><td class="h">2</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">3</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Copyright (C) 2001-2007 Peter Thoeny, peter@thoeny.org</td></tr>
<tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td class="s"># and TWiki Contributors. All Rights Reserved. TWiki Contributors</td></tr>
<tr><td class="h">5</td><td></td><td></td><td></td><td></td><td></td><td class="s"># are listed in the AUTHORS file in the root of this distribution.</td></tr>
<tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td class="s"># NOTE: Please extend that file, not this notice.</td></tr>
<tr><td class="h">7</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is free software; you can redistribute it and/or</td></tr>
<tr><td class="h">9</td><td></td><td></td><td></td><td></td><td></td><td class="s"># modify it under the terms of the GNU General Public License</td></tr>
<tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td class="s"># as published by the Free Software Foundation; either version 2</td></tr>
<tr><td class="h">11</td><td></td><td></td><td></td><td></td><td></td><td class="s"># of the License, or (at your option) any later version. For</td></tr>
<tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s"># more details read LICENSE in the root of this distribution.</td></tr>
<tr><td class="h">13</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is distributed in the hope that it will be useful,</td></tr>
<tr><td class="h">15</td><td></td><td></td><td></td><td></td><td></td><td class="s"># but WITHOUT ANY WARRANTY; without even the implied warranty of</td></tr>
<tr><td class="h">16</td><td></td><td></td><td></td><td></td><td></td><td class="s"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</td></tr>
<tr><td class="h">17</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">18</td><td></td><td></td><td></td><td></td><td></td><td class="s"># As per the GPL, removal of this notice is prohibited.</td></tr>
<tr><td class="h">19</td><td colspan="6"></td></tr><tr><td class="h">20 - 46</td><td colspan="5"></td><td class="s"><pre>=pod

---+ package TWiki::Meta

Meta-data handling.

A meta-data object is a hash of different types of meta-data (keyed on
the type, such as &#39;FIELD&#39; and &#39;TOPICINFO&#39;).

Each entry in the hash is an array, where each entry in the array
contains another hash of the key=value pairs, corresponding to a
single meta-datum.

If there may be multiple entries of the same top-level type (i.e. for FIELD
and FILEATTACHMENT) then the array hash multiple entries. These types
are referred to as &quot;keyed&quot; types. The array entries are keyed with the
attribute &#39;name&#39; which must be in each entry in the array.

For unkeyed types, the array has only one entry.

The module knows nothing about how meta-data is stored. That is entirely the
responsibility of the Store module.

Meta-data objects are created by the Store engine when topics are read. They
are populated using the =put= method.

=cut</pre></td></tr>
<tr><td class="h">47</td><td colspan="6"></td></tr><tr><td class="h">48</td><td></td><td></td><td></td><td></td><td></td><td class="s">package TWiki::Meta;</td></tr>
<tr><td class="h">49</td><td colspan="6"></td></tr><tr><td class="h">50</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L50">1</a></div></td><td><div>13</div><div>3</div><div>7</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">51</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L51">1</a></div></td><td><div>10</div><div>4</div><div>6</div></td><td class="s">use Error qw(:try);</td></tr>
<tr><td class="h">52</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L52">1</a></div></td><td><div>12</div><div>4</div><div>8</div></td><td class="s">use Assert;</td></tr>
<tr><td class="h">53</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L53">1</a></div></td><td><div>15</div><div>3</div><div>10</div></td><td class="s">use TWiki::Merge;</td></tr>
<tr><td class="h">54</td><td colspan="6"></td></tr><tr><td class="h">55 - 61</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ClassMethod new($session, $web, $topic)

Construct a new, empty Meta collection.

=cut</pre></td></tr>
<tr><td class="h">62</td><td colspan="6"></td></tr><tr><td class="h">63</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">64</td><td><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L64">44</a></div></td><td><div>212</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $class, $session, $web, $topic ) = @_;</td></tr>
<tr><td class="h">65</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>114</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($session-&gt;isa( &#39;TWiki&#39;)) if DEBUG;</td></tr>
<tr><td class="h">66</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>253</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = bless( {}, $class );</td></tr>
<tr><td class="h">67</td><td colspan="6"></td></tr><tr><td class="h">68</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Note: internal fields must be prepended with _. All other</td></tr>
<tr><td class="h">69</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# fields will be assumed to be meta-data.</td></tr>
<tr><td class="h">70</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{_session} = $session;</td></tr>
<tr><td class="h">71</td><td colspan="6"></td></tr><tr><td class="h">72</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>117</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($web) if DEBUG;</td></tr>
<tr><td class="h">73</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>100</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($topic) if DEBUG;</td></tr>
<tr><td class="h">74</td><td colspan="6"></td></tr><tr><td class="h">75</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>170</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{_web} = $web;</td></tr>
<tr><td class="h">76</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>179</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{_topic} = $topic;</td></tr>
<tr><td class="h">77</td><td colspan="6"></td></tr><tr><td class="h">78</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>178</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{FILEATTACHMENT} = [];</td></tr>
<tr><td class="h">79</td><td colspan="6"></td></tr><tr><td class="h">80</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this;</td></tr>
<tr><td class="h">81</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">82</td><td colspan="6"></td></tr><tr><td class="h">83 - 89</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ClassMethod web()

Get the web name

=cut</pre></td></tr>
<tr><td class="h">90</td><td colspan="6"></td></tr><tr><td class="h">91</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub web {</td></tr>
<tr><td class="h">92</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L92">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $_[0]-&gt;{_web};</td></tr>
<tr><td class="h">93</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">94</td><td colspan="6"></td></tr><tr><td class="h">95 - 101</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ClassMethod topic()

Get the topic name

=cut</pre></td></tr>
<tr><td class="h">102</td><td colspan="6"></td></tr><tr><td class="h">103</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub topic {</td></tr>
<tr><td class="h">104</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L104">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $_[0]-&gt;{_topic};</td></tr>
<tr><td class="h">105</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">106</td><td colspan="6"></td></tr><tr><td class="h">107 - 116</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod put($type, \%args)

Put a hash of key=value pairs into the given type set in this meta.

See the main comment for this package to understand how meta-data is
represented.

=cut</pre></td></tr>
<tr><td class="h">117</td><td colspan="6"></td></tr><tr><td class="h">118</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub put {</td></tr>
<tr><td class="h">119</td><td><div class="c3">43</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L119">43</a></div></td><td><div>183</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type, $args ) = @_;</td></tr>
<tr><td class="h">120</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td><div>109</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">121</td><td colspan="6"></td></tr><tr><td class="h">122</td><td><div class="c3">43</div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $data = $this-&gt;{$type};</td></tr>
<tr><td class="h">123</td><td><div class="c3">43</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L123">50</a></div></td><td></td><td></td><td><div>165</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $data ) {</td></tr>
<tr><td class="h">124</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# overwrite old single value</td></tr>
<tr><td class="h">125</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data-&gt;[0] = $args;</td></tr>
<tr><td class="h">126</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">127</td><td><div class="c3">43</div><div class="c3">43</div></td><td></td><td></td><td></td><td><div>114</div><div>248</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{$type}}, $args );</td></tr>
<tr><td class="h">128</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">129</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">130</td><td colspan="6"></td></tr><tr><td class="h">131 - 140</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod putKeyed($type, \%args)

Put a hash of key=value pairs into the given type set in this meta. The
entries are keyed by &#39;name&#39;.

See the main comment for this package to understand how meta-data is
represented.
=cut</pre></td></tr>
<tr><td class="h">141</td><td colspan="6"></td></tr><tr><td class="h">142</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Note: Array is used instead of a hash to preserve sequence</td></tr>
<tr><td class="h">143</td><td colspan="6"></td></tr><tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub putKeyed {</td></tr>
<tr><td class="h">145</td><td><div class="c3">116</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L145">116</a></div></td><td><div>472</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type, $args ) = @_;</td></tr>
<tr><td class="h">146</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td><div>276</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">147</td><td colspan="6"></td></tr><tr><td class="h">148</td><td><div class="c3">116</div></td><td></td><td></td><td></td><td><div>382</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $data = $this-&gt;{$type};</td></tr>
<tr><td class="h">149</td><td><div class="c3">116</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L149">100</a></div></td><td></td><td></td><td><div>418</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $data ) {</td></tr>
<tr><td class="h">150</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td><div>333</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $keyName = $args-&gt;{name};</td></tr>
<tr><td class="h">151</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td><div>245</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ASSERT( $keyName ) if DEBUG;</td></tr>
<tr><td class="h">152</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td><div>300</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $i = scalar( @$data );</td></tr>
<tr><td class="h">153</td><td><div class="c3">104</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L153">67</a></div></td><td></td><td><div>997</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;while( $keyName &amp;&amp; $i-- ) {</td></tr>
<tr><td class="h">154</td><td><div class="c3">1074</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L154">50</a></div></td><td></td><td></td><td><div>12208</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( $data-&gt;[$i]-&gt;{name} eq $keyName ) {</td></tr>
<tr><td class="h">155</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data-&gt;[$i] = $args;</td></tr>
<tr><td class="h">156</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return;</td></tr>
<tr><td class="h">157</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">158</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">159</td><td><div class="c3">104</div></td><td></td><td></td><td></td><td><div>774</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @$data, $args;</td></tr>
<tr><td class="h">160</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">161</td><td><div class="c3">12</div><div class="c3">12</div></td><td></td><td></td><td></td><td><div>32</div><div>199</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{$type}}, $args );</td></tr>
<tr><td class="h">162</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">163</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">164</td><td colspan="6"></td></tr><tr><td class="h">165 - 171</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod putAll

Replaces all the items of a given key with a new array
This is the logical inverse of the find method
=cut</pre></td></tr>
<tr><td class="h">172</td><td colspan="6"></td></tr><tr><td class="h">173</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub putAll {</td></tr>
<tr><td class="h">174</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L174">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type, @array ) = @_;</td></tr>
<tr><td class="h">175</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">176</td><td colspan="6"></td></tr><tr><td class="h">177</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{$type} = \@array;</td></tr>
<tr><td class="h">178</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">179</td><td colspan="6"></td></tr><tr><td class="h">180 - 193</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod get( $type, $key ) -&gt; \%hash

Find the value of a meta-datum in the map. If the type is 
keyed, the $key parameter is required to say _which_
entry you want. Otherwise it can be undef.

WARNING SMELL If key is undef but the type is keyed you get the FIRST entry
If you want all the keys of a given type use the &#39;find&#39; method.

The result is a reference to the hash for the item.

=cut</pre></td></tr>
<tr><td class="h">194</td><td colspan="6"></td></tr><tr><td class="h">195</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub get {</td></tr>
<tr><td class="h">196</td><td><div class="c3">87</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L196">87</a></div></td><td><div>338</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type, $keyValue ) = @_;</td></tr>
<tr><td class="h">197</td><td><div class="c3">87</div></td><td></td><td></td><td></td><td><div>198</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">198</td><td colspan="6"></td></tr><tr><td class="h">199</td><td><div class="c3">87</div></td><td></td><td></td><td></td><td><div>289</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $data = $this-&gt;{$type};</td></tr>
<tr><td class="h">200</td><td><div class="c3">87</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L200">100</a></div></td><td></td><td></td><td><div>373</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $data ) {</td></tr>
<tr><td class="h">201</td><td><div class="c3">47</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L201">50</a></div></td><td></td><td></td><td><div>184</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( defined $keyValue ) {</td></tr>
<tr><td class="h">202</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $item ( @$data ) {</td></tr>
<tr><td class="h">203</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L203">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $item if( $item-&gt;{name} eq $keyValue );</td></tr>
<tr><td class="h">204</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">205</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">206</td><td><div class="c3">47</div></td><td></td><td></td><td></td><td><div>222</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $data-&gt;[0];</td></tr>
<tr><td class="h">207</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">208</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">209</td><td colspan="6"></td></tr><tr><td class="h">210</td><td><div class="c3">40</div></td><td></td><td></td><td></td><td><div>156</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">211</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">212</td><td colspan="6"></td></tr><tr><td class="h">213 - 221</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod find (  $type  ) -&gt; @values

Get all meta data for a specific type
Returns the array stored for the type. This will be zero length
if there are no entries.

=cut</pre></td></tr>
<tr><td class="h">222</td><td colspan="6"></td></tr><tr><td class="h">223</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub find {</td></tr>
<tr><td class="h">224</td><td><div class="c3">39</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L224">39</a></div></td><td><div>137</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type ) = @_;</td></tr>
<tr><td class="h">225</td><td><div class="c3">39</div></td><td></td><td></td><td></td><td><div>94</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">226</td><td colspan="6"></td></tr><tr><td class="h">227</td><td><div class="c3">39</div></td><td></td><td></td><td></td><td><div>131</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $itemsr = $this-&gt;{$type};</td></tr>
<tr><td class="h">228</td><td><div class="c3">39</div></td><td></td><td></td><td></td><td><div>118</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @items = ();</td></tr>
<tr><td class="h">229</td><td colspan="6"></td></tr><tr><td class="h">230</td><td><div class="c3">39</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L230">100</a></div></td><td></td><td></td><td><div>168</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $itemsr ) {</td></tr>
<tr><td class="h">231</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@items = @$itemsr;</td></tr>
<tr><td class="h">232</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">233</td><td colspan="6"></td></tr><tr><td class="h">234</td><td><div class="c3">39</div></td><td></td><td></td><td></td><td><div>160</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @items;</td></tr>
<tr><td class="h">235</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">236</td><td colspan="6"></td></tr><tr><td class="h">237 - 246</td><td colspan="5"></td><td class="s"><pre>=pod

---++ StaticMethod indexByKey

See tests/unit/MetaTests.pm for an example

The result is a hash the same as the array provided by find but keyed by the keyName.
NB. results are indeterminate if the key you choose is not unique in the find. 

=cut</pre></td></tr>
<tr><td class="h">247</td><td colspan="6"></td></tr><tr><td class="h">248</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub indexByKey {</td></tr>
<tr><td class="h">249</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L249">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $keyName, @array) = @_;</td></tr>
<tr><td class="h">250</td><td colspan="6"></td></tr><tr><td class="h">251</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %findKeyed = ();</td></tr>
<tr><td class="h">252</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $result (@array) {</td></tr>
<tr><td class="h">253</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $key = $result-&gt;{$keyName};</td></tr>
<tr><td class="h">254</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$findKeyed{$key} = $result;</td></tr>
<tr><td class="h">255</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">256</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return %findKeyed;</td></tr>
<tr><td class="h">257</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">258</td><td colspan="6"></td></tr><tr><td class="h">259 - 266</td><td colspan="5"></td><td class="s"><pre>=pod

Flattens a keyed hash structure, taking only the values.
Returns a hash.

See tests/unit/MetaTests.pm for an example

=cut</pre></td></tr>
<tr><td class="h">267</td><td colspan="6"></td></tr><tr><td class="h">268</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub deindexKeyed {</td></tr>
<tr><td class="h">269</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L269">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my (%hash) =@_;</td></tr>
<tr><td class="h">270</td><td colspan="6"></td></tr><tr><td class="h">271</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @array = ();</td></tr>
<tr><td class="h">272</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $key (keys %hash) {</td></tr>
<tr><td class="h">273</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $value = $hash{$key};</td></tr>
<tr><td class="h">274</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @array, $value;</td></tr>
<tr><td class="h">275</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">276</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return @array;</td></tr>
<tr><td class="h">277</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">278</td><td colspan="6"></td></tr><tr><td class="h">279 - 289</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod remove ( $type, $key )

With no type, will remove all the contents of the object.

With a $type but no $key, will remove _all_ items of that type (so for example if $type were FILEATTACHMENT it would remove all of them)

With a $type and a $key it will remove only the specific item.

=cut</pre></td></tr>
<tr><td class="h">290</td><td colspan="6"></td></tr><tr><td class="h">291</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub remove {</td></tr>
<tr><td class="h">292</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L292">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type, $keyValue ) = @_;</td></tr>
<tr><td class="h">293</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">294</td><td colspan="6"></td></tr><tr><td class="h">295</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L295">0</a></div><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L295">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $keyValue ) {</td></tr>
<tr><td class="h">296</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $data = $this-&gt;{$type};</td></tr>
<tr><td class="h">297</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @newData = ();</td></tr>
<tr><td class="h">298</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $item ( @$data ) {</td></tr>
<tr><td class="h">299</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L299">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( $item-&gt;{name} ne $keyValue ) {</td></tr>
<tr><td class="h">300</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push @newData, $item;</td></tr>
<tr><td class="h">301</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">302</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">303</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{$type} = \@newData;</td></tr>
<tr><td class="h">304</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} elsif( $type ) {</td></tr>
<tr><td class="h">305</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;delete $this-&gt;{$type};</td></tr>
<tr><td class="h">306</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">307</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $entry ( keys %$this ) {</td></tr>
<tr><td class="h">308</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L308">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless( $entry =~ /^_/ ) {</td></tr>
<tr><td class="h">309</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;remove( $entry );</td></tr>
<tr><td class="h">310</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">311</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">312</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">313</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">314</td><td colspan="6"></td></tr><tr><td class="h">315 - 331</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod copyFrom( $otherMeta, $type, $nameFilter )

Copy all entries of a type from another meta data set. This
will destroy the old values for that type, unless the
copied object doesn&#39;t contain entries for that type, in which
case it will retain the old values.

If $type is undef, will copy ALL TYPES.

If $nameFilter is defined (an RE), it will copy only data where
{name} matches $nameFilter.

SMELL: This is a shallow copy

=cut</pre></td></tr>
<tr><td class="h">332</td><td colspan="6"></td></tr><tr><td class="h">333</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub copyFrom {</td></tr>
<tr><td class="h">334</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L334">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $otherMeta, $type, $filter ) = @_;</td></tr>
<tr><td class="h">335</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">336</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($otherMeta-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">337</td><td colspan="6"></td></tr><tr><td class="h">338</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L338">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $type ) {</td></tr>
<tr><td class="h">339</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $item ( @{$otherMeta-&gt;{$type}} ) {</td></tr>
<tr><td class="h">340</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L340">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L340">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( !$filter || ( $item-&gt;{name} &amp;&amp; $item-&gt;{name} =~ /$filter/ )) {</td></tr>
<tr><td class="h">341</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my %data;</td></tr>
<tr><td class="h">342</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $k ( keys %$item ) {</td></tr>
<tr><td class="h">343</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data{$k} = $item-&gt;{$k};</td></tr>
<tr><td class="h">344</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">345</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{$type}}, \%data );</td></tr>
<tr><td class="h">346</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">347</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">348</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">349</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $k ( keys %$otherMeta ) {</td></tr>
<tr><td class="h">350</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L350">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless( $k =~ /^_/ ) {</td></tr>
<tr><td class="h">351</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;copyFrom( $otherMeta, $k );</td></tr>
<tr><td class="h">352</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">353</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">354</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">355</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">356</td><td colspan="6"></td></tr><tr><td class="h">357 - 363</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod count (  $type  ) -&gt; $integer

Return the number of entries of the given type that are in this meta set

=cut</pre></td></tr>
<tr><td class="h">364</td><td colspan="6"></td></tr><tr><td class="h">365</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub count {</td></tr>
<tr><td class="h">366</td><td><div class="c3">44</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L366">44</a></div></td><td><div>163</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $type ) = @_;</td></tr>
<tr><td class="h">367</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>108</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">368</td><td><div class="c3">44</div></td><td></td><td></td><td></td><td><div>141</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $data = $this-&gt;{$type};</td></tr>
<tr><td class="h">369</td><td colspan="6"></td></tr><tr><td class="h">370</td><td><div class="c3">44</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L370">100</a></div></td><td></td><td></td><td><div>409</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return scalar @$data if( defined( $data ));</td></tr>
<tr><td class="h">371</td><td colspan="6"></td></tr><tr><td class="h">372</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">373</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">374</td><td colspan="6"></td></tr><tr><td class="h">375 - 386</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getRevisionInfo($fromrev) -&gt; ( $date, $author, $rev, $comment )

Try and get revision info from the meta information, or, if it is not
present, kick down to the Store module for the same information.

Returns ( $revDate, $author, $rev, $comment )

$rev is an integer revision number.

=cut</pre></td></tr>
<tr><td class="h">387</td><td colspan="6"></td></tr><tr><td class="h">388</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getRevisionInfo {</td></tr>
<tr><td class="h">389</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L389">2</a></div></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $fromrev ) = @_;</td></tr>
<tr><td class="h">390</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::Meta&#39;)) if DEBUG;</td></tr>
<tr><td class="h">391</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $store = $this-&gt;{_session}-&gt;{store};</td></tr>
<tr><td class="h">392</td><td colspan="6"></td></tr><tr><td class="h">393</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $topicinfo = $this-&gt;get( &#39;TOPICINFO&#39; );</td></tr>
<tr><td class="h">394</td><td colspan="6"></td></tr><tr><td class="h">395</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $date, $author, $rev, $comment );</td></tr>
<tr><td class="h">396</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L396">50</a></div></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $topicinfo ) {</td></tr>
<tr><td class="h">397</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$date = $topicinfo-&gt;{date} ;</td></tr>
<tr><td class="h">398</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$author = $this-&gt;{_session}-&gt;{users}-&gt;findUser($topicinfo-&gt;{author});</td></tr>
<tr><td class="h">399</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rev = $topicinfo-&gt;{version};</td></tr>
<tr><td class="h">400</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rev =~ s/^\$Rev(:\s*\d+)?\s*\$$/0/; # parse out SVN keywords in doc</td></tr>
<tr><td class="h">401</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$rev =~ s/^\d+\.//;</td></tr>
<tr><td class="h">402</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$comment = &#39;&#39;;</td></tr>
<tr><td class="h">403</td><td><div class="c3">2</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L403">50</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L403">33</a></div></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( !$fromrev || $rev eq $fromrev ) {</td></tr>
<tr><td class="h">404</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return( $date, $author, $rev, $comment );</td></tr>
<tr><td class="h">405</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">406</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">407</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Different rev, or no topic info, delegate to Store</td></tr>
<tr><td class="h">408</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;( $date, $author, $rev, $comment ) =</td></tr>
<tr><td class="h">409</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$store-&gt;getRevisionInfo( $this-&gt;{_web}, $this-&gt;{_topic}, $fromrev );</td></tr>
<tr><td class="h">410</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return( $date, $author, $rev, $comment );</td></tr>
<tr><td class="h">411</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">412</td><td colspan="6"></td></tr><tr><td class="h">413 - 428</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod merge( $otherMeta, $formDef )

   * =$otherMeta= - a block of meta-data to merge with $this
   * =$formDef= reference to a TWiki::Form that gives the types of the fields in $this

Merge the data in the other meta block.
   * File attachments that only appear in one set are preserved.
   * Form fields that only appear in one set are preserved.
   * Form field values that are different in each set are text-merged
   * We don&#39;t merge for field attributes or title
   * Topic info is not touched
   * The =mergeable= method on the form def is used to determine if that fields is mergeable. if it isn&#39;t, the value currently in meta will _not_ be changed.

=cut</pre></td></tr>
<tr><td class="h">429</td><td colspan="6"></td></tr><tr><td class="h">430</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub merge {</td></tr>
<tr><td class="h">431</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L431">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $this, $other, $formDef ) = @_;</td></tr>
<tr><td class="h">432</td><td colspan="6"></td></tr><tr><td class="h">433</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $data = $other-&gt;{FIELD};</td></tr>
<tr><td class="h">434</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L434">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $data ) {</td></tr>
<tr><td class="h">435</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $otherD ( @$data ) {</td></tr>
<tr><td class="h">436</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $thisD = $this-&gt;get( &#39;FIELD&#39;, $otherD-&gt;{name} );</td></tr>
<tr><td class="h">437</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L437">0</a></div><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L437">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L437">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $thisD &amp;&amp; $thisD-&gt;{value} ne $otherD-&gt;{value} ) {</td></tr>
<tr><td class="h">438</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L438">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( $formDef-&gt;isTextMergeable( $thisD-&gt;{name} )) {</td></tr>
<tr><td class="h">439</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $merged = TWiki::Merge::merge2(</td></tr>
<tr><td class="h">440</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;A&#39;, $otherD-&gt;{value}, &#39;B&#39;, $thisD-&gt;{value},</td></tr>
<tr><td class="h">441</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;.*?\s+&#39;,</td></tr>
<tr><td class="h">442</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{_session},</td></tr>
<tr><td class="h">443</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$formDef-&gt;getField( $thisD-&gt;{name} ) );</td></tr>
<tr><td class="h">444</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# SMELL: we don&#39;t merge attributes or title</td></tr>
<tr><td class="h">445</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$thisD-&gt;{value} = $merged;</td></tr>
<tr><td class="h">446</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">447</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} elsif ( !$thisD ) {</td></tr>
<tr><td class="h">448</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;putKeyed(&#39;FIELD&#39;, $otherD );</td></tr>
<tr><td class="h">449</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">450</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">451</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">452</td><td colspan="6"></td></tr><tr><td class="h">453</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$data = $other-&gt;{FILEATTACHMENT};</td></tr>
<tr><td class="h">454</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L454">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $data ) {</td></tr>
<tr><td class="h">455</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $otherD ( @$data ) {</td></tr>
<tr><td class="h">456</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $thisD = $this-&gt;get( &#39;FILEATTACHMENT&#39;, $otherD-&gt;{name} );</td></tr>
<tr><td class="h">457</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L457">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( !$thisD ) {</td></tr>
<tr><td class="h">458</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;putKeyed(&#39;FILEATTACHMENT&#39;, $otherD );</td></tr>
<tr><td class="h">459</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">460</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">461</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">462</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">463</td><td colspan="6"></td></tr><tr><td class="h">464 - 471</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod stringify( $types ) -&gt; $string

Return a string version of the meta object. Uses \n to separate lines.
If $types is specified, return only types specified by that RE.

=cut</pre></td></tr>
<tr><td class="h">472</td><td colspan="6"></td></tr><tr><td class="h">473</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub stringify {</td></tr>
<tr><td class="h">474</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L474">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $types ) = @_;</td></tr>
<tr><td class="h">475</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $s = &#39;&#39;;</td></tr>
<tr><td class="h">476</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L476">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$types ||= qr/^[A-Z]+$/;</td></tr>
<tr><td class="h">477</td><td colspan="6"></td></tr><tr><td class="h">478</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $type ( grep { /$types/ } keys %$this ) {</td></tr>
<tr><td class="h">479</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $item ( @{$this-&gt;{$type}} ) {</td></tr>
<tr><td class="h">480</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L480">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$s .= &quot;$type: &quot; .</td></tr>
<tr><td class="h">481</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;join(&#39; &#39;, map{ &quot;$_=&#39;&quot;.($item-&gt;{$_}||&#39;&#39;).&quot;&#39;&quot; }</td></tr>
<tr><td class="h">482</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sort keys %$item ) .</td></tr>
<tr><td class="h">483</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&quot;\n&quot;;</td></tr>
<tr><td class="h">484</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">485</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">486</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $s;</td></tr>
<tr><td class="h">487</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">488</td><td colspan="6"></td></tr><tr><td class="h">489 - 505</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod forEachSelectedValue( $types, $keys, \&amp;fn, \%options )

Iterate over the values selected by the regular expressions in $types and
$keys.
   * =$types= - regular expression matching the names of fields to be processed. Will default to qr/^[A-Z]+$/ if undef.
   * =$keys= - regular expression matching the names of keys to be processed.  Will default to qr/^[a-z]+$/ if undef.

Iterates over each value, calling =\&amp;fn= on each, and replacing the value
with the result of \&amp;fn.

\%options will be passed on to $fn, with the following additions:
   * =_type= =&gt; the type name (e.g. &quot;FILEATTACHMENT&quot;)
   * =_key= =&gt; the key name (e.g. &quot;user&quot;)

=cut</pre></td></tr>
<tr><td class="h">506</td><td colspan="6"></td></tr><tr><td class="h">507</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub forEachSelectedValue {</td></tr>
<tr><td class="h">508</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L508">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $types, $keys, $fn, $options ) = @_;</td></tr>
<tr><td class="h">509</td><td colspan="6"></td></tr><tr><td class="h">510</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L510">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$types ||= qr/^[A-Z]+$/;</td></tr>
<tr><td class="h">511</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--condition.html#L511">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$keys ||= qr/^[a-z]+$/;</td></tr>
<tr><td class="h">512</td><td colspan="6"></td></tr><tr><td class="h">513</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $type ( grep { /$types/ } keys %$this ) {</td></tr>
<tr><td class="h">514</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options-&gt;{_type} = $type;</td></tr>
<tr><td class="h">515</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $data = $this-&gt;{$type};</td></tr>
<tr><td class="h">516</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L516">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next unless $data;</td></tr>
<tr><td class="h">517</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $datum ( @$data ) {</td></tr>
<tr><td class="h">518</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $key ( grep { /$keys/ } keys %$datum ) {</td></tr>
<tr><td class="h">519</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options-&gt;{_key} = $key;</td></tr>
<tr><td class="h">520</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$datum-&gt;{$key} = &amp;$fn( $datum-&gt;{$key}, $options );</td></tr>
<tr><td class="h">521</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">522</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">523</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">524</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">525</td><td colspan="6"></td></tr><tr><td class="h">526 - 532</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getParent() -&gt; $parent

Gets the TOPICPARENT name.

=cut</pre></td></tr>
<tr><td class="h">533</td><td colspan="6"></td></tr><tr><td class="h">534</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getParent {</td></tr>
<tr><td class="h">535</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L535">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this ) = @_;</td></tr>
<tr><td class="h">536</td><td colspan="6"></td></tr><tr><td class="h">537</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $value = &#39;&#39;;</td></tr>
<tr><td class="h">538</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $parent = $this-&gt;get( &#39;TOPICPARENT&#39; );</td></tr>
<tr><td class="h">539</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L539">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$value = $parent-&gt;{name} if( $parent );</td></tr>
<tr><td class="h">540</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Return empty string (not undef), if TOPICPARENT meta is broken</td></tr>
<tr><td class="h">541</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L541">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$value = &#39;&#39; if (!defined $value);</td></tr>
<tr><td class="h">542</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $value;</td></tr>
<tr><td class="h">543</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">544</td><td colspan="6"></td></tr><tr><td class="h">545 - 551</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getFormName() -&gt; $formname

Returns the name of the FORM, or &#39;&#39; if none.

=cut</pre></td></tr>
<tr><td class="h">552</td><td colspan="6"></td></tr><tr><td class="h">553</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getFormName {</td></tr>
<tr><td class="h">554</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Meta-pm--subroutine.html#L554">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this ) = @_;</td></tr>
<tr><td class="h">555</td><td colspan="6"></td></tr><tr><td class="h">556</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $aForm = $this-&gt;get( &#39;FORM&#39; );</td></tr>
<tr><td class="h">557</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Meta-pm--branch.html#L557">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $aForm ) {</td></tr>
<tr><td class="h">558</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $aForm-&gt;{name};</td></tr>
<tr><td class="h">559</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">560</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39;;</td></tr>
<tr><td class="h">561</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">562</td><td colspan="6"></td></tr><tr><td class="h">563</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
