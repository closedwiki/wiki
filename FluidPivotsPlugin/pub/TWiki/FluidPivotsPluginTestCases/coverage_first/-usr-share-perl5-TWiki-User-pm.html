<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 0.61
Devel::Cover is copyright 2001-2006, Paul Johnson (pjcj@cpan.org)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: /usr/share/perl5/TWiki/User.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">/usr/share/perl5/TWiki/User.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">47.9%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Module of TWiki Enterprise Collaboration Platform, http://TWiki.org/</td></tr>
<tr><td class="h">2</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">3</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Copyright (C) 1999-2007 TWiki Contributors.</td></tr>
<tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td class="s"># All Rights Reserved. TWiki Contributors</td></tr>
<tr><td class="h">5</td><td></td><td></td><td></td><td></td><td></td><td class="s"># are listed in the AUTHORS file in the root of this distribution.</td></tr>
<tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td class="s"># NOTE: Please extend that file, not this notice.</td></tr>
<tr><td class="h">7</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is free software; you can redistribute it and/or</td></tr>
<tr><td class="h">9</td><td></td><td></td><td></td><td></td><td></td><td class="s"># modify it under the terms of the GNU General Public License</td></tr>
<tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td class="s"># as published by the Free Software Foundation; either version 2</td></tr>
<tr><td class="h">11</td><td></td><td></td><td></td><td></td><td></td><td class="s"># of the License, or (at your option) any later version. For</td></tr>
<tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s"># more details read LICENSE in the root of this distribution.</td></tr>
<tr><td class="h">13</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is distributed in the hope that it will be useful,</td></tr>
<tr><td class="h">15</td><td></td><td></td><td></td><td></td><td></td><td class="s"># but WITHOUT ANY WARRANTY; without even the implied warranty of</td></tr>
<tr><td class="h">16</td><td></td><td></td><td></td><td></td><td></td><td class="s"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</td></tr>
<tr><td class="h">17</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">18</td><td></td><td></td><td></td><td></td><td></td><td class="s"># As per the GPL, removal of this notice is prohibited.</td></tr>
<tr><td class="h">19</td><td colspan="6"></td></tr><tr><td class="h">20</td><td></td><td></td><td></td><td></td><td></td><td class="s">package TWiki::User;</td></tr>
<tr><td class="h">21</td><td colspan="6"></td></tr><tr><td class="h">22</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L22">1</a></div></td><td><div>9</div><div>2</div><div>5</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">23</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L23">1</a></div></td><td><div>7</div><div>3</div><div>8</div></td><td class="s">use Assert;</td></tr>
<tr><td class="h">24</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L24">1</a></div></td><td><div>6</div><div>3</div><div>5</div></td><td class="s">use TWiki;</td></tr>
<tr><td class="h">25</td><td colspan="6"></td></tr><tr><td class="h">26 - 34</td><td colspan="5"></td><td class="s"><pre>=pod

---+ package TWiki::User

A User object is an internal representation of a user in the real world.
The object knows about users having login names, wiki names, personal
topics, and email addresses.

=cut</pre></td></tr>
<tr><td class="h">35</td><td colspan="6"></td></tr><tr><td class="h">36 - 44</td><td colspan="5"></td><td class="s"><pre>=pod

Groups are also handled here. A group is really a subclass of a user,
in that it is a user with a set of users within it.

The User package also provides methods for managing the passwords of the
user.

=cut</pre></td></tr>
<tr><td class="h">45</td><td colspan="6"></td></tr><tr><td class="h">46</td><td></td><td></td><td></td><td></td><td></td><td class="s"># global used by test harness to give predictable results</td></tr>
<tr><td class="h">47</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L47">1</a></div></td><td><div>6</div><div>3</div><div>4</div></td><td class="s">use vars qw( $password );</td></tr>
<tr><td class="h">48</td><td colspan="6"></td></tr><tr><td class="h">49</td><td></td><td></td><td></td><td></td><td></td><td class="s"># STATIC function that returns a random password</td></tr>
<tr><td class="h">50</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub randomPassword {</td></tr>
<tr><td class="h">51</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--condition.html#L51">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L51">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $password || int( rand(9999999999) );</td></tr>
<tr><td class="h">52</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">53</td><td colspan="6"></td></tr><tr><td class="h">54 - 65</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ClassMethod new( $session, $loginname, $wikiname )

Construct a new user object for the given login name, wiki name.

The wiki name can either be a wiki word or it can be a web-
qualified wiki word. If the wiki name is not web qualified, the
user is assumed to have their home topic in the
$TWiki::cfg{UsersWebName} web.

=cut</pre></td></tr>
<tr><td class="h">66</td><td colspan="6"></td></tr><tr><td class="h">67</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub new {</td></tr>
<tr><td class="h">68</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L68">5</a></div></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $class, $session, $name, $wikiname ) = @_;</td></tr>
<tr><td class="h">69</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($session-&gt;isa( &#39;TWiki&#39;)) if DEBUG;</td></tr>
<tr><td class="h">70</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($name) if DEBUG;</td></tr>
<tr><td class="h">71</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($wikiname) if DEBUG;</td></tr>
<tr><td class="h">72</td><td colspan="6"></td></tr><tr><td class="h">73</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = bless( {}, $class );</td></tr>
<tr><td class="h">74</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{session} = $session;</td></tr>
<tr><td class="h">75</td><td colspan="6"></td></tr><tr><td class="h">76</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>18</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{login} = $name;</td></tr>
<tr><td class="h">77</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>27</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic ) =</td></tr>
<tr><td class="h">78</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;normalizeWebTopicName( $TWiki::cfg{UsersWebName}, $wikiname );</td></tr>
<tr><td class="h">79</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>23</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{web} = $web;</td></tr>
<tr><td class="h">80</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{wikiname} = $topic;</td></tr>
<tr><td class="h">81</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{groups} = [];</td></tr>
<tr><td class="h">82</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this;</td></tr>
<tr><td class="h">83</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">84</td><td colspan="6"></td></tr><tr><td class="h">85 - 91</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod wikiName() -&gt; $wikiName

Return the wikiname of the user (without the web!)

=cut</pre></td></tr>
<tr><td class="h">92</td><td colspan="6"></td></tr><tr><td class="h">93</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub wikiName {</td></tr>
<tr><td class="h">94</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L94">16</a></div></td><td><div>51</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">95</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">96</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td><div>102</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{wikiname};</td></tr>
<tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">98</td><td colspan="6"></td></tr><tr><td class="h">99 - 105</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod webDotWikiName() -&gt; $webDotWiki

Return the fully qualified wikiname of the user

=cut</pre></td></tr>
<tr><td class="h">106</td><td colspan="6"></td></tr><tr><td class="h">107</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub webDotWikiName {</td></tr>
<tr><td class="h">108</td><td><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L108">7</a></div></td><td><div>22</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">109</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">110</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td><div>36</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;web().&#39;.&#39;.$this-&gt;wikiName();</td></tr>
<tr><td class="h">111</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">112</td><td colspan="6"></td></tr><tr><td class="h">113 - 119</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod login() -&gt; $loginName

Return the login name of the user

=cut</pre></td></tr>
<tr><td class="h">120</td><td colspan="6"></td></tr><tr><td class="h">121</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub login {</td></tr>
<tr><td class="h">122</td><td><div class="c3">19</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L122">19</a></div></td><td><div>61</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">123</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">124</td><td><div class="c3">19</div></td><td></td><td></td><td></td><td><div>147</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{login};</td></tr>
<tr><td class="h">125</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">126</td><td colspan="6"></td></tr><tr><td class="h">127 - 133</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod web() -&gt; $webName

Return the registration web of the user

=cut</pre></td></tr>
<tr><td class="h">134</td><td colspan="6"></td></tr><tr><td class="h">135</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub web {</td></tr>
<tr><td class="h">136</td><td><div class="c3">7</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L136">7</a></div></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">137</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">138</td><td><div class="c3">7</div></td><td></td><td></td><td></td><td><div>43</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{web};</td></tr>
<tr><td class="h">139</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">140</td><td colspan="6"></td></tr><tr><td class="h">141 - 147</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod equals() -&gt; $boolean

Test is this is the same user as another user object

=cut</pre></td></tr>
<tr><td class="h">148</td><td colspan="6"></td></tr><tr><td class="h">149</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub equals {</td></tr>
<tr><td class="h">150</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L150">1</a></div></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $other ) = @_;</td></tr>
<tr><td class="h">151</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">152</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($other-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">153</td><td colspan="6"></td></tr><tr><td class="h">154</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ( $this-&gt;{login} eq $other-&gt;{login} );</td></tr>
<tr><td class="h">155</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">156</td><td colspan="6"></td></tr><tr><td class="h">157 - 163</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod stringify() -&gt; $string

Generate a string representation of this object, suitable for debugging

=cut</pre></td></tr>
<tr><td class="h">164</td><td colspan="6"></td></tr><tr><td class="h">165</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub stringify {</td></tr>
<tr><td class="h">166</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L166">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">167</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">168</td><td colspan="6"></td></tr><tr><td class="h">169</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &quot;$this-&gt;{login}/$this-&gt;{web}.$this-&gt;{wikiname}&quot;;</td></tr>
<tr><td class="h">170</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">171</td><td colspan="6"></td></tr><tr><td class="h">172 - 179</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod passwordExists( ) -&gt; $boolean

Checks to see if there is an entry in the password system
Return &#39;1&#39; if true, &#39;&#39; if not

=cut</pre></td></tr>
<tr><td class="h">180</td><td colspan="6"></td></tr><tr><td class="h">181</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub passwordExists {</td></tr>
<tr><td class="h">182</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L182">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this  = shift;</td></tr>
<tr><td class="h">183</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">184</td><td colspan="6"></td></tr><tr><td class="h">185</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">186</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $passwordHandler-&gt;fetchPass($this-&gt;{login});</td></tr>
<tr><td class="h">187</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">188</td><td colspan="6"></td></tr><tr><td class="h">189 - 201</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod checkPassword( $password ) -&gt; $boolean

used to check the user&#39;s password

=$password= unencrypted password

=$success= &#39;1&#39; if success

TODO: need to improve the error mechanism so TWikiAdmins know what failed

=cut</pre></td></tr>
<tr><td class="h">202</td><td colspan="6"></td></tr><tr><td class="h">203</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub checkPassword {</td></tr>
<tr><td class="h">204</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L204">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $this, $password ) = @_;</td></tr>
<tr><td class="h">205</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">206</td><td colspan="6"></td></tr><tr><td class="h">207</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">208</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $passwordHandler-&gt;checkPassword($this-&gt;{login}, $password);</td></tr>
<tr><td class="h">209</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">210</td><td colspan="6"></td></tr><tr><td class="h">211 - 218</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod removePassword() -&gt; $boolean

Used to remove the user and password from the password system.
Returns true if success

=cut</pre></td></tr>
<tr><td class="h">219</td><td colspan="6"></td></tr><tr><td class="h">220</td><td></td><td></td><td></td><td></td><td></td><td class="s"># TODO: need to improve the error mechanism so TWikiAdmins know what failed</td></tr>
<tr><td class="h">221</td><td></td><td></td><td></td><td></td><td></td><td class="s"># SMELL - should this not also delete the user topic?</td></tr>
<tr><td class="h">222</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub removePassword {</td></tr>
<tr><td class="h">223</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L223">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">224</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">225</td><td colspan="6"></td></tr><tr><td class="h">226</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">227</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $passwordHandler-&gt;deleteUser( $this-&gt;{login} );</td></tr>
<tr><td class="h">228</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">229</td><td colspan="6"></td></tr><tr><td class="h">230 - 239</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod changePassword( $user, $oldUserPassword, $newUserPassword ) -&gt; $boolean

used to change the user&#39;s password
=$oldUserPassword= unencrypted password
=$newUserPassword= unencrypted password
undef if success, error message otherwise

=cut</pre></td></tr>
<tr><td class="h">240</td><td colspan="6"></td></tr><tr><td class="h">241</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub changePassword {</td></tr>
<tr><td class="h">242</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L242">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $this, $oldUserPassword, $newUserPassword ) = @_;</td></tr>
<tr><td class="h">243</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">244</td><td colspan="6"></td></tr><tr><td class="h">245</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">246</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L246">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $passwordHandler-&gt;passwd($this-&gt;{login},</td></tr>
<tr><td class="h">247</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newUserPassword, $oldUserPassword)) {</td></tr>
<tr><td class="h">248</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return undef;</td></tr>
<tr><td class="h">249</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">250</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $passwordHandler-&gt;{error};</td></tr>
<tr><td class="h">251</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">252</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">253</td><td colspan="6"></td></tr><tr><td class="h">254 - 263</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod addPassword( $newPassword ) -&gt; $boolean

creates a password entry
=$newUserPassword= unencrypted password
&#39;1&#39; if success
TODO: need to improve the error mechanism so TWikiAdmins know what failed

=cut</pre></td></tr>
<tr><td class="h">264</td><td colspan="6"></td></tr><tr><td class="h">265</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub addPassword {</td></tr>
<tr><td class="h">266</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L266">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $this, $newUserPassword ) = @_;</td></tr>
<tr><td class="h">267</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">268</td><td colspan="6"></td></tr><tr><td class="h">269</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">270</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $passwordHandler-&gt;passwd($this-&gt;{login}, $newUserPassword);</td></tr>
<tr><td class="h">271</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">272</td><td colspan="6"></td></tr><tr><td class="h">273 - 279</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod resetPassword() -&gt; $newPassword

Reset the users password, returning the new generated password.

=cut</pre></td></tr>
<tr><td class="h">280</td><td colspan="6"></td></tr><tr><td class="h">281</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub resetPassword {</td></tr>
<tr><td class="h">282</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L282">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">283</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">284</td><td colspan="6"></td></tr><tr><td class="h">285</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $password = randomPassword();</td></tr>
<tr><td class="h">286</td><td colspan="6"></td></tr><tr><td class="h">287</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# removePassword will probably remove current e-mail addresses, cache a copy</td></tr>
<tr><td class="h">288</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @tempEmails = $this-&gt;emails();</td></tr>
<tr><td class="h">289</td><td colspan="6"></td></tr><tr><td class="h">290</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L290">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $this-&gt;passwordExists() ) {</td></tr>
<tr><td class="h">291</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;removePassword();</td></tr>
<tr><td class="h">292</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">293</td><td colspan="6"></td></tr><tr><td class="h">294</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;addPassword( $password );</td></tr>
<tr><td class="h">295</td><td colspan="6"></td></tr><tr><td class="h">296</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# push cached e-mail addresses back on account</td></tr>
<tr><td class="h">297</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;setEmails( @tempEmails );</td></tr>
<tr><td class="h">298</td><td colspan="6"></td></tr><tr><td class="h">299</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $password;</td></tr>
<tr><td class="h">300</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">301</td><td colspan="6"></td></tr><tr><td class="h">302</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L302">0</a></div></td><td><div>0</div></td><td class="s">sub isDefaultUser {</td></tr>
<tr><td class="h">303</td><td></td><td></td><td></td><td></td><td></td><td class="s"># email must be empty string</td></tr>
<tr><td class="h">304</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">305</td><td colspan="6"></td></tr><tr><td class="h">306 - 313</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod emails() -&gt; @emailAddress

If this is a user, return their email addresses. If it is a group,
return the addresses of everyone in the group.

=cut</pre></td></tr>
<tr><td class="h">314</td><td colspan="6"></td></tr><tr><td class="h">315</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub emails {</td></tr>
<tr><td class="h">316</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L316">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">317</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">318</td><td colspan="6"></td></tr><tr><td class="h">319</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L319">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless( defined $this-&gt;{emails} ) {</td></tr>
<tr><td class="h">320</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@{$this-&gt;{emails}} = ();</td></tr>
<tr><td class="h">321</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L321">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $this-&gt;isGroup() ) {</td></tr>
<tr><td class="h">322</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;foreach my $member ( @{$this-&gt;groupMembers()} ) {</td></tr>
<tr><td class="h">323</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push( @{$this-&gt;{emails}}, $member-&gt;emails() );</td></tr>
<tr><td class="h">324</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">325</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">326</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">327</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;push(@{$this-&gt;{emails}}, $passwordHandler-&gt;getEmails($this-&gt;{login}));</td></tr>
<tr><td class="h">328</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">329</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">330</td><td colspan="6"></td></tr><tr><td class="h">331</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @{$this-&gt;{emails}};</td></tr>
<tr><td class="h">332</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">333</td><td colspan="6"></td></tr><tr><td class="h">334 - 340</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod setEmails($user, @emails)

Fetch the email address(es) for the given username

=cut</pre></td></tr>
<tr><td class="h">341</td><td colspan="6"></td></tr><tr><td class="h">342</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setEmails {</td></tr>
<tr><td class="h">343</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L343">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">344</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">345</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L345">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if $this-&gt;isGroup();</td></tr>
<tr><td class="h">346</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $passwordHandler = $this-&gt;{session}-&gt;{users}-&gt;{passwords};</td></tr>
<tr><td class="h">347</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $passwordHandler-&gt;setEmails($this-&gt;{login}, @_);</td></tr>
<tr><td class="h">348</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">349</td><td colspan="6"></td></tr><tr><td class="h">350</td><td colspan="6"></td></tr><tr><td class="h">351 - 357</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod isAdmin() -&gt; $boolean

True if the user is an admin (is a member of the $TWiki::cfg{SuperAdminGroup})

=cut</pre></td></tr>
<tr><td class="h">358</td><td colspan="6"></td></tr><tr><td class="h">359</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub isAdmin {</td></tr>
<tr><td class="h">360</td><td><div class="c3">12</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L360">12</a></div></td><td><div>58</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">361</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td><div>34</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">362</td><td><div class="c3">12</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L362">100</a></div></td><td></td><td></td><td><div>66</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless( defined($this-&gt;{isKnownAdmin}) ) {</td></tr>
<tr><td class="h">363</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L363">50</a></div></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ($this-&gt;{wikiname} eq $TWiki::cfg{SuperAdminGroup}) {</td></tr>
<tr><td class="h">364</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{isKnownAdmin} = 1;</td></tr>
<tr><td class="h">365</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">366</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $sag = $this-&gt;{session}-&gt;{users}-&gt;findUser(</td></tr>
<tr><td class="h">367</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::cfg{SuperAdminGroup} );</td></tr>
<tr><td class="h">368</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$this-&gt;{isKnownAdmin} = $this-&gt;isInList( $sag-&gt;groupMembers() );</td></tr>
<tr><td class="h">369</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">370</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">371</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td><div>76</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{isKnownAdmin};</td></tr>
<tr><td class="h">372</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">373</td><td colspan="6"></td></tr><tr><td class="h">374 - 380</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod getGroups( ) -&gt; @groups

Get a list of user objects for the groups a user is in

=cut</pre></td></tr>
<tr><td class="h">381</td><td colspan="6"></td></tr><tr><td class="h">382</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getGroups {</td></tr>
<tr><td class="h">383</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L383">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">384</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">385</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my @groupList = @{$this-&gt;{session}-&gt;{users}-&gt;getAllGroups()};</td></tr>
<tr><td class="h">386</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $groupObject (@groupList) {</td></tr>
<tr><td class="h">387</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$groupObject-&gt;groupMembers(); </td></tr>
<tr><td class="h">388</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">389</td><td colspan="6"></td></tr><tr><td class="h">390</td><td><div class="c0">0</div><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return @{$this-&gt;{groups}};</td></tr>
<tr><td class="h">391</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">392</td><td colspan="6"></td></tr><tr><td class="h">393 - 401</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod isInList( $list ) -&gt; $boolean

Return true we are in the list of user objects passed.

$list is a string representation of a user list.

=cut</pre></td></tr>
<tr><td class="h">402</td><td colspan="6"></td></tr><tr><td class="h">403</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub isInList {</td></tr>
<tr><td class="h">404</td><td><div class="c3">3</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L404">3</a></div></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $this, $userlist, $scanning ) = @_;</td></tr>
<tr><td class="h">405</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isa( &#39;TWiki::User&#39;)) if DEBUG;</td></tr>
<tr><td class="h">406</td><td><div class="c3">3</div></td><td><div class="c0" title="T/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L406">50</a></div></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$scanning = {} unless $scanning;</td></tr>
<tr><td class="h">407</td><td colspan="6"></td></tr><tr><td class="h">408</td><td><div class="c3">3</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L408">100</a></div></td><td></td><td></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless( ref( $userlist )) {</td></tr>
<tr><td class="h">409</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;# string parameter</td></tr>
<tr><td class="h">410</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$userlist = $this-&gt;{session}-&gt;{users}-&gt;expandUserList( $userlist );</td></tr>
<tr><td class="h">411</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">412</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user;</td></tr>
<tr><td class="h">413</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach $user ( @$userlist ) {</td></tr>
<tr><td class="h">414</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;#don&#39;t check the same user twice</td></tr>
<tr><td class="h">415</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L415">50</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;next if $scanning-&gt;{$user};</td></tr>
<tr><td class="h">416</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$scanning-&gt;{$user} = 1;</td></tr>
<tr><td class="h">417</td><td colspan="6"></td></tr><tr><td class="h">418</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L418">50</a></div></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $this-&gt;equals( $user );</td></tr>
<tr><td class="h">419</td><td><div class="c3">1</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L419">50</a></div></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( $user-&gt;isGroup() ) {</td></tr>
<tr><td class="h">420</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L420">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $this-&gt;isInList( $user-&gt;groupMembers(), $scanning );</td></tr>
<tr><td class="h">421</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">422</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">423</td><td><div class="c3">3</div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 0;</td></tr>
<tr><td class="h">424</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">425</td><td colspan="6"></td></tr><tr><td class="h">426 - 432</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod isGroup() -&gt; $boolean

Test if this is a group user or not

=cut</pre></td></tr>
<tr><td class="h">433</td><td colspan="6"></td></tr><tr><td class="h">434</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub isGroup {</td></tr>
<tr><td class="h">435</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L435">2</a></div></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">436</td><td colspan="6"></td></tr><tr><td class="h">437</td><td><div class="c3">2</div></td><td><div class="c3" title="T/F"><a href="-usr-share-perl5-TWiki-User-pm--branch.html#L437">100</a></div></td><td></td><td></td><td><div>16</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 if $this-&gt;{wikiname} eq $TWiki::cfg{SuperAdminGroup};</td></tr>
<tr><td class="h">438</td><td colspan="6"></td></tr><tr><td class="h">439</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{session}-&gt;{users}-&gt;{usermappingmanager}-&gt;isGroup($this);</td></tr>
<tr><td class="h">440</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">441</td><td colspan="6"></td></tr><tr><td class="h">442 - 449</td><td colspan="5"></td><td class="s"><pre>=pod

---++ ObjectMethod groupMembers() -&gt; @members

Return a list of  user objects that are members of this group. Should only be
called on groups.

=cut</pre></td></tr>
<tr><td class="h">450</td><td colspan="6"></td></tr><tr><td class="h">451</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub groupMembers {</td></tr>
<tr><td class="h">452</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-User-pm--subroutine.html#L452">1</a></div></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $this = shift;</td></tr>
<tr><td class="h">453</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($this-&gt;isGroup());</td></tr>
<tr><td class="h">454</td><td colspan="6"></td></tr><tr><td class="h">455</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $this-&gt;{session}-&gt;{users}-&gt;{usermappingmanager}-&gt;groupMembers($this);</td></tr>
<tr><td class="h">456</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">457</td><td colspan="6"></td></tr><tr><td class="h">458</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
</table>
</body>
</html>
