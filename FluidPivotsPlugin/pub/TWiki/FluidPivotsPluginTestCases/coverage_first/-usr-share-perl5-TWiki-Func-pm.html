<!DOCTYPE html
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<!--
This file was generated by Devel::Cover Version 0.61
Devel::Cover is copyright 2001-2006, Paul Johnson (pjcj@cpan.org)
Devel::Cover is free. It is licensed under the same terms as Perl itself.
The latest version of Devel::Cover should be available from my homepage:
http://www.pjcj.net
-->
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
    <meta http-equiv="Content-Language" content="en-us"></meta>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <link rel="stylesheet" type="text/css" href="cover.css"></link>
    <title>File Coverage: /usr/share/perl5/TWiki/Func.pm</title>
</head>
<body>
<h1>File Coverage</h1>
<table>
<tr><td class="h" align="right">File:</td><td align="left">/usr/share/perl5/TWiki/Func.pm</td></tr>
<tr><td class="h" align="right">Coverage:</td><td align="left" class="c0">18.8%</td></tr>
</table>
<div><br/></div>
<table>
<tr><th>line</th><th>stmt</th><th>bran</th><th>cond</th><th>sub</th><th>time</th><th>code</th></tr>
<tr><td class="h">1</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Module of TWiki Enterprise Collaboration Platform, http://TWiki.org/</td></tr>
<tr><td class="h">2</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">3</td><td></td><td></td><td></td><td></td><td></td><td class="s"># Copyright (C) 2000-2007 Peter Thoeny, peter@thoeny.org</td></tr>
<tr><td class="h">4</td><td></td><td></td><td></td><td></td><td></td><td class="s"># and TWiki Contributors. All Rights Reserved. TWiki Contributors</td></tr>
<tr><td class="h">5</td><td></td><td></td><td></td><td></td><td></td><td class="s"># are listed in the AUTHORS file in the root of this distribution.</td></tr>
<tr><td class="h">6</td><td></td><td></td><td></td><td></td><td></td><td class="s"># NOTE: Please extend that file, not this notice.</td></tr>
<tr><td class="h">7</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">8</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is free software; you can redistribute it and/or</td></tr>
<tr><td class="h">9</td><td></td><td></td><td></td><td></td><td></td><td class="s"># modify it under the terms of the GNU General Public License</td></tr>
<tr><td class="h">10</td><td></td><td></td><td></td><td></td><td></td><td class="s"># as published by the Free Software Foundation; either version 2</td></tr>
<tr><td class="h">11</td><td></td><td></td><td></td><td></td><td></td><td class="s"># of the License, or (at your option) any later version. For</td></tr>
<tr><td class="h">12</td><td></td><td></td><td></td><td></td><td></td><td class="s"># more details read LICENSE in the root of this distribution.</td></tr>
<tr><td class="h">13</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">14</td><td></td><td></td><td></td><td></td><td></td><td class="s"># This program is distributed in the hope that it will be useful,</td></tr>
<tr><td class="h">15</td><td></td><td></td><td></td><td></td><td></td><td class="s"># but WITHOUT ANY WARRANTY; without even the implied warranty of</td></tr>
<tr><td class="h">16</td><td></td><td></td><td></td><td></td><td></td><td class="s"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</td></tr>
<tr><td class="h">17</td><td></td><td></td><td></td><td></td><td></td><td class="s">#</td></tr>
<tr><td class="h">18</td><td></td><td></td><td></td><td></td><td></td><td class="s"># As per the GPL, removal of this notice is prohibited.</td></tr>
<tr><td class="h">19</td><td colspan="6"></td></tr><tr><td class="h">20 - 67</td><td colspan="5"></td><td class="s"><pre>=pod

---+ package TWiki::Func

&lt;!-- STARTINCLUDE required for huge TWikiDocumentation topic --&gt;
%STARTINCLUDE%

_Official list of stable TWiki functions for Plugin developers_

This module defines official functions that [[%TWIKIWEB%.TWikiPlugins][Plugins]]
can use to interact with the TWiki engine and content.

Refer to TWiki.EmptyPlugin and lib/TWiki/Plugins/EmptyPlugin.pm for a template Plugin and documentation on how to write a Plugin.

Plugins should *only* use functions published in this module. If you use
functions in other TWiki libraries you might create a security hole and
you will probably need to change your Plugin when you upgrade TWiki.

Deprecated functions will still work in older code, though they should
_not_ be called in new Plugins and should be replaced in older Plugins
as soon as possible.

The version of the TWiki::Func module is defined by the VERSION number of the
TWiki::Plugins module, currently %PLUGINVERSION%. This can be shown
by the =%&lt;nop&gt;PLUGINVERSION%= variable. The &#39;Since&#39; field in the function
documentation refers to the VERSION number and the date that the function
was addded.

__Note:__ Beware! These methods should only ever be called
from the context of a TWiki Plugin. They require a Plugins SESSION context to be
established before they are called, and will not work if simply called from
another TWiki module. For example,
&lt;verbatim&gt;
use TWiki;
print TWiki::Func::getSkin(),&quot;\n&quot;;
&lt;/verbatim&gt;
will fail with =Can&#39;t call method &quot;getSkin&quot; on an undefined value at TWiki/Func.pm line 83=.

If you want to call the methods outside the context of a plugin, you can create a Plugins SESSION object. For example,
the script:
&lt;verbatim&gt;
use TWiki:
$TWiki::Plugins::SESSION = new TWiki();
print TWiki::Func::getSkin(),&quot;\n&quot;;
&lt;/verbatim&gt;
will work happily.

=cut</pre></td></tr>
<tr><td class="h">68</td><td colspan="6"></td></tr><tr><td class="h">69</td><td></td><td></td><td></td><td></td><td></td><td class="s">package TWiki::Func;</td></tr>
<tr><td class="h">70</td><td colspan="6"></td></tr><tr><td class="h">71</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L71">1</a></div></td><td><div>5</div><div>3</div><div>5</div></td><td class="s">use strict;</td></tr>
<tr><td class="h">72</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L72">1</a></div></td><td><div>7</div><div>3</div><div>7</div></td><td class="s">use Error qw( :try );</td></tr>
<tr><td class="h">73</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L73">1</a></div></td><td><div>8</div><div>4</div><div>6</div></td><td class="s">use Assert;</td></tr>
<tr><td class="h">74</td><td colspan="6"></td></tr><tr><td class="h">75</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L75">1</a></div></td><td><div>10</div><div>4</div><div>10</div></td><td class="s">use TWiki::Time;</td></tr>
<tr><td class="h">76</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L76">1</a></div></td><td><div>7</div><div>3</div><div>8</div></td><td class="s">use TWiki::Plugins;</td></tr>
<tr><td class="h">77</td><td><div class="c3">1</div><div class="c3">1</div><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L77">1</a></div></td><td><div>7</div><div>2</div><div>9</div></td><td class="s">use TWiki::Attrs;</td></tr>
<tr><td class="h">78</td><td colspan="6"></td></tr><tr><td class="h">79 - 83</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Environment

=cut</pre></td></tr>
<tr><td class="h">84</td><td colspan="6"></td></tr><tr><td class="h">85 - 95</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getSkin( ) -&gt; $skin

Get the skin path, set by the =SKIN= and =COVER= preferences variables or the =skin= and =cover= CGI parameters

Return: =$skin= Comma-separated list of skins, e.g. =&#39;gnu,tartan&#39;=. Empty string if none.

*Since:* TWiki::Plugins::VERSION 1.000 (29 Jul 2001)

=cut</pre></td></tr>
<tr><td class="h">96</td><td colspan="6"></td></tr><tr><td class="h">97</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getSkin {</td></tr>
<tr><td class="h">98</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L98">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">99</td><td colspan="6"></td></tr><tr><td class="h">100</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;getSkin();</td></tr>
<tr><td class="h">101</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">102</td><td colspan="6"></td></tr><tr><td class="h">103 - 113</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getUrlHost( ) -&gt; $host

Get protocol, domain and optional port of script URL

Return: =$host= URL host, e.g. =&quot;http://example.com:80&quot;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">114</td><td colspan="6"></td></tr><tr><td class="h">115</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getUrlHost {</td></tr>
<tr><td class="h">116</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L116">1</a></div></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">117</td><td colspan="6"></td></tr><tr><td class="h">118</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{urlHost};</td></tr>
<tr><td class="h">119</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">120</td><td colspan="6"></td></tr><tr><td class="h">121 - 135</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getScriptUrl( $web, $topic, $script, ... ) -&gt; $url

Compose fully qualified URL
   * =$web=    - Web name, e.g. =&#39;Main&#39;=
   * =$topic=  - Topic name, e.g. =&#39;WebNotify&#39;=
   * =$script= - Script name, e.g. =&#39;view&#39;=
   * =...= - an arbitrary number of name,value parameter pairs that will be url-encoded and added to the url. The special parameter name &#39;#&#39; is reserved for specifying an anchor. e.g. &lt;tt&gt;getScriptUrl(&#39;x&#39;,&#39;y&#39;,&#39;view&#39;,&#39;#&#39;=&gt;&#39;XXX&#39;,a=&gt;1,b=&gt;2)&lt;/tt&gt; will give &lt;tt&gt;.../view/x/y?a=1&amp;b=2#XXX&lt;/tt&gt;

Return: =$url=       URL, e.g. =&quot;http://example.com:80/cgi-bin/view.pl/Main/WebNotify&quot;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">136</td><td colspan="6"></td></tr><tr><td class="h">137</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getScriptUrl {</td></tr>
<tr><td class="h">138</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L138">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $web = shift;</td></tr>
<tr><td class="h">139</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $topic = shift;</td></tr>
<tr><td class="h">140</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $script = shift;</td></tr>
<tr><td class="h">141</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">142</td><td colspan="6"></td></tr><tr><td class="h">143</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;getScriptUrl( 1, $script, $web, $topic, @_ );</td></tr>
<tr><td class="h">144</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">145</td><td colspan="6"></td></tr><tr><td class="h">146 - 157</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getViewUrl( $web, $topic ) -&gt; $url

Compose fully qualified view URL
   * =$web=   - Web name, e.g. =&#39;Main&#39;=. The current web is taken if empty
   * =$topic= - Topic name, e.g. =&#39;WebNotify&#39;=
Return: =$url=      URL, e.g. =&quot;http://example.com:80/cgi-bin/view.pl/Main/WebNotify&quot;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">158</td><td colspan="6"></td></tr><tr><td class="h">159</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getViewUrl {</td></tr>
<tr><td class="h">160</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L160">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic ) = @_;</td></tr>
<tr><td class="h">161</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">162</td><td colspan="6"></td></tr><tr><td class="h">163</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L163">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$web ||= $TWiki::Plugins::SESSION-&gt;{webName} || $TWiki::cfg{UsersWebName};</td></tr>
<tr><td class="h">164</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;getScriptUrl( 1, &#39;view&#39;, $web, $topic );</td></tr>
<tr><td class="h">165</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">166</td><td colspan="6"></td></tr><tr><td class="h">167 - 195</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getOopsUrl( $web, $topic, $template, $param1, $param2, $param3, $param4 ) -&gt; $url

Compose fully qualified &#39;oops&#39; dialog URL
   * =$web=                  - Web name, e.g. =&#39;Main&#39;=. The current web is taken if empty
   * =$topic=                - Topic name, e.g. =&#39;WebNotify&#39;=
   * =$template=             - Oops template name, e.g. =&#39;oopsmistake&#39;=. The &#39;oops&#39; is optional; &#39;mistake&#39; will translate to &#39;oopsmistake&#39;.
   * =$param1= ... =$param4= - Parameter values for %&lt;nop&gt;PARAM1% ... %&lt;nop&gt;PARAMn% variables in template, optional
Return: =$url=                     URL, e.g. =&quot;http://example.com:80/cgi-bin/oops.pl/ Main/WebNotify?template=oopslocked&amp;amp;param1=joe&quot;=

This might be used like this:
&lt;verbatim&gt;
   my $url = TWiki::Func::getOopsUrl($web, $topic, &#39;oopsmistake&#39;, &#39;I made a boo-boo&#39;);
   TWiki::Func::redirectCgiQuery( undef, $url );
   return 0;
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

Since TWiki::Plugins::VERSION 1.1, the recommended approach is to throw an [[TWikiOopsExceptionDotPm][oops exception]].
&lt;verbatim&gt;
   use Error qw( :try );

   throw TWiki::OopsException($web, $topic, undef, 0, [ &#39;I made a boo-boo&#39; ]);
&lt;/verbatim&gt;
and let TWiki handle the cleanup.

=cut</pre></td></tr>
<tr><td class="h">196</td><td colspan="6"></td></tr><tr><td class="h">197</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getOopsUrl {</td></tr>
<tr><td class="h">198</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L198">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $template, @params ) = @_;</td></tr>
<tr><td class="h">199</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">200</td><td colspan="6"></td></tr><tr><td class="h">201</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $res = $TWiki::Plugins::SESSION-&gt;getOopsUrl( &#39;TeMpLaTe&#39;, web =&gt; $web,</td></tr>
<tr><td class="h">202</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic =&gt; $topic,</td></tr>
<tr><td class="h">203</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params =&gt; \@params );</td></tr>
<tr><td class="h">204</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$res =~ s/oopsTeMpLaTe/$template/g;</td></tr>
<tr><td class="h">205</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $res;</td></tr>
<tr><td class="h">206</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">207</td><td colspan="6"></td></tr><tr><td class="h">208 - 218</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPubUrlPath( ) -&gt; $path

Get pub URL path

Return: =$path= URL path of pub directory, e.g. =&quot;/pub&quot;=

*Since:* TWiki::Plugins::VERSION 1.000 (14 Jul 2001)

=cut</pre></td></tr>
<tr><td class="h">219</td><td colspan="6"></td></tr><tr><td class="h">220</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPubUrlPath {</td></tr>
<tr><td class="h">221</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L221">2</a></div></td><td><div>14</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{PubUrlPath};</td></tr>
<tr><td class="h">222</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">223</td><td colspan="6"></td></tr><tr><td class="h">224 - 234</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getCgiQuery( ) -&gt; $query

Get CGI query object. Important: Plugins cannot assume that scripts run under CGI, Plugins must always test if the CGI query object is set

Return: =$query= CGI query object; or 0 if script is called as a shell script

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">235</td><td colspan="6"></td></tr><tr><td class="h">236</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getCgiQuery {</td></tr>
<tr><td class="h">237</td><td><div class="c3">38</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L237">38</a></div></td><td><div>105</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">238</td><td><div class="c3">38</div></td><td></td><td></td><td></td><td><div>194</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{cgiQuery};</td></tr>
<tr><td class="h">239</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">240</td><td colspan="6"></td></tr><tr><td class="h">241 - 251</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getSessionValue( $key ) -&gt; $value

Get a session value from the client session module
   * =$key= - Session key
Return: =$value=  Value associated with key; empty string if not set

*Since:* TWiki::Plugins::VERSION 1.000 (27 Feb 200)

=cut</pre></td></tr>
<tr><td class="h">252</td><td colspan="6"></td></tr><tr><td class="h">253</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getSessionValue {</td></tr>
<tr><td class="h">254</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $key ) = @_;</td></tr>
<tr><td class="h">255</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L255">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">256</td><td colspan="6"></td></tr><tr><td class="h">257</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{loginManager}-&gt;getSessionValue( @_ );</td></tr>
<tr><td class="h">258</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">259</td><td colspan="6"></td></tr><tr><td class="h">260</td><td colspan="6"></td></tr><tr><td class="h">261 - 272</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ setSessionValue( $key, $value ) -&gt; $boolean

Set a session value.
   * =$key=   - Session key
   * =$value= - Value associated with key
Return: true if function succeeded

*Since:* TWiki::Plugins::VERSION 1.000 (17 Aug 2001)

=cut</pre></td></tr>
<tr><td class="h">273</td><td colspan="6"></td></tr><tr><td class="h">274</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setSessionValue {</td></tr>
<tr><td class="h">275</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $key, $value ) = @_;</td></tr>
<tr><td class="h">276</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L276">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">277</td><td colspan="6"></td></tr><tr><td class="h">278</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{loginManager}-&gt;setSessionValue( @_ );</td></tr>
<tr><td class="h">279</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">280</td><td colspan="6"></td></tr><tr><td class="h">281 - 292</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ clearSessionValue( $key ) -&gt; $boolean

Clear a session value that was set using =setSessionValue=.
   * =$key= - name of value stored in session to be cleared. Note that
   you *cannot* clear =AUTHUSER=.
Return: true if the session value was cleared

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">293</td><td colspan="6"></td></tr><tr><td class="h">294</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub clearSessionValue {</td></tr>
<tr><td class="h">295</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L295">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">296</td><td colspan="6"></td></tr><tr><td class="h">297</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{loginManager}-&gt;clearSessionValue( @_ );</td></tr>
<tr><td class="h">298</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">299</td><td colspan="6"></td></tr><tr><td class="h">300 - 347</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getContext() -&gt; \%hash

Get a hash of context identifiers representing the currently active
context.

The context is a set of identifiers that are set
during specific phases of TWiki processing. For example, each of
the standard scripts in the &#39;bin&#39; directory each has a context
identifier - the view script has &#39;view&#39;, the edit script has &#39;edit&#39;
etc. So you can easily tell what &#39;type&#39; of script your Plugin is
being called within. The core context identifiers are listed
in the %TWIKIWEB%.TWikiTemplates topic. Please be careful not to
overwrite any of these identifiers!

Context identifiers can be used to communicate between Plugins, and between
Plugins and templates. For example, in FirstPlugin.pm, you might write:
&lt;verbatim&gt;
sub initPlugin {
   TWiki::Func::getContext()-&gt;{&#39;MyID&#39;} = 1;
   ...
&lt;/verbatim&gt;
This can be used in !SecondPlugin.pm like this:
&lt;verbatim&gt;
sub initPlugin {
   if( TWiki::Func::getContext()-&gt;{&#39;MyID&#39;} ) {
      ...
   }
   ...
&lt;/verbatim&gt;
or in a template, like this:
&lt;verbatim&gt;
%TMPL:DEF{&quot;ON&quot;}% Not off %TMPL:END%
%TMPL:DEF{&quot;OFF&quot;}% Not on %TMPL:END%
%TMPL:P{context=&quot;MyID&quot; then=&quot;ON&quot; else=&quot;OFF&quot;}%
&lt;/verbatim&gt;
or in a topic:
&lt;verbatim&gt;
%IF{&quot;context MyID&quot; then=&quot;MyID is ON&quot; else=&quot;MyID is OFF&quot;}%
&lt;/verbatim&gt;
__Note__: *all* plugins have an *automatically generated* context identifier
if they are installed and initialised. For example, if the FirstPlugin is
working, the context ID &#39;FirstPlugin&#39; will be set.

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">348</td><td colspan="6"></td></tr><tr><td class="h">349</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getContext {</td></tr>
<tr><td class="h">350</td><td><div class="c3">16</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L350">16</a></div></td><td><div>41</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">351</td><td><div class="c3">16</div></td><td></td><td></td><td></td><td><div>143</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{context};</td></tr>
<tr><td class="h">352</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">353</td><td colspan="6"></td></tr><tr><td class="h">354 - 358</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Preferences

=cut</pre></td></tr>
<tr><td class="h">359</td><td colspan="6"></td></tr><tr><td class="h">360 - 383</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPreferencesValue( $key, $web ) -&gt; $value

Get a preferences value from TWiki or from a Plugin
   * =$key= - Preferences key
   * =$web= - Name of web, optional. Current web if not specified; does not apply to settings of Plugin topics
Return: =$value=  Preferences value; empty string if not set

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

   * Example for Plugin setting:
      * MyPlugin topic has: =* Set COLOR = red=
      * Use =&quot;MYPLUGIN_COLOR&quot;= for =$key=
      * =my $color = TWiki::Func::getPreferencesValue( &quot;MYPLUGIN_COLOR&quot; );=

   * Example for preferences setting:
      * WebPreferences topic has: =* Set WEBBGCOLOR = #FFFFC0=
      * =my $webColor = TWiki::Func::getPreferencesValue( &#39;WEBBGCOLOR&#39;, &#39;Sandbox&#39; );=

*NOTE:* As of TWiki4.1, if =$NO_PREFS_IN_TOPIC= is enabled in the plugin, then
preferences set in the plugin topic will be ignored.

=cut</pre></td></tr>
<tr><td class="h">384</td><td colspan="6"></td></tr><tr><td class="h">385</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPreferencesValue {</td></tr>
<tr><td class="h">386</td><td><div class="c3">35</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L386">35</a></div></td><td><div>124</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $key, $web ) = @_;</td></tr>
<tr><td class="h">387</td><td><div class="c3">35</div></td><td></td><td></td><td></td><td><div>77</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">388</td><td><div class="c3">35</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L388">50</a></div></td><td></td><td></td><td><div>135</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $web ) {</td></tr>
<tr><td class="h">389</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{prefs}-&gt;getWebPreferencesValue(</td></tr>
<tr><td class="h">390</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$key, $web );</td></tr>
<tr><td class="h">391</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">392</td><td><div class="c3">35</div></td><td></td><td></td><td></td><td><div>182</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{prefs}-&gt;getPreferencesValue( $key );</td></tr>
<tr><td class="h">393</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">394</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">395</td><td colspan="6"></td></tr><tr><td class="h">396 - 411</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPluginPreferencesValue( $key ) -&gt; $value

Get a preferences value from your Plugin
   * =$key= - Plugin Preferences key w/o PLUGINNAME_ prefix.
Return: =$value=  Preferences value; empty string if not set

__Note__: This function will will *only* work when called from the Plugin.pm file itself. it *will not work* if called from a sub-package (e.g. TWiki::Plugins::MyPlugin::MyModule)

*Since:* TWiki::Plugins::VERSION 1.021 (27 Mar 2004)

*NOTE:* As of TWiki4.1, if =$NO_PREFS_IN_TOPIC= is enabled in the plugin, then
preferences set in the plugin topic will be ignored.

=cut</pre></td></tr>
<tr><td class="h">412</td><td colspan="6"></td></tr><tr><td class="h">413</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPluginPreferencesValue {</td></tr>
<tr><td class="h">414</td><td><div class="c3">4</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L414">4</a></div></td><td><div>13</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $key ) = @_;</td></tr>
<tr><td class="h">415</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>10</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">416</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>11</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $package = caller;</td></tr>
<tr><td class="h">417</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>17</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$package =~ s/.*:://; # strip off TWiki::Plugins:: prefix</td></tr>
<tr><td class="h">418</td><td><div class="c3">4</div></td><td></td><td></td><td></td><td><div>24</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{prefs}-&gt;getPreferencesValue( &quot;\U$package\E_$key&quot; );</td></tr>
<tr><td class="h">419</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">420</td><td colspan="6"></td></tr><tr><td class="h">421 - 440</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPreferencesFlag( $key, $web ) -&gt; $value

Get a preferences flag from TWiki or from a Plugin
   * =$key= - Preferences key
   * =$web= - Name of web, optional. Current web if not specified; does not apply to settings of Plugin topics
Return: =$value=  Preferences flag =&#39;1&#39;= (if set), or =&quot;0&quot;= (for preferences values =&quot;off&quot;=, =&quot;no&quot;= and =&quot;0&quot;=)

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

   * Example for Plugin setting:
      * MyPlugin topic has: =* Set SHOWHELP = off=
      * Use =&quot;MYPLUGIN_SHOWHELP&quot;= for =$key=
      * =my $showHelp = TWiki::Func::getPreferencesFlag( &quot;MYPLUGIN_SHOWHELP&quot; );=

*NOTE:* As of TWiki4.1, if =$NO_PREFS_IN_TOPIC= is enabled in the plugin, then
preferences set in the plugin topic will be ignored.

=cut</pre></td></tr>
<tr><td class="h">441</td><td colspan="6"></td></tr><tr><td class="h">442</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPreferencesFlag {</td></tr>
<tr><td class="h">443</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $key, $web ) = @_;</td></tr>
<tr><td class="h">444</td><td><div class="c3">5</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L444">5</a></div></td><td><div>21</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $t = getPreferencesValue( @_ );</td></tr>
<tr><td class="h">445</td><td><div class="c3">5</div></td><td></td><td></td><td></td><td><div>20</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return TWiki::isTrue( $t );</td></tr>
<tr><td class="h">446</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">447</td><td colspan="6"></td></tr><tr><td class="h">448 - 463</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPluginPreferencesFlag( $key ) -&gt; $boolean

Get a preferences flag from your Plugin
   * =$key= - Plugin Preferences key w/o PLUGINNAME_ prefix.
Return: false for preferences values =&quot;off&quot;=, =&quot;no&quot;= and =&quot;0&quot;=, or values not set at all. True otherwise.

__Note__: This function will will *only* work when called from the Plugin.pm file itself. it *will not work* if called from a sub-package (e.g. TWiki::Plugins::MyPlugin::MyModule)

*Since:* TWiki::Plugins::VERSION 1.021 (27 Mar 2004)

*NOTE:* As of TWiki4.1, if =$NO_PREFS_IN_TOPIC= is enabled in the plugin, then
preferences set in the plugin topic will be ignored.

=cut</pre></td></tr>
<tr><td class="h">464</td><td colspan="6"></td></tr><tr><td class="h">465</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPluginPreferencesFlag {</td></tr>
<tr><td class="h">466</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L466">1</a></div></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $key ) = @_;</td></tr>
<tr><td class="h">467</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>3</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $package = caller;</td></tr>
<tr><td class="h">468</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$package =~ s/.*:://; # strip off TWiki::Plugins:: prefix</td></tr>
<tr><td class="h">469</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return getPreferencesFlag( &quot;\U$package\E_$key&quot; );</td></tr>
<tr><td class="h">470</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">471</td><td colspan="6"></td></tr><tr><td class="h">472 - 482</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getWikiToolName( ) -&gt; $name

Get toolname as defined in TWiki.cfg

Return: =$name= Name of tool, e.g. =&#39;TWiki&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (27 Feb 2001)

=cut</pre></td></tr>
<tr><td class="h">483</td><td colspan="6"></td></tr><tr><td class="h">484</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getWikiToolName {</td></tr>
<tr><td class="h">485</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L485">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{WikiToolName};</td></tr>
<tr><td class="h">486</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">487</td><td colspan="6"></td></tr><tr><td class="h">488 - 498</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getMainWebname( ) -&gt; $name

Get name of Main web as defined in TWiki.cfg

Return: =$name= Name, e.g. =&#39;Main&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (27 Feb 2001)

=cut</pre></td></tr>
<tr><td class="h">499</td><td colspan="6"></td></tr><tr><td class="h">500</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getMainWebname {</td></tr>
<tr><td class="h">501</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L501">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{UsersWebName};</td></tr>
<tr><td class="h">502</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">503</td><td colspan="6"></td></tr><tr><td class="h">504 - 514</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getTwikiWebname( ) -&gt; $name

Get name of TWiki documentation web as defined in TWiki.cfg

Return: =$name= Name, e.g. =&#39;TWiki&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (27 Feb 2001)

=cut</pre></td></tr>
<tr><td class="h">515</td><td colspan="6"></td></tr><tr><td class="h">516</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getTwikiWebname {</td></tr>
<tr><td class="h">517</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L517">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{SystemWebName};</td></tr>
<tr><td class="h">518</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">519</td><td colspan="6"></td></tr><tr><td class="h">520 - 532</td><td colspan="5"></td><td class="s"><pre>=pod

---++ User Handling and Access Control

---+++ getDefaultUserName( ) -&gt; $loginName

Get default user name as defined in the configuration as =DefaultUserLogin=

Return: =$loginName= Default user name, e.g. =&#39;guest&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">533</td><td colspan="6"></td></tr><tr><td class="h">534</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getDefaultUserName {</td></tr>
<tr><td class="h">535</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L535">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{DefaultUserLogin};</td></tr>
<tr><td class="h">536</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">537</td><td colspan="6"></td></tr><tr><td class="h">538 - 548</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getWikiName( ) -&gt; $wikiName

Get Wiki name of logged in user

Return: =$wikiName= Wiki Name, e.g. =&#39;JohnDoe&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">549</td><td colspan="6"></td></tr><tr><td class="h">550</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getWikiName {</td></tr>
<tr><td class="h">551</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L551">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">552</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{user}-&gt;wikiName();</td></tr>
<tr><td class="h">553</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">554</td><td colspan="6"></td></tr><tr><td class="h">555 - 565</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getWikiUserName( ) -&gt; $wikiName

Get Wiki name of logged in user with web prefix

Return: =$wikiName= Wiki Name, e.g. =&quot;Main.JohnDoe&quot;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">566</td><td colspan="6"></td></tr><tr><td class="h">567</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getWikiUserName {</td></tr>
<tr><td class="h">568</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L568">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">569</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{user}-&gt;webDotWikiName();</td></tr>
<tr><td class="h">570</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">571</td><td colspan="6"></td></tr><tr><td class="h">572 - 582</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ wikiToUserName( $wikiName ) -&gt; $loginName

Translate a Wiki name to a login name based on [[%MAINWEB%.TWikiUsers]] topic
   * =$wikiName= - Wiki name, e.g. =&#39;Main.JohnDoe&#39;= or =&#39;JohnDoe&#39;=
Return: =$loginName=   Login name of user, e.g. =&#39;jdoe&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">583</td><td colspan="6"></td></tr><tr><td class="h">584</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub wikiToUserName {</td></tr>
<tr><td class="h">585</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L585">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $wiki ) = @_;</td></tr>
<tr><td class="h">586</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">587</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L587">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39; unless $wiki;</td></tr>
<tr><td class="h">588</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user = $TWiki::Plugins::SESSION-&gt;{users}-&gt;findUser( $wiki, undef, 1 );</td></tr>
<tr><td class="h">589</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L589">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $wiki unless $user;</td></tr>
<tr><td class="h">590</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $user-&gt;login();</td></tr>
<tr><td class="h">591</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">592</td><td colspan="6"></td></tr><tr><td class="h">593 - 604</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ userToWikiName( $loginName, $dontAddWeb ) -&gt; $wikiName

Translate a login name to a Wiki name based on [[%MAINWEB%.TWikiUsers]] topic
   * =$loginName=  - Login name, e.g. =&#39;jdoe&#39;=
   * =$dontAddWeb= - Do not add web prefix if =&quot;1&quot;=
Return: =$wikiName=      Wiki name of user, e.g. =&#39;Main.JohnDoe&#39;= or =&#39;JohnDoe&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">605</td><td colspan="6"></td></tr><tr><td class="h">606</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub userToWikiName {</td></tr>
<tr><td class="h">607</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L607">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $login, $dontAddWeb ) = @_;</td></tr>
<tr><td class="h">608</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L608">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39; unless $login;</td></tr>
<tr><td class="h">609</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">610</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user = $TWiki::Plugins::SESSION-&gt;{users}-&gt;findUser( $login, undef, 1 );</td></tr>
<tr><td class="h">611</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L611">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39; unless $user;</td></tr>
<tr><td class="h">612</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L612">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $user-&gt;wikiName() if $dontAddWeb;</td></tr>
<tr><td class="h">613</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $user-&gt;webDotWikiName();</td></tr>
<tr><td class="h">614</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">615</td><td colspan="6"></td></tr><tr><td class="h">616 - 624</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ isGuest( ) -&gt; $boolean

Test if logged in user is a guest (TWikiGuest)

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">625</td><td colspan="6"></td></tr><tr><td class="h">626</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub isGuest {</td></tr>
<tr><td class="h">627</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L627">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">628</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{user}-&gt;isDefaultUser();</td></tr>
<tr><td class="h">629</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">630</td><td colspan="6"></td></tr><tr><td class="h">631 - 640</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ permissionsSet( $web ) -&gt; $boolean

Test if any access restrictions are set for this web, ignoring settings on individual pages
   * =$web= - Web name, required, e.g. =&#39;Sandbox&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (27 Feb 2001)

=cut</pre></td></tr>
<tr><td class="h">641</td><td colspan="6"></td></tr><tr><td class="h">642</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub permissionsSet {</td></tr>
<tr><td class="h">643</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $web ) = @_;</td></tr>
<tr><td class="h">644</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L644">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">645</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{security}-&gt;permissionsSet( @_ );</td></tr>
<tr><td class="h">646</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">647</td><td colspan="6"></td></tr><tr><td class="h">648 - 683</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ checkAccessPermission( $type, $wikiName, $text, $topic, $web, $meta ) -&gt; $boolean

Check access permission for a topic based on the
[[%TWIKIWEB%.TWikiAccessControl]] rules
   * =$type=     - Access type, required, e.g. =&#39;VIEW&#39;=, =&#39;CHANGE&#39;=.
   * =$wikiName= - WikiName of remote user, required, e.g. =&quot;PeterThoeny&quot;=.
     If =$wikiName= is &#39;&#39;, 0 or =undef= then access is *always permitted*.
   * =$text=     - Topic text, optional. If &#39;perl false&#39; (undef, 0 or &#39;&#39;),
     topic =$web.$topic= is consulted. =$text= may optionally contain embedded
     =%META:PREFERENCE= tags. Provide this parameter if:
      1 You are setting different access controls in the text to those defined
      in the stored topic,
      1 You already have the topic text in hand, and want to help TWiki avoid
        having to read it again,
      1 You are providing a =$meta= parameter.
   * =$topic=    - Topic name, required, e.g. =&#39;PrivateStuff&#39;=
   * =$web=      - Web name, required, e.g. =&#39;Sandbox&#39;=
   * =$meta=     - Meta-data object, as returned by =readTopic=. Optional.
     If =undef=, but =$text= is defined, then access controls will be parsed
     from =$text=. If defined, then metadata embedded in =$text= will be
     ignored. This parameter is always ignored if =$text= is undefined.
     Settings in =$meta= override =Set= settings in $text.
A perl true result indicates that access is permitted.

*Note* the wierd parameter order is due to compatibility constraints with
earlier TWiki releases.

*Tip* if you want, you can use this method to check your own access control types. For example, if you:
   * Set ALLOWTOPICSPIN = IncyWincy
in =ThatWeb.ThisTopic=, then a call to =checkAccessPermissions(&#39;SPIN&#39;, &#39;IncyWincy&#39;, undef, &#39;ThisTopic&#39;, &#39;ThatWeb&#39;, undef)= will return =true=.

*Since:* TWiki::Plugins::VERSION 1.000 (27 Feb 2001)

=cut</pre></td></tr>
<tr><td class="h">684</td><td colspan="6"></td></tr><tr><td class="h">685</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub checkAccessPermission {</td></tr>
<tr><td class="h">686</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L686">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $type, $user, $text, $topic, $web, $meta ) = @_;</td></tr>
<tr><td class="h">687</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L687">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return 1 unless ( $user );</td></tr>
<tr><td class="h">688</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">689</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L689">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$text = undef unless $text;</td></tr>
<tr><td class="h">690</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$user = $TWiki::Plugins::SESSION-&gt;{users}-&gt;findUser( $user );</td></tr>
<tr><td class="h">691</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{security}-&gt;checkAccessPermission(</td></tr>
<tr><td class="h">692</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$type, $user, $text, $meta, $topic, $web );</td></tr>
<tr><td class="h">693</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">694</td><td colspan="6"></td></tr><tr><td class="h">695 - 699</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Webs, Topics and Attachments

=cut</pre></td></tr>
<tr><td class="h">700</td><td colspan="6"></td></tr><tr><td class="h">701 - 722</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getListOfWebs( $filter ) -&gt; @webs

   * =$filter= - spec of web types to recover
Gets a list of webs, filtered according to the spec in the $filter,
which may include one of:
   1 &#39;user&#39; (for only user webs)
   2 &#39;template&#39; (for only template webs i.e. those starting with &quot;_&quot;)
=$filter= may also contain the word &#39;public&#39; which will further filter
out webs that have NOSEARCHALL set on them.
&#39;allowed&#39; filters out webs the current user can&#39;t read.

For example, the deprecated getPublicWebList function can be duplicated
as follows:
&lt;verbatim&gt;
   my @webs = TWiki::Func::getListOfWebs( &quot;user,public&quot; );
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">723</td><td colspan="6"></td></tr><tr><td class="h">724</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getListOfWebs {</td></tr>
<tr><td class="h">725</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L725">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $filter = shift;</td></tr>
<tr><td class="h">726</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">727</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;getListOfWebs($filter);</td></tr>
<tr><td class="h">728</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">729</td><td colspan="6"></td></tr><tr><td class="h">730 - 739</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ webExists( $web ) -&gt; $boolean

Test if web exists
   * =$web= - Web name, required, e.g. =&#39;Sandbox&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (14 Jul 2001)

=cut</pre></td></tr>
<tr><td class="h">740</td><td colspan="6"></td></tr><tr><td class="h">741</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub webExists {</td></tr>
<tr><td class="h">742</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $web ) = @_;</td></tr>
<tr><td class="h">743</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L743">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">744</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;webExists( @_ );</td></tr>
<tr><td class="h">745</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">746</td><td colspan="6"></td></tr><tr><td class="h">747 - 775</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ createWeb( $newWeb, $baseWeb, $opts )

   * =$newWeb= is the name of the new web.
   * =$baseWeb= is the name of an existing web (a template web). If the base web is a system web, all topics in it will be copied into the new web. If it is a normal web, only topics starting with &#39;Web&#39; will be copied. If no base web is specified, an empty web (with no topics) will be created. If it is specified but does not exist, an error will be thrown.
   * =$opts= is a ref to a hash that contains settings to be modified in
the web preferences topic in the new web.

&lt;verbatim&gt;
use Error qw( :try );
use TWiki::AccessControlException;

try {
    TWiki::Func::createWeb( &quot;Newweb&quot; );
} catch Error::Simple with {
    my $e = shift;
    # see documentation on Error::Simple
} catch TWiki::AccessControlException with {
    my $e = shift;
    # see documentation on TWiki::AccessControlException
} otherwise {
    ...
};
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">776</td><td colspan="6"></td></tr><tr><td class="h">777</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub createWeb {</td></tr>
<tr><td class="h">778</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L778">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">779</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{store}-&gt;createWeb(</td></tr>
<tr><td class="h">780</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{user}, @_ );</td></tr>
<tr><td class="h">781</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">782</td><td colspan="6"></td></tr><tr><td class="h">783 - 813</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ moveWeb( $oldName, $newName )

Move (rename) a web.

&lt;verbatim&gt;
use Error qw( :try );
use TWiki::AccessControlException;

try {
    TWiki::Func::moveWeb( &quot;Oldweb&quot;, &quot;Newweb&quot; );
} catch Error::Simple with {
    my $e = shift;
    # see documentation on Error::Simple
} catch TWiki::AccessControlException with {
    my $e = shift;
    # see documentation on TWiki::AccessControlException
} otherwise {
    ...
};
&lt;/verbatim&gt;

To delete a web, move it to a subweb of =Trash=
&lt;verbatim&gt;
TWiki::Func::moveWeb( &quot;Deadweb&quot;, &quot;Trash.Deadweb&quot; );
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">814</td><td colspan="6"></td></tr><tr><td class="h">815</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub moveWeb {</td></tr>
<tr><td class="h">816</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L816">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">817</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;moveWeb(</td></tr>
<tr><td class="h">818</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;@_, $TWiki::Plugins::SESSION-&gt;{user});</td></tr>
<tr><td class="h">819</td><td colspan="6"></td></tr><tr><td class="h">820</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">821</td><td colspan="6"></td></tr><tr><td class="h">822 - 832</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getTopicList( $web ) -&gt; @topics

Get list of all topics in a web
   * =$web= - Web name, required, e.g. =&#39;Sandbox&#39;=
Return: =@topics= Topic list, e.g. =( &#39;WebChanges&#39;,  &#39;WebHome&#39;, &#39;WebIndex&#39;, &#39;WebNotify&#39; )=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">833</td><td colspan="6"></td></tr><tr><td class="h">834</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getTopicList {</td></tr>
<tr><td class="h">835</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $web ) = @_;</td></tr>
<tr><td class="h">836</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L836">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">837</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;getTopicNames ( @_ );</td></tr>
<tr><td class="h">838</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">839</td><td colspan="6"></td></tr><tr><td class="h">840 - 851</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ topicExists( $web, $topic ) -&gt; $boolean

Test if topic exists
   * =$web=   - Web name, optional, e.g. =&#39;Main&#39;=.
   * =$topic= - Topic name, required, e.g. =&#39;TokyoOffice&#39;=, or =&quot;Main.TokyoOffice&quot;=
$web and $topic are parsed as described in the documentation for =normalizeWebTopicName=.

*Since:* TWiki::Plugins::VERSION 1.000 (14 Jul 2001)

=cut</pre></td></tr>
<tr><td class="h">852</td><td colspan="6"></td></tr><tr><td class="h">853</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub topicExists {</td></tr>
<tr><td class="h">854</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L854">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic ) = $TWiki::Plugins::SESSION-&gt;normalizeWebTopicName( @_ );</td></tr>
<tr><td class="h">855</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">856</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;topicExists( $web, $topic );</td></tr>
<tr><td class="h">857</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">858</td><td colspan="6"></td></tr><tr><td class="h">859 - 871</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ checkTopicEditLock( $web, $topic, $script ) -&gt; ( $oopsUrl, $loginName, $unlockTime )

Check if a lease has been taken by some other user.
   * =$web= Web name, e.g. =&quot;Main&quot;=, or empty
   * =$topic= Topic name, e.g. =&quot;MyTopic&quot;=, or =&quot;Main.MyTopic&quot;=
Return: =( $oopsUrl, $loginName, $unlockTime )= - The =$oopsUrl= for calling redirectCgiQuery(), user&#39;s =$loginName=, and estimated =$unlockTime= in minutes, or ( &#39;&#39;, &#39;&#39;, 0 ) if no lease exists.
   * =$script= The script to invoke when continuing with the edit

*Since:* TWiki::Plugins::VERSION 1.010 (31 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">872</td><td colspan="6"></td></tr><tr><td class="h">873</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub checkTopicEditLock {</td></tr>
<tr><td class="h">874</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L874">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $script ) = @_;</td></tr>
<tr><td class="h">875</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">876</td><td colspan="6"></td></tr><tr><td class="h">877</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;( $web, $topic ) = normalizeWebTopicName( $web, $topic );</td></tr>
<tr><td class="h">878</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L878">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$script ||= &#39;edit&#39;;</td></tr>
<tr><td class="h">879</td><td colspan="6"></td></tr><tr><td class="h">880</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $lease = $TWiki::Plugins::SESSION-&gt;{store}-&gt;getLease( $web, $topic );</td></tr>
<tr><td class="h">881</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L881">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $lease ) {</td></tr>
<tr><td class="h">882</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $remain = $lease-&gt;{expires} - time();</td></tr>
<tr><td class="h">883</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $session = $TWiki::Plugins::SESSION;</td></tr>
<tr><td class="h">884</td><td colspan="6"></td></tr><tr><td class="h">885</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L885">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if( $remain &gt; 0 ) {</td></tr>
<tr><td class="h">886</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $who = $lease-&gt;{user}-&gt;login();</td></tr>
<tr><td class="h">887</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $wn = $lease-&gt;{user}-&gt;webDotWikiName();</td></tr>
<tr><td class="h">888</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $past = TWiki::Time::formatDelta(time()-$lease-&gt;{taken},</td></tr>
<tr><td class="h">889</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{i18n}</td></tr>
<tr><td class="h">890</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">891</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $future = TWiki::Time::formatDelta($lease-&gt;{expires}-time(),</td></tr>
<tr><td class="h">892</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{i18n}</td></tr>
<tr><td class="h">893</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">894</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return( $session-&gt;getOopsUrl( &#39;leaseconflict&#39;,</td></tr>
<tr><td class="h">895</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def =&gt; &#39;lease_active&#39;,</td></tr>
<tr><td class="h">896</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;keep =&gt; 1,   # Need to keep parameters across redirect</td></tr>
<tr><td class="h">897</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web =&gt; $web,</td></tr>
<tr><td class="h">898</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic =&gt; $topic,</td></tr>
<tr><td class="h">899</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params =&gt; [ $wn, $past, $future, $script ] ),</td></tr>
<tr><td class="h">900</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$who, $remain / 60 );</td></tr>
<tr><td class="h">901</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">902</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">903</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return (&#39;&#39;, &#39;&#39;, 0);</td></tr>
<tr><td class="h">904</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">905</td><td colspan="6"></td></tr><tr><td class="h">906 - 924</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ setTopicEditLock( $web, $topic, $lock )

   * =$web= Web name, e.g. =&quot;Main&quot;=, or empty
   * =$topic= Topic name, e.g. =&quot;MyTopic&quot;=, or =&quot;Main.MyTopic&quot;=
   * =$lock= 1 to lease the topic, 0 to clear the lease=

Takes out a &quot;lease&quot; on the topic. The lease doesn&#39;t prevent
anyone from editing and changing the topic, but it does redirect them
to a warning screen, so this provides some protection. The =edit= script
always takes out a lease.

It is *impossible* to fully lock a topic. Concurrent changes will be
merged.

*Since:* TWiki::Plugins::VERSION 1.010 (31 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">925</td><td colspan="6"></td></tr><tr><td class="h">926</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub setTopicEditLock {</td></tr>
<tr><td class="h">927</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L927">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $lock ) = @_;</td></tr>
<tr><td class="h">928</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">929</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $session = $TWiki::Plugins::SESSION;</td></tr>
<tr><td class="h">930</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $store = $session-&gt;{store};</td></tr>
<tr><td class="h">931</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L931">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;if( $lock ) {</td></tr>
<tr><td class="h">932</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$store-&gt;setLease( $web, $topic, $session-&gt;{user},</td></tr>
<tr><td class="h">933</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::cfg{LeaseLength} );</td></tr>
<tr><td class="h">934</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">935</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$store-&gt;clearLease( $web, $topic );</td></tr>
<tr><td class="h">936</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">937</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39;;</td></tr>
<tr><td class="h">938</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">939</td><td colspan="6"></td></tr><tr><td class="h">940 - 967</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ saveTopic( $web, $topic, $meta, $text, $options ) -&gt; $error

   * =$web= - web for the topic
   * =$topic= - topic name
   * =$meta= - reference to TWiki::Meta object
   * =$text= - text of the topic (without embedded meta-data!!!
   * =\%options= - ref to hash of save options
     =\%options= may include:
     | =dontlog= | don&#39;t log this change in twiki log |
     | =comment= | comment for save |
     | =minor= | True if this is a minor change, and is not to be notified |
Return: error message or undef.

*Since:* TWiki::Plugins::VERSION 1.000 (29 Jul 2001)

For example,
&lt;verbatim&gt;
my( $meta, $text ) = TWiki::Func::readTopic( $web, $topic )
$text =~ s/APPLE/ORANGE/g;
TWiki::Func::saveTopic( $web, $topic, $meta, $text, { comment =&gt; &#39;refruited&#39; } );
&lt;/verbatim&gt;

__Note:__ Plugins handlers ( e.g. =beforeSaveHandler= ) will be called as
appropriate.

=cut</pre></td></tr>
<tr><td class="h">968</td><td colspan="6"></td></tr><tr><td class="h">969</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub saveTopic {</td></tr>
<tr><td class="h">970</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L970">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $meta, $text, $options ) = @_;</td></tr>
<tr><td class="h">971</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">972</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($meta) if DEBUG;</td></tr>
<tr><td class="h">973</td><td colspan="6"></td></tr><tr><td class="h">974</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;saveTopic</td></tr>
<tr><td class="h">975</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( $TWiki::Plugins::SESSION-&gt;{user}, $web, $topic, $text, $meta,</td></tr>
<tr><td class="h">976</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$options );</td></tr>
<tr><td class="h">977</td><td colspan="6"></td></tr><tr><td class="h">978</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">979</td><td colspan="6"></td></tr><tr><td class="h">980 - 1011</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ saveTopicText( $web, $topic, $text, $ignorePermissions, $dontNotify ) -&gt; $oopsUrl

Save topic text, typically obtained by readTopicText(). Topic data usually includes meta data; the file attachment meta data is replaced by the meta data from the topic file if it exists.
   * =$web=                - Web name, e.g. =&#39;Main&#39;=, or empty
   * =$topic=              - Topic name, e.g. =&#39;MyTopic&#39;=, or =&quot;Main.MyTopic&quot;=
   * =$text=               - Topic text to save, assumed to include meta data
   * =$ignorePermissions=  - Set to =&quot;1&quot;= if checkAccessPermission() is already performed and OK
   * =$dontNotify=         - Set to =&quot;1&quot;= if not to notify users of the change
Return: =$oopsUrl=               Empty string if OK; the =$oopsUrl= for calling redirectCgiQuery() in case of error

This method is a lot less efficient and much more dangerous than =saveTopic=.

*Since:* TWiki::Plugins::VERSION 1.010 (31 Dec 2002)

&lt;verbatim&gt;
my $text = TWiki::Func::readTopicText( $web, $topic );

# check for oops URL in case of error:
if( $text =~ /^http.*?\/oops/ ) {
    TWiki::Func::redirectCgiQuery( $query, $text );
    return;
}
# do topic text manipulation like:
$text =~ s/old/new/g;
# do meta data manipulation like:
$text =~ s/(META\:FIELD.*?name\=\&quot;TopicClassification\&quot;.*?value\=\&quot;)[^\&quot;]*/$1BugResolved/;
$oopsUrl = TWiki::Func::saveTopicText( $web, $topic, $text ); # save topic text
&lt;/verbatim&gt;

=cut</pre></td></tr>
<tr><td class="h">1012</td><td colspan="6"></td></tr><tr><td class="h">1013</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub saveTopicText {</td></tr>
<tr><td class="h">1014</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1014">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $text, $ignorePermissions, $dontNotify ) = @_;</td></tr>
<tr><td class="h">1015</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1016</td><td colspan="6"></td></tr><tr><td class="h">1017</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $session = $TWiki::Plugins::SESSION;</td></tr>
<tr><td class="h">1018</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $mirrorSite, $mirrorViewURL ) = $session-&gt;readOnlyMirrorWeb( $web );</td></tr>
<tr><td class="h">1019</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1019">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $session-&gt;getOopsUrl</td></tr>
<tr><td class="h">1020</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( &#39;mirror&#39;, web =&gt; $web, topic =&gt; $topic,</td></tr>
<tr><td class="h">1021</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params =&gt; [ $mirrorSite, $mirrorViewURL ] ) if( $mirrorSite );</td></tr>
<tr><td class="h">1022</td><td colspan="6"></td></tr><tr><td class="h">1023</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# check access permission</td></tr>
<tr><td class="h">1024</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1024">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1024">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless( $ignorePermissions ||</td></tr>
<tr><td class="h">1025</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;{security}-&gt;checkAccessPermission(</td></tr>
<tr><td class="h">1026</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&#39;change&#39;, $session-&gt;{user}, undef, undef,</td></tr>
<tr><td class="h">1027</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$topic, $web )</td></tr>
<tr><td class="h">1028</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;) {</td></tr>
<tr><td class="h">1029</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my @plugin = caller();</td></tr>
<tr><td class="h">1030</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $session-&gt;getOopsUrl( &#39;accessdenied&#39;,</td></tr>
<tr><td class="h">1031</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def =&gt; &#39;topic_access&#39;,</td></tr>
<tr><td class="h">1032</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web =&gt; $web,</td></tr>
<tr><td class="h">1033</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic =&gt; $topic,</td></tr>
<tr><td class="h">1034</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params =&gt; [ &#39;in&#39;, $plugin[0] ] );</td></tr>
<tr><td class="h">1035</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1036</td><td colspan="6"></td></tr><tr><td class="h">1037</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1037">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $session-&gt;getOopsUrl( &#39;attention&#39;,</td></tr>
<tr><td class="h">1038</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;def =&gt; &#39;save_error&#39;,</td></tr>
<tr><td class="h">1039</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web =&gt; $web,</td></tr>
<tr><td class="h">1040</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;topic =&gt; $topic )</td></tr>
<tr><td class="h">1041</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless( defined $text );</td></tr>
<tr><td class="h">1042</td><td colspan="6"></td></tr><tr><td class="h">1043</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# extract meta data and merge old attachment meta data</td></tr>
<tr><td class="h">1044</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $meta = new TWiki::Meta( $session, $web, $topic );</td></tr>
<tr><td class="h">1045</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;{store}-&gt;extractMetaData( $meta, \$text );</td></tr>
<tr><td class="h">1046</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$meta-&gt;remove( &#39;FILEATTACHMENT&#39; );</td></tr>
<tr><td class="h">1047</td><td colspan="6"></td></tr><tr><td class="h">1048</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $oldMeta, $oldText ) =</td></tr>
<tr><td class="h">1049</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;{store}-&gt;readTopic( undef, $web, $topic, undef );</td></tr>
<tr><td class="h">1050</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$meta-&gt;copyFrom( $oldMeta, &#39;FILEATTACHMENT&#39; );</td></tr>
<tr><td class="h">1051</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# save topic</td></tr>
<tr><td class="h">1052</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $error =</td></tr>
<tr><td class="h">1053</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$session-&gt;{store}-&gt;saveTopic</td></tr>
<tr><td class="h">1054</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( $session-&gt;{user}, $web, $topic, $text, $meta,</td></tr>
<tr><td class="h">1055</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ notify =&gt; $dontNotify } );</td></tr>
<tr><td class="h">1056</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1056">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $session-&gt;getOopsUrl</td></tr>
<tr><td class="h">1057</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( &#39;attention&#39;, def =&gt; &#39;save_error&#39;,</td></tr>
<tr><td class="h">1058</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;web =&gt; $web, topic =&gt; $topic, params =&gt; $error ) if( $error );</td></tr>
<tr><td class="h">1059</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39;;</td></tr>
<tr><td class="h">1060</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1061</td><td colspan="6"></td></tr><tr><td class="h">1062 - 1096</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ moveTopic( $web, $topic, $newWeb, $newTopic )

   * =$web= source web - required
   * =$topic= source topic - required
   * =$newWeb= dest web
   * =$newTopic= dest topic
Renames the topic. Throws an exception if something went wrong.
If $newWeb is undef, it defaults to $web. If $newTopic is undef, it defaults
to $topic.

The destination topic must not already exist.

Rename a topic to the $TWiki::cfg{TrashWebName} to delete it.

*Since:* TWiki::Plugins::VERSION 1.1

&lt;verbatim&gt;
use Error qw( :try );

try {
    moveTopic( &quot;Work&quot;, &quot;TokyoOffice&quot;, &quot;Trash&quot;, &quot;ClosedOffice&quot; );
} catch Error::Simple with {
    my $e = shift;
    # see documentation on Error::Simple
} catch TWiki::AccessControlException with {
    my $e = shift;
    # see documentation on TWiki::AccessControlException
} otherwise {
    ...
};
&lt;/verbatim&gt;

=cut</pre></td></tr>
<tr><td class="h">1097</td><td colspan="6"></td></tr><tr><td class="h">1098</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub moveTopic {</td></tr>
<tr><td class="h">1099</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1099">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $newWeb, $newTopic ) = @_;</td></tr>
<tr><td class="h">1100</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1100">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$newWeb ||= $web;</td></tr>
<tr><td class="h">1101</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1101">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$newTopic ||= $topic;</td></tr>
<tr><td class="h">1102</td><td colspan="6"></td></tr><tr><td class="h">1103</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1103">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1103">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if( $newWeb eq $web &amp;&amp; $newTopic eq $topic );</td></tr>
<tr><td class="h">1104</td><td colspan="6"></td></tr><tr><td class="h">1105</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{store}-&gt;moveTopic(</td></tr>
<tr><td class="h">1106</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$web, $topic,</td></tr>
<tr><td class="h">1107</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newWeb, $newTopic,</td></tr>
<tr><td class="h">1108</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{user} );</td></tr>
<tr><td class="h">1109</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1110</td><td colspan="6"></td></tr><tr><td class="h">1111 - 1138</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getRevisionInfo($web, $topic, $rev, $attachment ) -&gt; ( $date, $user, $rev, $comment ) 

Get revision info of a topic or attachment
   * =$web= - Web name, optional, e.g. =&#39;Main&#39;=
   * =$topic=   - Topic name, required, e.g. =&#39;TokyoOffice&#39;=
   * =$rev=     - revsion number, or tag name (can be in the format 1.2, or just the minor number)
   * =$attachment=                 -attachment filename
Return: =( $date, $user, $rev, $comment )= List with: ( last update date, login name of last user, minor part of top revision number ), e.g. =( 1234561, &#39;phoeny&#39;, &quot;5&quot; )=
| $date | in epochSec |
| $user | Wiki name of the author (*not* login name) |
| $rev | actual rev number |
| $comment | WHAT COMMENT? |

NOTE: if you are trying to get revision info for a topic, use
=$meta-&gt;getRevisionInfo= instead if you can - it is significantly
more efficient, and returns a user object that contains other user
information.

NOTE: prior versions of TWiki may under some circumstances have returned
the login name of the user rather than the wiki name; the code documentation
was totally unclear, and we have been unable to establish the intent.
However the wikiname is obviously more useful, so that is what is returned.

*Since:* TWiki::Plugins::VERSION 1.000 (29 Jul 2001)

=cut</pre></td></tr>
<tr><td class="h">1139</td><td colspan="6"></td></tr><tr><td class="h">1140</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getRevisionInfo {</td></tr>
<tr><td class="h">1141</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1141">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1142</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $date, $user, $rev, $comment ) =</td></tr>
<tr><td class="h">1143</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{store}-&gt;getRevisionInfo( @_ );</td></tr>
<tr><td class="h">1144</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$user = $user-&gt;wikiName();</td></tr>
<tr><td class="h">1145</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return ( $date, $user, $rev, $comment );</td></tr>
<tr><td class="h">1146</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1147</td><td colspan="6"></td></tr><tr><td class="h">1148 - 1161</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getRevisionAtTime( $web, $topic, $time ) -&gt; $rev

Get the revision number of a topic at a specific time.
   * =$web= - web for topic
   * =$topic= - topic
   * =$time= - time (in epoch secs) for the rev
Return: Single-digit revision number, or undef if it couldn&#39;t be determined
(either because the topic isn&#39;t that old, or there was a problem)

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1162</td><td colspan="6"></td></tr><tr><td class="h">1163</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getRevisionAtTime {</td></tr>
<tr><td class="h">1164</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1164">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1165</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;getRevisionAtTime( @_ );</td></tr>
<tr><td class="h">1166</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1167</td><td colspan="6"></td></tr><tr><td class="h">1168 - 1186</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ readTopic( $web, $topic, $rev ) -&gt; ( $meta, $text )

Read topic text and meta data, regardless of access permissions.
   * =$web= - Web name, required, e.g. =&#39;Main&#39;=
   * =$topic= - Topic name, required, e.g. =&#39;TokyoOffice&#39;=
   * =$rev= - revision to read (default latest)
Return: =( $meta, $text )= Meta data object and topic text

=$meta= is a perl &#39;object&#39; of class =TWiki::Meta=. This class is
fully documented in the source code documentation shipped with the
release, or can be inspected in the =lib/TWiki/Meta.pm= file.

This method *ignores* topic access permissions. You should be careful to use =checkAccessPermissions= to ensure the current user has read access to the topic.

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1187</td><td colspan="6"></td></tr><tr><td class="h">1188</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub readTopic {</td></tr>
<tr><td class="h">1189</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#my( $web, $topic, $rev ) = @_;</td></tr>
<tr><td class="h">1190</td><td><div class="c3">11</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1190">11</a></div></td><td><div>33</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1191</td><td colspan="6"></td></tr><tr><td class="h">1192</td><td><div class="c3">11</div></td><td></td><td></td><td></td><td><div>127</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;readTopic( undef, @_ );</td></tr>
<tr><td class="h">1193</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1194</td><td colspan="6"></td></tr><tr><td class="h">1195 - 1210</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ readTopicText( $web, $topic, $rev, $ignorePermissions ) -&gt; $text

Read topic text, including meta data
   * =$web=                - Web name, e.g. =&#39;Main&#39;=, or empty
   * =$topic=              - Topic name, e.g. =&#39;MyTopic&#39;=, or =&quot;Main.MyTopic&quot;=
   * =$rev=                - Topic revision to read, optional. Specify the minor part of the revision, e.g. =&quot;5&quot;=, not =&quot;1.5&quot;=; the top revision is returned if omitted or empty.
   * =$ignorePermissions=  - Set to =&quot;1&quot;= if checkAccessPermission() is already performed and OK; an oops URL is returned if user has no permission
Return: =$text=                  Topic text with embedded meta data; an oops URL for calling redirectCgiQuery() is returned in case of an error

This method is more efficient than =readTopic=, but returns meta-data embedded in the text. Plugins authors must be very careful to avoid damaging meta-data. You are recommended to use readTopic instead, which is a lot safer..

*Since:* TWiki::Plugins::VERSION 1.010 (31 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1211</td><td colspan="6"></td></tr><tr><td class="h">1212</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub readTopicText {</td></tr>
<tr><td class="h">1213</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1213">2</a></div></td><td><div>12</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $rev, $ignorePermissions ) = @_;</td></tr>
<tr><td class="h">1214</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>4</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1215</td><td colspan="6"></td></tr><tr><td class="h">1216</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user;</td></tr>
<tr><td class="h">1217</td><td><div class="c3">2</div></td><td><div class="c0" title="-/F"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1217">50</a></div></td><td></td><td></td><td><div>8</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$user = $TWiki::Plugins::SESSION-&gt;{user}</td></tr>
<tr><td class="h">1218</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless defined( $ignorePermissions );</td></tr>
<tr><td class="h">1219</td><td colspan="6"></td></tr><tr><td class="h">1220</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>6</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $text;</td></tr>
<tr><td class="h">1221</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;try {</td></tr>
<tr><td class="h">1222</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1222">2</a></div></td><td><div>15</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$text =</td></tr>
<tr><td class="h">1223</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{store}-&gt;readTopicRaw</td></tr>
<tr><td class="h">1224</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( $user, $web, $topic, $rev );</td></tr>
<tr><td class="h">1225</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} catch TWiki::AccessControlException with {</td></tr>
<tr><td class="h">1226</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1226">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $e = shift;</td></tr>
<tr><td class="h">1227</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$text = $TWiki::Plugins::SESSION-&gt;getOopsUrl</td></tr>
<tr><td class="h">1228</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;( &#39;accessdenied&#39;, def=&gt;&#39;topic_access&#39;, web =&gt; $web, topic =&gt; $topic,</td></tr>
<tr><td class="h">1229</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;params =&gt; [ $e-&gt;{mode}, $e-&gt;{reason} ] );</td></tr>
<tr><td class="h">1230</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>28</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">1231</td><td colspan="6"></td></tr><tr><td class="h">1232</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>79</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $text;</td></tr>
<tr><td class="h">1233</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1234</td><td colspan="6"></td></tr><tr><td class="h">1235 - 1247</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ attachmentExists( $web, $topic, $attachment ) -&gt; $boolean

Test if attachment exists
   * =$web=   - Web name, optional, e.g. =Main=.
   * =$topic= - Topic name, required, e.g. =TokyoOffice=, or =Main.TokyoOffice=
   * =$attachment= - attachment name, e.g.=logo.gif=
$web and $topic are parsed as described in the documentation for =normalizeWebTopicName=.

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1248</td><td colspan="6"></td></tr><tr><td class="h">1249</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub attachmentExists {</td></tr>
<tr><td class="h">1250</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1250">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $attachment ) = @_;</td></tr>
<tr><td class="h">1251</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1252</td><td colspan="6"></td></tr><tr><td class="h">1253</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;( $web, $topic ) =</td></tr>
<tr><td class="h">1254</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;normalizeWebTopicName( $web, $topic );</td></tr>
<tr><td class="h">1255</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;attachmentExists(</td></tr>
<tr><td class="h">1256</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$web, $topic, $attachment );</td></tr>
<tr><td class="h">1257</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1258</td><td colspan="6"></td></tr><tr><td class="h">1259 - 1291</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ readAttachment( $web, $topic, $name, $rev ) -&gt; $data

   * =$web= - web for topic
   * =$topic= - topic
   * =$name= - attachment name
   * =$rev= - revision to read (default latest)
Read an attachment from the store for a topic, and return it as a string. The
names of attachments on a topic can be recovered from the meta-data returned
by =readTopic=. If the attachment does not exist, or cannot be read, undef
will be returned. If the revision is not specified, the latest version will
be returned.

View permission on the topic is required for the
read to be successful.  Access control violations are flagged by a
TWiki::AccessControlException. Permissions are checked for the current user.

&lt;verbatim&gt;
my( $meta, $text ) = TWiki::Func::readTopic( $web, $topic );
my @attachments = $meta-&gt;find( &#39;FILEATTACHMENT&#39; );
foreach my $a ( @attachments ) {
   try {
       my $data = TWiki::Func::readAttachment( $web, $topic, $a-&gt;{name} );
       ...
   } catch TWiki::AccessControlException with {
   };
}
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1292</td><td colspan="6"></td></tr><tr><td class="h">1293</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub readAttachment {</td></tr>
<tr><td class="h">1294</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1294">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $meta, $name ) = @_;</td></tr>
<tr><td class="h">1295</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1296</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result;</td></tr>
<tr><td class="h">1297</td><td colspan="6"></td></tr><tr><td class="h">1298</td><td></td><td></td><td></td><td></td><td></td><td class="s">#    try {</td></tr>
<tr><td class="h">1299</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = $TWiki::Plugins::SESSION-&gt;{store}-&gt;readAttachment(</td></tr>
<tr><td class="h">1300</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{user}, @_ );</td></tr>
<tr><td class="h">1301</td><td></td><td></td><td></td><td></td><td></td><td class="s">#    } catch Error::Simple with {</td></tr>
<tr><td class="h">1302</td><td></td><td></td><td></td><td></td><td></td><td class="s">#    };</td></tr>
<tr><td class="h">1303</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">1304</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1305</td><td colspan="6"></td></tr><tr><td class="h">1306 - 1341</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ saveAttachment( $web, $topic, $attachment, $opts )

   * =$web= - web for topic
   * =$topic= - topic to atach to
   * =$attachment= - name of the attachment
   * =$opts= - Ref to hash of options
=$opts= may include:
| =dontlog= | don&#39;t log this change in twiki log |
| =comment= | comment for save |
| =hide= | if the attachment is to be hidden in normal topic view |
| =stream= | Stream of file to upload |
| =file= | Name of a file to use for the attachment data. ignored if stream is set. Local file on the server. |
| =filepath= | Client path to file |
| =filesize= | Size of uploaded data |
| =filedate= | Date |

Save an attachment to the store for a topic. On success, returns undef. If there is an error, an exception will be thrown.

&lt;verbatim&gt;
    try {
        TWiki::Func::saveAttachment( $web, $topic, &#39;image.gif&#39;,
                                     { file =&gt; &#39;image.gif&#39;,
                                       comment =&gt; &#39;Picture of Health&#39;,
                                       hide =&gt; 1 } );
   } catch Error::Simple with {
      # see documentation on Error
   } otherwise {
      ...
   };
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1342</td><td colspan="6"></td></tr><tr><td class="h">1343</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub saveAttachment {</td></tr>
<tr><td class="h">1344</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1344">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $name, $data ) = @_;</td></tr>
<tr><td class="h">1345</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1346</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $result = undef;</td></tr>
<tr><td class="h">1347</td><td colspan="6"></td></tr><tr><td class="h">1348</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;try {</td></tr>
<tr><td class="h">1349</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1349">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{store}-&gt;saveAttachment(</td></tr>
<tr><td class="h">1350</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$web, $topic, $name,</td></tr>
<tr><td class="h">1351</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{user},</td></tr>
<tr><td class="h">1352</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$data );</td></tr>
<tr><td class="h">1353</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;} catch Error::Simple with {</td></tr>
<tr><td class="h">1354</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1354">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$result = shift-&gt;{-text};</td></tr>
<tr><td class="h">1355</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;};</td></tr>
<tr><td class="h">1356</td><td colspan="6"></td></tr><tr><td class="h">1357</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">1358</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1359</td><td colspan="6"></td></tr><tr><td class="h">1360 - 1398</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ moveAttachment( $web, $topic, $attachment, $newWeb, $newTopic, $newAttachment )

   * =$web= source web - required
   * =$topic= source topic - required
   * =$attachment= source attachment - required
   * =$newWeb= dest web
   * =$newTopic= dest topic
   * =$newAttachment= dest attachment
Renames the topic. Throws an exception on error or access violation.
If $newWeb is undef, it defaults to $web. If $newTopic is undef, it defaults
to $topic. If $newAttachment is undef, it defaults to $attachment. If all of $newWeb, $newTopic and $newAttachment are undef, it is an error.

The destination topic must already exist, but the destination attachment must
*not* exist.

Rename an attachment to $TWiki::cfg{TrashWebName}.TrashAttament to delete it.

&lt;verbatim&gt;
use Error qw( :try );

try {
   # move attachment between topics
   moveAttachment( &quot;Countries&quot;, &quot;Germany&quot;, &quot;AlsaceLorraine.dat&quot;,
                     &quot;Countries&quot;, &quot;France&quot; );
   # Note destination attachment name is defaulted to the same as source
} catch TWiki::AccessControlException with {
   my $e = shift;
   # see documentation on TWiki::AccessControlException
} catch Error::Simple with {
   my $e = shift;
   # see documentation on Error::Simple
};
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1399</td><td colspan="6"></td></tr><tr><td class="h">1400</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub moveAttachment {</td></tr>
<tr><td class="h">1401</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1401">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $web, $topic, $attachment, $newWeb, $newTopic, $newAttachment ) = @_;</td></tr>
<tr><td class="h">1402</td><td colspan="6"></td></tr><tr><td class="h">1403</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1403">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$newWeb ||= $web;</td></tr>
<tr><td class="h">1404</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1404">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$newTopic ||= $topic;</td></tr>
<tr><td class="h">1405</td><td><div class="c0">0</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1405">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$newAttachment ||= $attachment;</td></tr>
<tr><td class="h">1406</td><td colspan="6"></td></tr><tr><td class="h">1407</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1407">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1407">0</a></div></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return if( $newWeb eq $web &amp;&amp;</td></tr>
<tr><td class="h">1408</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newTopic eq $topic &amp;&amp;</td></tr>
<tr><td class="h">1409</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newAttachment eq $attachment );</td></tr>
<tr><td class="h">1410</td><td colspan="6"></td></tr><tr><td class="h">1411</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{store}-&gt;moveAttachment(</td></tr>
<tr><td class="h">1412</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$web, $topic, $attachment,</td></tr>
<tr><td class="h">1413</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$newWeb, $newTopic, $newAttachment,</td></tr>
<tr><td class="h">1414</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;{user} );</td></tr>
<tr><td class="h">1415</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1416</td><td colspan="6"></td></tr><tr><td class="h">1417 - 1421</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Assembling Pages

=cut</pre></td></tr>
<tr><td class="h">1422</td><td colspan="6"></td></tr><tr><td class="h">1423 - 1434</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ readTemplate( $name, $skin ) -&gt; $text

Read a template or skin. Embedded [[%TWIKIWEB%.TWikiTemplates][template directives]] get expanded
   * =$name= - Template name, e.g. =&#39;view&#39;=
   * =$skin= - Comma-separated list of skin names, optional, e.g. =&#39;print&#39;=
Return: =$text=    Template text

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1435</td><td colspan="6"></td></tr><tr><td class="h">1436</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub readTemplate {</td></tr>
<tr><td class="h">1437</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $name, $skin ) = @_;</td></tr>
<tr><td class="h">1438</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1438">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1439</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{templates}-&gt;readTemplate( @_ );</td></tr>
<tr><td class="h">1440</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1441</td><td colspan="6"></td></tr><tr><td class="h">1442 - 1460</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ loadTemplate ( $name, $skin, $web ) -&gt; $text

   * =$name= - template file name
   * =$skin= - comma-separated list of skins to use (default: current skin)
   * =$web= - the web to look in for topics that contain templates (default: current web)
Return: expanded template text (what&#39;s left after removal of all %TMPL:DEF% statements)

*Since:* TWiki::Plugins::VERSION 1.1

Reads a template and extracts template definitions, adding them to the
list of loaded templates, overwriting any previous definition.

How TWiki searches for templates is described in TWikiTemplates.

If template text is found, extracts include statements and fully expands them.

=cut</pre></td></tr>
<tr><td class="h">1461</td><td colspan="6"></td></tr><tr><td class="h">1462</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub loadTemplate {</td></tr>
<tr><td class="h">1463</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1463">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1464</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{templates}-&gt;readTemplate( @_ );</td></tr>
<tr><td class="h">1465</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1466</td><td colspan="6"></td></tr><tr><td class="h">1467 - 1480</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ expandTemplate( $def  ) -&gt; $string

Do a %TMPL:P{$def}%, only expanding the template (not expanding any variables other than %TMPL)
   * =$def= - template name
Return: the text of the expanded template

*Since:* TWiki::Plugins::VERSION 1.1

A template is defined using a %TMPL:DEF% statement in a template
file. See the documentation on TWiki templates for more information.

=cut</pre></td></tr>
<tr><td class="h">1481</td><td colspan="6"></td></tr><tr><td class="h">1482</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expandTemplate {</td></tr>
<tr><td class="h">1483</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1483">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1484</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{templates}-&gt;expandTemplate( @_ );</td></tr>
<tr><td class="h">1485</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1486</td><td colspan="6"></td></tr><tr><td class="h">1487 - 1498</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ writeHeader( $query, $contentLength )

Prints a basic content-type HTML header for text/html to standard out
   * =$query= - CGI query object. If not given, the default CGI query will be used. In most cases you should _not_ pass this parameter.
   * =$contentLength= - Length of content
Return:             none

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1499</td><td colspan="6"></td></tr><tr><td class="h">1500</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub writeHeader {</td></tr>
<tr><td class="h">1501</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1501">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $query ) = @_;</td></tr>
<tr><td class="h">1502</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1503</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;writePageHeader( $query );</td></tr>
<tr><td class="h">1504</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1505</td><td colspan="6"></td></tr><tr><td class="h">1506 - 1542</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ redirectCgiQuery( $query, $url, $passthru )

Redirect to URL
   * =$query= - CGI query object. Ignored, only there for compatibility. The session CGI query object is used instead.
   * =$url=   - URL to redirect to
   * =$passthru= - enable passthrough.

Return:             none

Print output to STDOUT that will cause a 302 redirect to a new URL.
Nothing more should be printed to STDOUT after this method has been called.

The =$passthru= parameter allows you to pass the parameters that were passed
to the current query on to the target URL, as long as it is another URL on the
same TWiki installation. If =$passthru= is set to a true value, then TWiki
will save the current URL parameters, and then try to restore them on the
other side of the redirect. Parameters are stored on the server in a cache
file (see ={PassthroughDir} in =configure=).

Note that if =$passthru= is set, then any parameters in =$url= will be lost
when the old parameters are restored. if you want to change any parameter
values, you will need to do that in the current CGI query before redirecting
e.g.
&lt;verbatim&gt;
my $query = TWiki::Func::getCgiQuery();
$query-&gt;param(-name =&gt; &#39;text&#39;, -value =&gt; &#39;Different text&#39;);
TWiki::Func::redirectCgiQuery(
  undef, TWiki::Func::getScriptUrl($web, $topic, &#39;edit&#39;), 1);
&lt;/verbatim&gt;
=$passthru= does nothing if =$url= does not point to a script in the current
TWiki installation.

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1543</td><td colspan="6"></td></tr><tr><td class="h">1544</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub redirectCgiQuery {</td></tr>
<tr><td class="h">1545</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1545">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $query, $url, $passthru ) = @_;</td></tr>
<tr><td class="h">1546</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1547</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;redirect( $url, $passthru );</td></tr>
<tr><td class="h">1548</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1549</td><td colspan="6"></td></tr><tr><td class="h">1550 - 1570</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ addToHEAD( $id, $header )

Adds =$header= to the HTML header (the &lt;head&gt; tag).
This is useful for Plugins that want to include some javascript custom css.
   * =$id= - Unique ID to prevent the same HTML from being duplicated. Plugins should use a prefix to prevent name clashes (e.g EDITTABLEPLUGIN_JSCALENDAR)
   * =$header= - the HTML to be added to the &lt;head&gt; section. The HTML must be valid in a HEAD tag - no checks are performed.

All TWiki variables present in =$header= will be expanded before being inserted into the =&lt;head&gt;= section.

Note that this is _not_ the same as the HTTP header, which is modified through the Plugins =modifyHeaderHandler=.

*Since:* TWiki::Plugins::VERSION 1.1

example:
&lt;verbatim&gt;
TWiki::Func::addToHEAD(&#39;PATTERN_STYLE&#39;,&#39;&lt;link id=&quot;twikiLayoutCss&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;%PUBURL%/TWiki/PatternSkin/layout.css&quot; media=&quot;all&quot; /&gt;&#39;)
&lt;/verbatim&gt;

=cut=	</pre></td></tr>
<tr><td class="h">1571</td><td colspan="6"></td></tr><tr><td class="h">1572</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub addToHEAD {</td></tr>
<tr><td class="h">1573</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1573">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my( $tag, $header ) = @_;</td></tr>
<tr><td class="h">1574</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1575</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION-&gt;addToHEAD( $tag, $header );</td></tr>
<tr><td class="h">1576</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1577</td><td colspan="6"></td></tr><tr><td class="h">1578 - 1592</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ expandCommonVariables( $text, $topic, $web ) -&gt; $text

Expand all common =%&lt;nop&gt;VARIABLES%=
   * =$text=  - Text with variables to expand, e.g. =&#39;Current user is %&lt;nop&gt;WIKIUSER%&#39;=
   * =$topic= - Current topic name, e.g. =&#39;WebNotify&#39;=
   * =$web=   - Web name, optional, e.g. =&#39;Main&#39;=. The current web is taken if missing
Return: =$text=     Expanded text, e.g. =&#39;Current user is &lt;nop&gt;TWikiGuest&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

See also: expandVariablesOnTopicCreation

=cut</pre></td></tr>
<tr><td class="h">1593</td><td colspan="6"></td></tr><tr><td class="h">1594</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expandCommonVariables {</td></tr>
<tr><td class="h">1595</td><td><div class="c3">11</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1595">11</a></div></td><td><div>70</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $text, $topic, $web ) = @_;</td></tr>
<tr><td class="h">1596</td><td><div class="c3">11</div></td><td></td><td></td><td></td><td><div>32</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1597</td><td><div class="c3">11</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1597">50</a></div></td><td></td><td><div>54</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$topic ||= $TWiki::Plugins::SESSION-&gt;{topicName};</td></tr>
<tr><td class="h">1598</td><td><div class="c3">11</div></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L1598">50</a></div></td><td></td><td><div>55</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$web ||= $TWiki::Plugins::SESSION-&gt;{webName};</td></tr>
<tr><td class="h">1599</td><td><div class="c3">11</div></td><td></td><td></td><td></td><td><div>82</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;handleCommonTags( $text, $web, $topic );</td></tr>
<tr><td class="h">1600</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1601</td><td colspan="6"></td></tr><tr><td class="h">1602 - 1613</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ renderText( $text, $web ) -&gt; $text

Render text from TWiki markup into XHTML as defined in [[%TWIKIWEB%.TextFormattingRules]]
   * =$text= - Text to render, e.g. =&#39;*bold* text and =fixed font=&#39;=
   * =$web=  - Web name, optional, e.g. =&#39;Main&#39;=. The current web is taken if missing
Return: =$text=    XHTML text, e.g. =&#39;&amp;lt;b&gt;bold&amp;lt;/b&gt; and &amp;lt;code&gt;fixed font&amp;lt;/code&gt;&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1614</td><td colspan="6"></td></tr><tr><td class="h">1615</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub renderText {</td></tr>
<tr><td class="h">1616</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $text, $web ) = @_;</td></tr>
<tr><td class="h">1617</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1617">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1618</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{renderer}-&gt;getRenderedVersion( @_ );</td></tr>
<tr><td class="h">1619</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1620</td><td colspan="6"></td></tr><tr><td class="h">1621 - 1636</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ internalLink( $pre, $web, $topic, $label, $anchor, $createLink ) -&gt; $text

Render topic name and link label into an XHTML link. Normally you do not need to call this funtion, it is called internally by =renderText()=
   * =$pre=        - Text occuring before the TWiki link syntax, optional
   * =$web=        - Web name, required, e.g. =&#39;Main&#39;=
   * =$topic=      - Topic name to link to, required, e.g. =&#39;WebNotify&#39;=
   * =$label=      - Link label, required. Usually the same as =$topic=, e.g. =&#39;notify&#39;=
   * =$anchor=     - Anchor, optional, e.g. =&#39;#Jump&#39;=
   * =$createLink= - Set to =&#39;1&#39;= to add question linked mark after topic name if topic does not exist;&lt;br /&gt; set to =&#39;0&#39;= to suppress link for non-existing topics
Return: =$text=          XHTML anchor, e.g. =&#39;&amp;lt;a href=&#39;/cgi-bin/view/Main/WebNotify#Jump&#39;&gt;notify&amp;lt;/a&gt;&#39;=

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1637</td><td colspan="6"></td></tr><tr><td class="h">1638</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub internalLink {</td></tr>
<tr><td class="h">1639</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1639">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $pre = shift;</td></tr>
<tr><td class="h">1640</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1641</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $web, $topic, $label, $anchor, $anchor, $createLink ) = @_;</td></tr>
<tr><td class="h">1642</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $pre . $TWiki::Plugins::SESSION-&gt;{renderer}-&gt;internalLink( @_ );</td></tr>
<tr><td class="h">1643</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1644</td><td colspan="6"></td></tr><tr><td class="h">1645 - 1674</td><td colspan="5"></td><td class="s"><pre>=pod

---++ E-mail

---+++ sendEmail ( $text, $retries ) -&gt; $error

   * =$text= - text of the mail, including MIME headers
   * =$retries= - number of times to retry the send (default 1)
Send an e-mail specified as MIME format content. To specify MIME
format mails, you create a string that contains a set of header
lines that contain field definitions and a message body such as:
&lt;verbatim&gt;
To: liz@windsor.gov.uk
From: serf@hovel.net
CC: george@whitehouse.gov
Subject: Revolution

Dear Liz,

Please abolish the monarchy (with King George&#39;s permission, of course)

Thanks,

A. Peasant
&lt;/verbatim&gt;
Leave a blank line between the last header field and the message body.

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1675</td><td colspan="6"></td></tr><tr><td class="h">1676</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub sendEmail {</td></tr>
<tr><td class="h">1677</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#my( $text, $retries ) = @_;</td></tr>
<tr><td class="h">1678</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1678">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1679</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{net}-&gt;sendEmail( @_ );</td></tr>
<tr><td class="h">1680</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1681</td><td colspan="6"></td></tr><tr><td class="h">1682 - 1693</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ wikiToEmail( $wikiName ) -&gt; $email

   * =$wikiName= - wiki name of the user
Get the e-mail address(es) of the named user. If the user has multiple
e-mail addresses (for example, the user is a group), then the list will
be comma-separated.

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1694</td><td colspan="6"></td></tr><tr><td class="h">1695</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub wikiToEmail {</td></tr>
<tr><td class="h">1696</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1696">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $wiki ) = @_;</td></tr>
<tr><td class="h">1697</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1698</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1698">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39; unless $wiki;</td></tr>
<tr><td class="h">1699</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $user = $TWiki::Plugins::SESSION-&gt;{users}-&gt;findUser( $wiki, undef, 1 );</td></tr>
<tr><td class="h">1700</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1700">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return &#39;&#39; unless $user;</td></tr>
<tr><td class="h">1701</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return join( &#39;,&#39;, $user-&gt;emails() );</td></tr>
<tr><td class="h">1702</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1703</td><td colspan="6"></td></tr><tr><td class="h">1704 - 1708</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Creating New Topics

=cut</pre></td></tr>
<tr><td class="h">1709</td><td colspan="6"></td></tr><tr><td class="h">1710 - 1735</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ expandVariablesOnTopicCreation ( $text ) -&gt; $text

Expand the limited set of variables that are always expanded during topic creation
   * =$text= - the text to process
Return: text with variables expanded

*Since:* TWiki::Plugins::VERSION 1.1

Expands only the variables expected in templates that must be statically
expanded in new content.

The expanded variables are:
   * =%&lt;nop&gt;DATE%= Signature-format date
   * =%&lt;nop&gt;SERVERTIME%= See TWikiVariables
   * =%&lt;nop&gt;GMTIME%= See TWikiVariables
   * =%&lt;nop&gt;USERNAME%= Base login name
   * =%&lt;nop&gt;WIKINAME%= Wiki name
   * =%&lt;nop&gt;WIKIUSERNAME%= Wiki name with prepended web
   * =%&lt;nop&gt;URLPARAM{...}%= - Parameters to the current CGI query
   * =%&lt;nop&gt;NOP%= No-op

See also: expandVariables

=cut</pre></td></tr>
<tr><td class="h">1736</td><td colspan="6"></td></tr><tr><td class="h">1737</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub expandVariablesOnTopicCreation {</td></tr>
<tr><td class="h">1738</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1738">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1739</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;expandVariablesOnTopicCreation( shift, $TWiki::Plugins::SESSION-&gt;{user} );</td></tr>
<tr><td class="h">1740</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1741</td><td colspan="6"></td></tr><tr><td class="h">1742 - 1748</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Special handlers

Special handlers can be defined to make functions in plugins behave as if they were built-in to TWiki.

=cut</pre></td></tr>
<tr><td class="h">1749</td><td colspan="6"></td></tr><tr><td class="h">1750 - 1798</td><td colspan="5"></td><td class="s"><pre>=pod=

---+++ registerTagHandler( $var, \&amp;fn, $syntax )

Should only be called from initPlugin.

Register a function to handle a simple variable. Handles both %&lt;nop&gt;VAR% and %&lt;nop&gt;VAR{...}%. Registered variables are treated the same as TWiki internal variables, and are expanded at the same time. This is a _lot_ more efficient than using the =commonTagsHandler=.
   * =$var= - The name of the variable, i.e. the &#39;MYVAR&#39; part of %&lt;nop&gt;MYVAR%. The variable name *must* match /^[A-Z][A-Z0-9_]*$/ or it won&#39;t work.
   * =\&amp;fn= - Reference to the handler function.
   * =$syntax= can be &#39;classic&#39; (the default) or &#39;context-free&#39;. &#39;classic&#39; syntax is appropriate where you want the variable to support classic TWiki syntax i.e. to accept the standard =%&lt;nop&gt;MYVAR{ &quot;unnamed&quot; param1=&quot;value1&quot; param2=&quot;value2&quot; }%= syntax, as well as an unquoted default parameter, such as =%&lt;nop&gt;MYVAR{unquoted parameter}%=. If your variable will only use named parameters, you can use &#39;context-free&#39; syntax, which supports a more relaxed syntax. For example, %MYVAR{param1=value1, value 2, param3=&quot;value 3&quot;, param4=&#39;value 5&quot;}%

*Since:* TWiki::Plugins::VERSION 1.1

The variable handler function must be of the form:
&lt;verbatim&gt;
sub handler(\%session, \%params, $topic, $web)
&lt;/verbatim&gt;
where:
   * =\%session= - a reference to the TWiki session object (may be ignored)
   * =\%params= - a reference to a TWiki::Attrs object containing parameters. This can be used as a simple hash that maps parameter names to values, with _DEFAULT being the name for the default parameter.
   * =$topic= - name of the topic in the query
   * =$web= - name of the web in the query
for example, to execute an arbitrary command on the server, you might do this:
&lt;verbatim&gt;
sub initPlugin{
   TWiki::Func::registerTagHandler(&#39;EXEC&#39;, \&amp;boo);
}

sub boo {
    my( $session, $params, $topic, $web ) = @_;
    my $cmd = $params-&gt;{_DEFAULT};

    return &quot;NO COMMAND SPECIFIED&quot; unless $cmd;

    my $result = `$cmd 2&gt;&amp;1`;
    return $params-&gt;{silent} ? &#39;&#39; : $result;
}
}
&lt;/verbatim&gt;
would let you do this:
=%&lt;nop&gt;EXEC{&quot;ps -Af&quot; silent=&quot;on&quot;}%=

Registered tags differ from tags implemented using the old TWiki approach (text substitution in =commonTagsHandler=) in the following ways:
   * registered tags are evaluated at the same time as system tags, such as %SERVERTIME. =commonTagsHandler= is only called later, when all system tags have already been expanded (though they are expanded _again_ after =commonTagsHandler= returns).
   * registered tag names can only contain alphanumerics and _ (underscore)
   * registering a tag =FRED= defines both =%&lt;nop&gt;FRED{...}%= *and also* =%FRED%=.
   * registered tag handlers *cannot* return another tag as their only result (e.g. =return &#39;%&lt;nop&gt;SERVERTIME%&#39;;=). It won&#39;t work.

=cut</pre></td></tr>
<tr><td class="h">1799</td><td colspan="6"></td></tr><tr><td class="h">1800</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub registerTagHandler {</td></tr>
<tr><td class="h">1801</td><td><div class="c3">12</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1801">12</a></div></td><td><div>45</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $tag, $function, $syntax ) = @_;</td></tr>
<tr><td class="h">1802</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td><div>26</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1803</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use an anonymous function so it gets inlined at compile time.</td></tr>
<tr><td class="h">1804</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Make sure we don&#39;t mangle the session reference.</td></tr>
<tr><td class="h">1805</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;TWiki::registerTagHandler( $tag,</td></tr>
<tr><td class="h">1806</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub {</td></tr>
<tr><td class="h">1807</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1807">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $record = $TWiki::Plugins::SESSION;</td></tr>
<tr><td class="h">1808</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION = $_[0];</td></tr>
<tr><td class="h">1809</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $result = &amp;$function( @_ );</td></tr>
<tr><td class="h">1810</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION = $record;</td></tr>
<tr><td class="h">1811</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">1812</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},</td></tr>
<tr><td class="h">1813</td><td><div class="c3">12</div></td><td></td><td></td><td></td><td><div>84</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$syntax</td></tr>
<tr><td class="h">1814</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1815</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1816</td><td colspan="6"></td></tr><tr><td class="h">1817 - 1859</td><td colspan="5"></td><td class="s"><pre>=pod=

---+++ registerRESTHandler( $alias, \&amp;fn, )

Should only be called from initPlugin.

Adds a function to the dispatch table of the REST interface 
   * =$alias= - The name .
   * =\&amp;fn= - Reference to the function.

*Since:* TWiki::Plugins::VERSION 1.1

The handler function must be of the form:
&lt;verbatim&gt;
sub handler(\%session)
&lt;/verbatim&gt;
where:
   * =\%session= - a reference to the TWiki session object (may be ignored)

From the REST interface, the name of the plugin must be used
as the subject of the invokation.

Example
-------

The EmptyPlugin has the following call in the initPlugin handler:
&lt;verbatim&gt;
   TWiki::Func::registerRESTHandler(&#39;example&#39;, \&amp;restExample);
&lt;/verbatim&gt;

This adds the =restExample= function to the REST dispatch table 
for the EmptyPlugin under the &#39;example&#39; alias, and allows it 
to be invoked using the URL

=http://server:port/bin/rest/EmptyPlugin/example=

note that the URL

=http://server:port/bin/rest/EmptyPlugin/restExample=

(ie, with the name of the function instead of the alias) will not work.
 
=cut</pre></td></tr>
<tr><td class="h">1860</td><td colspan="6"></td></tr><tr><td class="h">1861</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub registerRESTHandler {</td></tr>
<tr><td class="h">1862</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1862">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $alias, $function) = @_;</td></tr>
<tr><td class="h">1863</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1864</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $plugin = caller;</td></tr>
<tr><td class="h">1865</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$plugin =~ s/.*:://; # strip off TWiki::Plugins:: prefix</td></tr>
<tr><td class="h">1866</td><td colspan="6"></td></tr><tr><td class="h">1867</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Use an anonymous function so it gets inlined at compile time.</td></tr>
<tr><td class="h">1868</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# Make sure we don&#39;t mangle the session reference.</td></tr>
<tr><td class="h">1869</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;TWiki::registerRESTHandler( $plugin,</td></tr>
<tr><td class="h">1870</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$alias,</td></tr>
<tr><td class="h">1871</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;sub {</td></tr>
<tr><td class="h">1872</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1872">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $record = $TWiki::Plugins::SESSION;</td></tr>
<tr><td class="h">1873</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION = $_[0];</td></tr>
<tr><td class="h">1874</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $result = &amp;$function( @_ );</td></tr>
<tr><td class="h">1875</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$TWiki::Plugins::SESSION = $record;</td></tr>
<tr><td class="h">1876</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return $result;</td></tr>
<tr><td class="h">1877</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1878</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;);</td></tr>
<tr><td class="h">1879</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1880</td><td colspan="6"></td></tr><tr><td class="h">1881 - 1885</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Searching

=cut</pre></td></tr>
<tr><td class="h">1886</td><td colspan="6"></td></tr><tr><td class="h">1887 - 1916</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ searchInWebContent($searchString, $web, \@topics, \%options ) -&gt; \%map

Search for a string in the content of a web. The search is over all content, including meta-data. Meta-data matches will be returned as formatted lines within the topic content (meta-data matches are returned as lines of the format %META:\w+{.*}%)
   * =$searchString= - the search string, in egrep format
   * =$web= - The web to search in
   * =\@topics= - reference to a list of topics to search
   * =\%option= - reference to an options hash
The =\%options= hash may contain the following options:
   * =type= - if =regex= will perform a egrep-syntax RE search (default &#39;&#39;)
   * =casesensitive= - false to ignore case (defaulkt true)
   * =files_without_match= - true to return files only (default false). If =files_without_match= is specified, it will return on the first match in each topic (i.e. it will return only one match per topic, and will not return matching lines).

The return value is a reference to a hash which maps each matching topic
name to a list of the lines in that topic that matched the search,
as would be returned by &#39;grep&#39;.

To iterate over the returned topics use:
&lt;verbatim&gt;
my $result = TWiki::Func::searchInWebContent( &quot;Slimy Toad&quot;, $web, \@topics,
   { casesensitive =&gt; 0, files_without_match =&gt; 0 } );
foreach my $topic (keys %$result ) {
   foreach my $matching_line ( @{$result-&gt;{$topic}} ) {
      ...etc
&lt;/verbatim&gt;

*Since:* TWiki::Plugins::VERSION 1.1

=cut</pre></td></tr>
<tr><td class="h">1917</td><td colspan="6"></td></tr><tr><td class="h">1918</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub searchInWebContent {</td></tr>
<tr><td class="h">1919</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#my( $searchString, $web, $topics, $options ) = @_;</td></tr>
<tr><td class="h">1920</td><td colspan="6"></td></tr><tr><td class="h">1921</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1921">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;searchInWebContent( @_ );</td></tr>
<tr><td class="h">1922</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1923</td><td colspan="6"></td></tr><tr><td class="h">1924 - 1928</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Plugin-specific file handling

=cut</pre></td></tr>
<tr><td class="h">1929</td><td colspan="6"></td></tr><tr><td class="h">1930 - 1945</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getWorkArea( $pluginName ) -&gt; $directorypath

Gets a private directory for Plugin use. The Plugin is entirely responsible
for managing this directory; TWiki will not read from it, or write to it.

The directory is guaranteed to exist, and to be writable by the webserver
user. By default it will *not* be web accessible.

The directory and it&#39;s contents are permanent, so Plugins must be careful
to keep their areas tidy.

*Since:* TWiki::Plugins::VERSION 1.1 (Dec 2005)

=cut</pre></td></tr>
<tr><td class="h">1946</td><td colspan="6"></td></tr><tr><td class="h">1947</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getWorkArea {</td></tr>
<tr><td class="h">1948</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1948">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $plugin ) = @_;</td></tr>
<tr><td class="h">1949</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">1950</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;getWorkArea( $plugin );</td></tr>
<tr><td class="h">1951</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1952</td><td colspan="6"></td></tr><tr><td class="h">1953 - 1965</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ readFile( $filename ) -&gt; $text

Read file, low level. Used for Plugin workarea.
   * =$filename= - Full path name of file
Return: =$text= Content of file, empty if not found

__NOTE:__ Use this function only for the Plugin workarea, *not* for topics and attachments. Use the appropriate functions to manipulate topics and attachments.

*Since:* TWiki::Plugins::VERSION 1.000 (07 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1966</td><td colspan="6"></td></tr><tr><td class="h">1967</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub readFile {</td></tr>
<tr><td class="h">1968</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1968">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $name = shift;</td></tr>
<tr><td class="h">1969</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $data = &#39;&#39;;</td></tr>
<tr><td class="h">1970</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1970">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;open( IN_FILE, &quot;&lt;$name&quot; ) || return &#39;&#39;;</td></tr>
<tr><td class="h">1971</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;local $/ = undef; # set to read to EOF</td></tr>
<tr><td class="h">1972</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$data = &lt;IN_FILE&gt;;</td></tr>
<tr><td class="h">1973</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;close( IN_FILE );</td></tr>
<tr><td class="h">1974</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1974">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;$data = &#39;&#39; unless $data; # no undefined</td></tr>
<tr><td class="h">1975</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $data;</td></tr>
<tr><td class="h">1976</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">1977</td><td colspan="6"></td></tr><tr><td class="h">1978 - 1991</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ saveFile( $filename, $text )

Save file, low level. Used for Plugin workarea.
   * =$filename= - Full path name of file
   * =$text=     - Text to save
Return:                none

__NOTE:__ Use this function only for the Plugin workarea, *not* for topics and attachments. Use the appropriate functions to manipulate topics and attachments.

*Since:* TWiki::Plugins::VERSION 1.000 (07 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">1992</td><td colspan="6"></td></tr><tr><td class="h">1993</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub saveFile {</td></tr>
<tr><td class="h">1994</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L1994">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $name, $text ) = @_;</td></tr>
<tr><td class="h">1995</td><td colspan="6"></td></tr><tr><td class="h">1996</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L1996">0</a></div></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;unless ( open( FILE, &quot;&gt;$name&quot; ) )  {</td></tr>
<tr><td class="h">1997</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;die &quot;Can&#39;t create file $name - $!\n&quot;;</td></tr>
<tr><td class="h">1998</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">1999</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;print FILE $text;</td></tr>
<tr><td class="h">2000</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;close( FILE);</td></tr>
<tr><td class="h">2001</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2002</td><td colspan="6"></td></tr><tr><td class="h">2003 - 2007</td><td colspan="5"></td><td class="s"><pre>=pod

---++ General Utilities

=cut</pre></td></tr>
<tr><td class="h">2008</td><td colspan="6"></td></tr><tr><td class="h">2009 - 2054</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getRegularExpression( $name ) -&gt; $expr

Retrieves a TWiki predefined regular expression or character class.
   * =$name= - Name of the expression to retrieve.  See notes below
Return: String or precompiled regular expression matching as described below.

*Since:* TWiki::Plugins::VERSION 1.020 (9 Feb 2004)

__Note:__ TWiki internally precompiles several regular expressions to
represent various string entities in an &lt;nop&gt;I18N-compatible manner. Plugins
authors are encouraged to use these in matching where appropriate. The
following are guaranteed to be present. Others may exist, but their use
is unsupported and they may be removed in future TWiki versions.

In the table below, the expression marked type &#39;String&#39; are intended for
use within character classes (i.e. for use within square brackets inside
a regular expression), for example:
&lt;verbatim&gt;
   my $upper = TWiki::Func::getRegularExpression(&#39;upperAlpha&#39;);
   my $alpha = TWiki::Func::getRegularExpression(&#39;mixedAlpha&#39;);
   my $capitalized = qr/[$upper][$alpha]+/;
&lt;/verbatim&gt;
Those expressions marked type &#39;RE&#39; are precompiled regular expressions that can be used outside square brackets. For example:
&lt;verbatim&gt;
   my $webRE = TWiki::Func::getRegularExpression(&#39;webNameRegex&#39;);
   my $isWebName = ( $s =~ m/$webRE/ );
&lt;/verbatim&gt;

| *Name*         | *Matches*                        | *Type* |
| upperAlpha     | Upper case characters            | String |
| upperAlphaNum  | Upper case characters and digits | String |
| lowerAlpha     | Lower case characters            | String |
| lowerAlphaNum  | Lower case characters and digits | String |
| numeric        | Digits                           | String |
| mixedAlpha     | Alphabetic characters            | String |
| mixedAlphaNum  | Alphanumeric characters          | String |
| wikiWordRegex  | WikiWords                        | RE |
| webNameRegex   | User web names                   | RE |
| anchorRegex    | #AnchorNames                     | RE |
| abbrevRegex    | Abbreviations e.g. GOV, IRS      | RE |
| emailAddrRegex | email@address.com                | RE |
| tagNameRegex   | Standard variable names e.g. %&lt;nop&gt;THIS_BIT% (THIS_BIT only) | RE |

=cut</pre></td></tr>
<tr><td class="h">2055</td><td colspan="6"></td></tr><tr><td class="h">2056</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getRegularExpression {</td></tr>
<tr><td class="h">2057</td><td><div class="c3">2</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2057">2</a></div></td><td><div>7</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $regexName ) = @_;</td></tr>
<tr><td class="h">2058</td><td><div class="c3">2</div></td><td></td><td></td><td></td><td><div>9</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::regex{$regexName};</td></tr>
<tr><td class="h">2059</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2060</td><td colspan="6"></td></tr><tr><td class="h">2061 - 2090</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ normalizeWebTopicName($web, $topic) -&gt; ($web, $topic)

Parse a web and topic name, supplying defaults as appropriate.
   * =$web= - Web name, identifying variable, or empty string
   * =$topic= - Topic name, may be a web.topic string, required.
Return: the parsed Web/Topic pair

*Since:* TWiki::Plugins::VERSION 1.1

| *Input*                               | *Return*  |
| &lt;tt&gt;( &#39;Web&#39;, &#39;Topic&#39; ) &lt;/tt&gt;          | &lt;tt&gt;( &#39;Web&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;Topic&#39; ) &lt;/tt&gt;             | &lt;tt&gt;( &#39;Main&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;&#39; ) &lt;/tt&gt;                  | &lt;tt&gt;( &#39;Main&#39;, &#39;WebHome&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;Web/Topic&#39; ) &lt;/tt&gt;         | &lt;tt&gt;( &#39;Web&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;Web/Subweb/Topic&#39; ) &lt;/tt&gt;  | &lt;tt&gt;( &#39;Web/Subweb&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;Web.Topic&#39; ) &lt;/tt&gt;         | &lt;tt&gt;( &#39;Web&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;Web.Subweb.Topic&#39; ) &lt;/tt&gt;  | &lt;tt&gt;( &#39;Web/Subweb&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;Web1&#39;, &#39;Web2.Topic&#39; )&lt;/tt&gt;     | &lt;tt&gt;( &#39;Web2&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |

Note that hierarchical web names (Web.SubWeb) are only available if hierarchical webs are enabled in =configure=.

The symbols %&lt;nop&gt;USERSWEB%, %&lt;nop&gt;SYSTEMWEB%, %&lt;nop&gt;DOCWEB%, %&lt;nop&gt;MAINWEB% and %&lt;nop&gt;TWIKIWEB% can be used in the input to represent the web names set in $cfg{UsersWebName} and $cfg{SystemWebName}. For example:
| *Input*                               | *Return* |
| &lt;tt&gt;( &#39;%&lt;nop&gt;USERSWEB%&#39;, &#39;Topic&#39; )&lt;/tt&gt;     | &lt;tt&gt;( &#39;Main&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;%&lt;nop&gt;SYSTEMWEB%&#39;, &#39;Topic&#39; )&lt;/tt&gt;    | &lt;tt&gt;( &#39;TWiki&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |
| &lt;tt&gt;( &#39;&#39;, &#39;%&lt;nop&gt;DOCWEB%.Topic&#39; )&lt;/tt&gt;    | &lt;tt&gt;( &#39;TWiki&#39;, &#39;Topic&#39; ) &lt;/tt&gt;  |

=cut</pre></td></tr>
<tr><td class="h">2091</td><td colspan="6"></td></tr><tr><td class="h">2092</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub normalizeWebTopicName {</td></tr>
<tr><td class="h">2093</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;#my( $web, $topic ) = @_;</td></tr>
<tr><td class="h">2094</td><td><div class="c3">1</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2094">1</a></div></td><td><div>2</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">2095</td><td><div class="c3">1</div></td><td></td><td></td><td></td><td><div>5</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;normalizeWebTopicName( @_ );</td></tr>
<tr><td class="h">2096</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2097</td><td colspan="6"></td></tr><tr><td class="h">2098 - 2108</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ writeWarning( $text )

Log Warning that may require admin intervention to data/warning.txt
   * =$text= - Text to write; timestamp gets added
Return:            none

*Since:* TWiki::Plugins::VERSION 1.020 (16 Feb 2004)

=cut</pre></td></tr>
<tr><td class="h">2109</td><td colspan="6"></td></tr><tr><td class="h">2110</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub writeWarning {</td></tr>
<tr><td class="h">2111</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $text ) = @_;</td></tr>
<tr><td class="h">2112</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2112">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">2113</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ($message)=@_;</td></tr>
<tr><td class="h">2114</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;writeWarning( &quot;(&quot;.caller().&quot;) &quot;.$message );</td></tr>
<tr><td class="h">2115</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2116</td><td colspan="6"></td></tr><tr><td class="h">2117 - 2127</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ writeDebug( $text )

Log debug message to data/debug.txt
   * =$text= - Text to write; timestamp gets added
Return:            none

*Since:* TWiki::Plugins::VERSION 1.020 (16 Feb 2004)

=cut</pre></td></tr>
<tr><td class="h">2128</td><td colspan="6"></td></tr><tr><td class="h">2129</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub writeDebug {</td></tr>
<tr><td class="h">2130</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my( $text ) = @_;</td></tr>
<tr><td class="h">2131</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2131">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">2132</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;writeDebug( @_ );</td></tr>
<tr><td class="h">2133</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2134</td><td colspan="6"></td></tr><tr><td class="h">2135 - 2148</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ formatTime( $time, $format, $timezone ) -&gt; $text

Format the time in seconds into the desired time string
   * =$time=     - Time in epoc seconds
   * =$format=   - Format type, optional. Default e.g. =&#39;31 Dec 2002 - 19:30&#39;=. Can be =&#39;$iso&#39;= (e.g. =&#39;2002-12-31T19:30Z&#39;=), =&#39;$rcs&#39;= (e.g. =&#39;2001/12/31 23:59:59&#39;=, =&#39;$http&#39;= for HTTP header format (e.g. =&#39;Thu, 23 Jul 1998 07:21:56 GMT&#39;=), or any string with tokens =&#39;$seconds, $minutes, $hours, $day, $wday, $month, $mo, $year, $ye, $tz&#39;= for seconds, minutes, hours, day of month, day of week, 3 letter month, 2 digit month, 4 digit year, 2 digit year, timezone string, respectively
   * =$timezone= - either not defined (uses the displaytime setting), &#39;gmtime&#39;, or &#39;servertime&#39;
Return: =$text=        Formatted time string
| Note:                  | if you used the removed formatGmTime, add a third parameter &#39;gmtime&#39; |

*Since:* TWiki::Plugins::VERSION 1.020 (26 Feb 2004)

=cut</pre></td></tr>
<tr><td class="h">2149</td><td colspan="6"></td></tr><tr><td class="h">2150</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub formatTime {</td></tr>
<tr><td class="h">2151</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my ( $epSecs, $format, $timezone ) = @_;</td></tr>
<tr><td class="h">2152</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2152">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return TWiki::Time::formatTime( @_ );</td></tr>
<tr><td class="h">2153</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2154</td><td colspan="6"></td></tr><tr><td class="h">2155 - 2164</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ isValidWikiWord ( $text ) -&gt; $boolean

Check for a valid WikiWord or WikiName
   * =$text= - Word to test

*Since:* TWiki::Plugins::VERSION 1.100 (Dec 2005)

=cut</pre></td></tr>
<tr><td class="h">2165</td><td colspan="6"></td></tr><tr><td class="h">2166</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub isValidWikiWord {</td></tr>
<tr><td class="h">2167</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2167">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;return TWiki::isValidWikiWord(@_);</td></tr>
<tr><td class="h">2168</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2169</td><td colspan="6"></td></tr><tr><td class="h">2170 - 2190</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ extractParameters($attr ) -&gt; %params

Extract all parameters from a variable string and returns a hash of parameters
   * =$attr= - Attribute string
Return: =%params=  Hash containing all parameters. The nameless parameter is stored in key =_DEFAULT=

*Since:* TWiki::Plugins::VERSION 1.025 (26 Aug 2004)

   * Example:
      * Variable: =%&lt;nop&gt;TEST{ &#39;nameless&#39; name1=&quot;val1&quot; name2=&quot;val2&quot; }%=
      * First extract text between ={...}= to get: =&#39;nameless&#39; name1=&quot;val1&quot; name2=&quot;val2&quot;=
      * Then call this on the text: &lt;br /&gt;
   * params = TWiki::Func::extractParameters( $text );=
      * The =%params= hash contains now: &lt;br /&gt;
        =_DEFAULT =&gt; &#39;nameless&#39;= &lt;br /&gt;
        =name1 =&gt; &quot;val1&quot;= &lt;br /&gt;
        =name2 =&gt; &quot;val2&quot;=

=cut</pre></td></tr>
<tr><td class="h">2191</td><td colspan="6"></td></tr><tr><td class="h">2192</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub extractParameters {</td></tr>
<tr><td class="h">2193</td><td><div class="c3">63</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2193">63</a></div></td><td><div>209</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my( $attr ) = @_;</td></tr>
<tr><td class="h">2194</td><td><div class="c3">63</div></td><td></td><td></td><td></td><td><div>356</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $params = new TWiki::Attrs( $attr );</td></tr>
<tr><td class="h">2195</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# take out _RAW and _ERROR (compatibility)</td></tr>
<tr><td class="h">2196</td><td><div class="c3">63</div></td><td></td><td></td><td></td><td><div>247</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;delete $params-&gt;{_RAW};</td></tr>
<tr><td class="h">2197</td><td><div class="c3">63</div></td><td></td><td></td><td></td><td><div>174</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;delete $params-&gt;{_ERROR};</td></tr>
<tr><td class="h">2198</td><td><div class="c3">63</div></td><td></td><td></td><td></td><td><div>662</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return %$params;</td></tr>
<tr><td class="h">2199</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2200</td><td colspan="6"></td></tr><tr><td class="h">2201 - 2221</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ extractNameValuePair( $attr, $name ) -&gt; $value

Extract a named or unnamed value from a variable parameter string
- Note:              | Function TWiki::Func::extractParameters is more efficient for extracting several parameters
   * =$attr= - Attribute string
   * =$name= - Name, optional
Return: =$value=   Extracted value

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

   * Example:
      * Variable: =%&lt;nop&gt;TEST{ &#39;nameless&#39; name1=&quot;val1&quot; name2=&quot;val2&quot; }%=
      * First extract text between ={...}= to get: =&#39;nameless&#39; name1=&quot;val1&quot; name2=&quot;val2&quot;=
      * Then call this on the text: &lt;br /&gt;
        =my $noname = TWiki::Func::extractNameValuePair( $text );= &lt;br /&gt;
        =my $val1  = TWiki::Func::extractNameValuePair( $text, &quot;name1&quot; );= &lt;br /&gt;
        =my $val2  = TWiki::Func::extractNameValuePair( $text, &quot;name2&quot; );=

=cut</pre></td></tr>
<tr><td class="h">2222</td><td colspan="6"></td></tr><tr><td class="h">2223</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub extractNameValuePair {</td></tr>
<tr><td class="h">2224</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2224">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return TWiki::Attrs::extractValue( @_ );</td></tr>
<tr><td class="h">2225</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2226</td><td colspan="6"></td></tr><tr><td class="h">2227 - 2260</td><td colspan="5"></td><td class="s"><pre>=pod

---++ Deprecated functions

From time-to-time, the TWiki developers will add new functions to the interface (either to TWikiFuncDotPm, or new handlers). Sometimes these improvements mean that old functions have to be deprecated to keep the code manageable. When this happens, the deprecated functions will be supported in the interface for at least one more TWiki release, and probably longer, though this cannot be guaranteed.

Updated plugins may still need to define deprecated handlers for compatibility with old TWiki versions. In this case, the plugin package that defines old handlers can suppress the warnings in %&lt;nop&gt;FAILEDPLUGINS%.

This is done by defining a map from the handler name to the =TWiki::Plugins= version _in which the handler was first deprecated_. For example, if we need to define the =endRenderingHandler= for compatibility with =TWiki::Plugins= versions before 1.1, we would add this to the plugin:
&lt;verbatim&gt;
package TWiki::Plugins::SinkPlugin;
use vars qw( %TWikiCompatibility );
$TWikiCompatibility{endRenderingHandler} = 1.1;
&lt;/verbatim&gt;
If the currently-running TWiki version is 1.1 _or later_, then the _handler will not be called_ and _the warning will not be issued_. TWiki with versions of =TWiki::Plugins= before 1.1 will still call the handler as required.

The following functions are retained for compatibility only. You should
stop using them as soon as possible.

---+++ getScriptUrlPath( ) -&gt; $path

Get script URL path

*DEPRECATED* since 1.1 - use =getScriptUrl= instead.

Return: =$path= URL path of TWiki scripts, e.g. =&quot;/cgi-bin&quot;=

*WARNING:* you are strongly recommended *not* to use this function, as the
{ScriptUrlPaths} URL rewriting rules will not apply to urls generated
using it.

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">2261</td><td colspan="6"></td></tr><tr><td class="h">2262</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getScriptUrlPath {</td></tr>
<tr><td class="h">2263</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2263">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">2264</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;getScriptUrl( 0, &#39;&#39; );</td></tr>
<tr><td class="h">2265</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2266</td><td colspan="6"></td></tr><tr><td class="h">2267 - 2279</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPublicWebList( ) -&gt; @webs

*DEPRECATED* since 1.1 - use =getListOfWebs= instead.

Get list of all public webs, e.g. all webs that do not have the =NOSEARCHALL= flag set in the WebPreferences

Return: =@webs= List of all public webs, e.g. =( &#39;Main&#39;,  &#39;Know&#39;, &#39;TWiki&#39; )=

*Since:* TWiki::Plugins::VERSION 1.000 (07 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">2280</td><td colspan="6"></td></tr><tr><td class="h">2281</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPublicWebList {</td></tr>
<tr><td class="h">2282</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2282">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;ASSERT($TWiki::Plugins::SESSION) if DEBUG;</td></tr>
<tr><td class="h">2283</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::Plugins::SESSION-&gt;{store}-&gt;getListOfWebs(&quot;user,public&quot;);</td></tr>
<tr><td class="h">2284</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2285</td><td colspan="6"></td></tr><tr><td class="h">2286 - 2299</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ formatGmTime( $time, $format ) -&gt; $text

*DEPRECATED* since 1.1 - use =formatTime= instead.

Format the time to GM time
   * =$time=   - Time in epoc seconds
   * =$format= - Format type, optional. Default e.g. =&#39;31 Dec 2002 - 19:30&#39;=, can be =&#39;iso&#39;= (e.g. =&#39;2002-12-31T19:30Z&#39;=), =&#39;rcs&#39;= (e.g. =&#39;2001/12/31 23:59:59&#39;=, =&#39;http&#39;= for HTTP header format (e.g. =&#39;Thu, 23 Jul 1998 07:21:56 GMT&#39;=)
Return: =$text=      Formatted time string

*Since:* TWiki::Plugins::VERSION 1.000 (7 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">2300</td><td colspan="6"></td></tr><tr><td class="h">2301</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub formatGmTime {</td></tr>
<tr><td class="h">2302</td><td></td><td></td><td></td><td></td><td></td><td class="s">#   my ( $epSecs, $format ) = @_;</td></tr>
<tr><td class="h">2303</td><td colspan="6"></td></tr><tr><td class="h">2304</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;# FIXME: Write warning based on flag (disabled for now); indicate who is calling this function</td></tr>
<tr><td class="h">2305</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;## writeWarning( &#39;deprecated use of Func::formatGmTime&#39; );</td></tr>
<tr><td class="h">2306</td><td colspan="6"></td></tr><tr><td class="h">2307</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2307">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return TWiki::Time::formatTime( @_, &#39;gmtime&#39; );</td></tr>
<tr><td class="h">2308</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2309</td><td colspan="6"></td></tr><tr><td class="h">2310 - 2324</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getDataDir( ) -&gt; $dir

*DEPRECATED* since 1.1 - use the &quot;Webs, Topics and Attachments&quot; functions to manipulate topics instead

Get data directory (topic file root)

Return: =$dir= Data directory, e.g. =&#39;/twiki/data&#39;=

This function violates store encapsulation and is therefore *deprecated*.

*Since:* TWiki::Plugins::VERSION 1.000 (07 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">2325</td><td colspan="6"></td></tr><tr><td class="h">2326</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getDataDir {</td></tr>
<tr><td class="h">2327</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2327">0</a></div></td><td><div>0</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{DataDir};</td></tr>
<tr><td class="h">2328</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2329</td><td colspan="6"></td></tr><tr><td class="h">2330 - 2346</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ getPubDir( ) -&gt; $dir

*DEPRECATED* since 1.1 - use the &quot;Webs, Topics and Attachments&quot; functions to manipulateattachments instead

Get pub directory (file attachment root). Attachments are in =$dir/Web/TopicName=

Return: =$dir= Pub directory, e.g. =&#39;/htdocs/twiki/pub&#39;=

This function violates store encapsulation and is therefore *deprecated*.

Use =readAttachment= and =saveAttachment= instead.

*Since:* TWiki::Plugins::VERSION 1.000 (07 Dec 2002)

=cut</pre></td></tr>
<tr><td class="h">2347</td><td colspan="6"></td></tr><tr><td class="h">2348</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub getPubDir {</td></tr>
<tr><td class="h">2349</td><td><div class="c3">41</div></td><td></td><td></td><td><div class="c3"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2349">41</a></div></td><td><div>270</div></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $TWiki::cfg{PubDir};</td></tr>
<tr><td class="h">2350</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2351</td><td colspan="6"></td></tr><tr><td class="h">2352 - 2361</td><td colspan="5"></td><td class="s"><pre>=pod

---+++ checkDependencies( $moduleName, $dependenciesRef ) -&gt; $error

*DEPRECATED* since 1.1 - use TWiki:Plugins.BuildContrib and define DEPENDENCIES that can be statically
evaluated at install time instead. It is a lot more efficient.

*Since:* TWiki::Plugins::VERSION 1.025 (01 Aug 2004)

=cut</pre></td></tr>
<tr><td class="h">2362</td><td colspan="6"></td></tr><tr><td class="h">2363</td><td></td><td></td><td></td><td></td><td></td><td class="s">sub checkDependencies {</td></tr>
<tr><td class="h">2364</td><td><div class="c0">0</div></td><td></td><td></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--subroutine.html#L2364">0</a></div></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my ( $context, $deps ) = @_;</td></tr>
<tr><td class="h">2365</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $report = &#39;&#39;;</td></tr>
<tr><td class="h">2366</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;my $depsOK = 1;</td></tr>
<tr><td class="h">2367</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;foreach my $dep ( @$deps ) {</td></tr>
<tr><td class="h">2368</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my ( $ok, $ver ) = ( 1, 0 );</td></tr>
<tr><td class="h">2369</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $msg = &#39;&#39;;</td></tr>
<tr><td class="h">2370</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;my $const = &#39;&#39;;</td></tr>
<tr><td class="h">2371</td><td colspan="6"></td></tr><tr><td class="h">2372</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;use $dep-&gt;{package}&quot;;</td></tr>
<tr><td class="h">2373</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L2373">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $@ ) {</td></tr>
<tr><td class="h">2374</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= &quot;it could not be found: $@&quot;;</td></tr>
<tr><td class="h">2375</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok = 0;</td></tr>
<tr><td class="h">2376</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">2377</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L2377">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( defined( $dep-&gt;{constraint} ) ) {</td></tr>
<tr><td class="h">2378</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$const = $dep-&gt;{constraint};</td></tr>
<tr><td class="h">2379</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;\$ver = \$$dep-&gt;{package}::VERSION;&quot;;</td></tr>
<tr><td class="h">2380</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L2380">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $@ ) {</td></tr>
<tr><td class="h">2381</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= &quot;the VERSION of the package could not be found: $@&quot;;</td></tr>
<tr><td class="h">2382</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok = 0;</td></tr>
<tr><td class="h">2383</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;} else {</td></tr>
<tr><td class="h">2384</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;eval &quot;\$ok = ( \$ver $const )&quot;;</td></tr>
<tr><td class="h">2385</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L2385">0</a></div></td><td><div class="c0"><a href="-usr-share-perl5-TWiki-Func-pm--condition.html#L2385">0</a></div></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if ( $@ || ! $ok ) {</td></tr>
<tr><td class="h">2386</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$msg .= &quot; $ver is currently installed: $@&quot;;</td></tr>
<tr><td class="h">2387</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$ok = 0;</td></tr>
<tr><td class="h">2388</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2389</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2390</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2391</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2392</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L2392">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;unless ( $ok ) {</td></tr>
<tr><td class="h">2393</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$report .= &quot;WARNING: $dep-&gt;{package}$const is required for $context, but $msg\n&quot;;</td></tr>
<tr><td class="h">2394</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$depsOK = 0;</td></tr>
<tr><td class="h">2395</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2396</td><td></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;}</td></tr>
<tr><td class="h">2397</td><td><div class="c0">0</div></td><td><div class="c0" title="-/-"><a href="-usr-share-perl5-TWiki-Func-pm--branch.html#L2397">0</a></div></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return undef if( $depsOK );</td></tr>
<tr><td class="h">2398</td><td colspan="6"></td></tr><tr><td class="h">2399</td><td><div class="c0">0</div></td><td></td><td></td><td></td><td></td><td class="s">&nbsp;&nbsp;&nbsp;&nbsp;return $report;</td></tr>
<tr><td class="h">2400</td><td></td><td></td><td></td><td></td><td></td><td class="s">}</td></tr>
<tr><td class="h">2401</td><td colspan="6"></td></tr><tr><td class="h">2402</td><td></td><td></td><td></td><td></td><td></td><td class="s">1;</td></tr>
<tr><td class="h">2403</td><td colspan="6"></td></tr><tr><td class="h">2404</td><td></td><td></td><td></td><td></td><td></td><td class="s"># EOF</td></tr>
</table>
</body>
</html>
