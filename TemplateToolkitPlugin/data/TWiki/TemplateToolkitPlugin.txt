%META:TOPICINFO{author="TWikiContributor" date="1111929255" format="1.0" version="$Rev: 11354 $"}%
---+ Template Toolkit Plugin

This is a rather slim glue to Andy Wardley's Template Toolkit
(see http://www.template-toolkit.org/ or TWiki:Codev.TemplateToolkit
for more, though the latter is pretty stale).

I myself have here and then argued that TT is too heavyweight for use
in a TWiki, but this does only prevent using TT as the _only_
template system for TWiki.

If, on the other hand, you _do_ have TT installed anyway, and
especially if you have it running in a mod_perl environment where
module compilation time is no longer an issue, then you might want to
share TT blocks or layouts with TWiki.

Currently, the implementation as a plugin does not allow to install TT
as a drop-in replacement for TWiki's own templating system.  But I
think that for first experiments it is possible to emulate that by
using very slim TWiki templates to get TWiki's template system out of
the way and instead run your topics through TT with a
=preRenderingHandler=.

To be honest, I am using this plugin as both a first step to evaluate TT as a
TWiki template machine, and as a real-life hands-on example for
BenchmarkContrib to play with.

---++ Syntax Rules

The plugin has just one TWiki tag in the TWiki sense:

%STARTSECTION{"VarTEMPLATETOOLKIT"}%
   * Syntax: =%<nop>TEMPLATETOOLKIT{"on"}%= or =%<nop>TEMPLATETOOLKIT{"off"}%=
   * If present at the top of a topic with a value of ="on"=, the whole topic will be
     processed by TT.
   * A configuration variable named
     =$TWiki::cfg{Plugins}{TemplateToolkitPlugin}{UseTT}= can be used
     to set a site-wide default
   * Verbatim blocks are excluded from processing by TT
%ENDSECTION{"VarTEMPLATETOOLKIT"}%

---+++ A Note on Template Toolkit Syntax

If you are familiar with the Template Toolkit, then you surely know
that it per default embeds its directives between the delimiters =[%=
and =%]=.  As almost everything in TT, this is configurable, but the
default delimiters usually don't occur.  _Usually_.  In TWiki, there
is a syntax construction which is quite popular, but makes TT croak:
Forced links, with an embedded TWiki variable.  Example:
<verbatim>
[[%TWIKIWEB%.%STATISTICSTOPIC%]]
</verbatim>
This is a valid TWiki link pointing to
[[%TWIKIWEB%.%STATISTICSTOPIC%]], but an invalid TT construct
=[% TWIKIWEB%.%STATISTICSTOPIC %]= within an additional set of square
brackets

This plugin tries hardly to cope with this, so the above example will
work as intended.  Some recommendations, just in case:
   * It is good practice to write your TT constructs as =[% tt_directive %]=,
     i.e. with surrounding spaces around directives.  By doing so,
     you'll make sure to never clash with a possible TWiki variable named
     =%<nop>tt_directive%=.
   * Separate TT stuff from heavy TWiki lifting or you'll get severe bracketiquotitis.

---++ Configuration Variables

Yet undocumented, until I figure out how %SCRIPTURL{configure}% will
pick up plugin configuration vars :-)

---++ Future Directions

If time permits, I'll try to:
   * create a TWiki skin and a TT layout in parallel and run
     benchmarks on both.
   * document (and extend) configuration items
   * ...

---++ Plugin Installation Instructions

   * Download the ZIP file from the Plugin web (see below)
   * Unzip ==%TOPIC%.zip== in your twiki installation directory. Content:
     | *File:* | *Description:* |
%$MANIFEST%
   * Run ==%TOPIC%_installer.pl== to automatically check and install other modules that this module depends on. You can also do this step manually. Dependencies:
   %$DEPENDENCIES%
   * Test if the installation was successful:
      1 Enable the plugin using %SCRIPTURL{configure}%
      2 Create a topic in the Sandbox.WebHome web containing the
        following snippet: %BR%
        =%<nop>TEMPLATETOOLKIT{"on"}% [% text = 'test' %] [% text %]=
      3 If the installation was successful, then on save the topic
        should contain only the word 'test'

---++ Plugin Info

|  Author: | TWiki:Main/HaraldJoerg |
|  Copyright &copy;: | 2006, TWiki:Main/HaraldJoerg, All Rights Reserved |
|  License: | GPL ([[http://www.gnu.org/copyleft/gpl.html][GNU General Public License]]) |
|  TWiki Dependency: | $TWiki::Plugins::VERSION 1.1 |
|  Dependencies: | %$DEPENDENCIES% |
|  Other Dependencies: | none |
|  Perl Version: | 5.8 |
|  Version: | %$VERSION% |
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
|  21 Sep 2006: | Initial version |
|  TWiki:Plugins/Benchmark: | unknown |
|  Home: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC% |
|  Feedback: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev |
|  Appraisal: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal |

__Related Topics:__ %TWIKIWEB%.TWikiPlugins, %TWIKIWEB%.DeveloperDocumentationCategory, %TWIKIWEB%.AdminDocumentationCategory, %TWIKIWEB%.TWikiPreferences

-- TWiki:Main.HaraldJoerg - 21 Sep 2006
