var twiki;if(twiki==undefined){twiki={};}twiki.AjaxRequest=function(){var _1=this;var _2={};var _3=function(_4){this.name=_4;this.url;this.response;this.lockedProperties={};this.handler="_writeHtml";this.scope=twiki.AjaxRequest.getInstance();this.container;this.type="txt";this.cache=false;this.method="GET";this.postData;this.indicator;this.failHandler="_defaultFailHandler";this.failScope=twiki.AjaxRequest.getInstance();this.owner=twiki.AjaxRequest.getInstance();};_3.prototype.isXml=function(){return this.type=="xml";};_3.prototype.toString=function(){return "name="+this.name+"; handler="+this.handler+"; scope="+this.scope.toString()+"; container="+this.container+"; url="+this.url+"; type="+this.type+"; cache="+this.cache+"; method="+this.method+"; postData="+this.postData+"; indicator="+this.indicator+"; response="+this.response;};function _getIndicatorId(_5){return "twikiRequestIndicator"+_5;}function _wrapIndicator(_6,_7){return "<div style=\"display:inline;\" id=\""+_getIndicatorId(_6)+"\">"+_7+"</div>";}function _hideLoadingIndicator(_8){twikiajaxcontrib.HTML.clearElementWithId(_getIndicatorId(_8));}function _storeProperty(_9,_a,_b){if(_b==undefined){return;}if(_9.lockedProperties[_a]){return;}_9[_a]=_b;}function _referenceForResponse(_c){for(var i in _2){var _e=_2[i].response;if(_e&&_e.tId==_c.tId){return _2[i];}}return null;}this._load=function(_f,_10){var ref=this._storeResponseProperties(_f,_10);this._stop(_f);if(ref.store){return this._writeHtml(ref.container,ref.store);}if(ref.scope==undefined){alert("twiki.AjaxRequest._load: no scope given for function "+ref.handler);return;}var _12=null;if(ref.indicator!=null){_12=ref.indicator;}if(_12==null){_12=this._defaultIndicatorHtml;}var _13=_wrapIndicator(_f,_12);twikiajaxcontrib.HTML.updateElementWithId(ref.container,_13);var _14=(ref.cache!=undefined)?ref.cache:false;var _15={success:this._handleSuccess,failure:this._handleFailure,argument:{container:ref.container,cache:ref.cache}};var _16=(ref.method!=undefined)?ref.method:"GET";var _17=(ref.postData!=undefined)?ref.postData:"";var _18=YAHOO.util.Connect.asyncRequest(_16,ref.url,_15,_17);this._storeResponseProperties(_f,{response:_18});return _18;};this._storeResponseProperties=function(_19,_1a){var ref=_2[_19];if(!ref){ref=new _3(_19);}if(!_1a){_2[_19]=ref;return ref;}_storeProperty(ref,"url",_1a.url);_storeProperty(ref,"response",_1a.response);_storeProperty(ref,"handler",_1a.handler);_storeProperty(ref,"scope",_1a.scope);_storeProperty(ref,"container",_1a.container);_storeProperty(ref,"type",_1a.type);_storeProperty(ref,"cache",_1a.cache);_storeProperty(ref,"method",_1a.method);_storeProperty(ref,"postData",_1a.postData);_storeProperty(ref,"indicator",_1a.indicator);_storeProperty(ref,"failHandler",_1a.failHandler);_storeProperty(ref,"failScope",_1a.failScope);_2[_19]=ref;return ref;};this._lockProperties=function(_1c,_1d){if(!_1d||_1d.length==0){return;}var ref=_2[_1c];if(!ref){return;}var i,ilen=_1d.length;for(i=0;i<ilen;i++){var _20=_1d[i];ref.lockedProperties[_20]=true;}};this._releaseProperties=function(_21,_22){if(!_22||_22.length==0){return;}var ref=_2[_21];if(!ref){return;}var i,ilen=_22.length;for(i=0;i<ilen;i++){var _25=_22[i];delete ref.lockedProperties[_25];}};this._stop=function(_26){var ref=_2[_26];_hideLoadingIndicator(_26);if(ref&&ref.response){YAHOO.util.Connect.abort(ref.response);}};this._handleSuccess=function(_28){if(_28.responseText!==undefined){var ref=_referenceForResponse(_28);_hideLoadingIndicator(ref.name);var _2a=(ref.isXml())?_28.responseXML:_28.responseText;var _2b=ref.scope[ref.handler].apply(ref.scope,[_28.argument.container,_2a]);var _2c=false;if(_28.argument.cache==true){_2c=true;}if(_28.argument.cache==false){_2c=false;}if(_2c){_1._storeHtml(ref.name,_2b);}}};this._handleFailure=function(_2d){var ref=_referenceForResponse(_2d);ref.owner._stop(ref.name);var _2f=ref.failScope[ref.failHandler].apply(ref.failScope,[ref.name,_2d.status]);};this._defaultFailHandler=function(_30,_31){alert("Could not load request for "+_30+" because of (error status): "+_31);};this._storeHtml=function(_32,_33){var ref=_2[_32];ref.store=_33;};this._writeHtml=function(_35,_36){var _37=twikiajaxcontrib.HTML.updateElementWithId(_35,_36);return twikiajaxcontrib.HTML.getHtmlOfElementWithId(_35);};this._defaultIndicatorHtml="<img src='indicator.gif' alt='' />";this._setDefaultIndicatorHtml=function(_38){if(!_38){return;}this._defaultIndicatorHtml=_38;};};twiki.AjaxRequest.__instance__=null;twiki.AjaxRequest.getInstance=function(){if(this.__instance__==null){this.__instance__=new twiki.AjaxRequest();}return this.__instance__;};twiki.AjaxRequest.setProperties=function(_39,_3a){twiki.AjaxRequest.getInstance()._storeResponseProperties(_39,_3a);};twiki.AjaxRequest.lockProperties=function(_3b){var _3c=twiki.Array.convertArgumentsToArray(arguments,1);if(!_3c){return;}twiki.AjaxRequest.getInstance()._lockProperties(_3b,_3c);};twiki.AjaxRequest.releaseProperties=function(_3d,_3e){var _3f=twiki.Array.convertArgumentsToArray(arguments,1);if(!_3f){return;}twiki.AjaxRequest.getInstance()._releaseProperties(_3d,_3f);};twiki.AjaxRequest.clearCache=function(_40){twiki.AjaxRequest.getInstance()._storeHtml(_40,null);};twiki.AjaxRequest.load=function(_41,_42){return twiki.AjaxRequest.getInstance()._load(_41,_42);};twiki.AjaxRequest.stop=function(_43){twiki.AjaxRequest.getInstance()._stop();};twiki.AjaxRequest.getDefaultIndicatorHtml=function(){return twiki.AjaxRequest.getInstance()._defaultIndicatorHtml;};twiki.AjaxRequest.setDefaultIndicatorHtml=function(_44){return twiki.AjaxRequest.getInstance()._setDefaultIndicatorHtml(_44);};twikiajaxcontrib={};twikiajaxcontrib.HTML={updateElementWithId:function(_45,_46){var _47=document.getElementById(_45);if(_47){return twikiajaxcontrib.HTML.updateElement(_47,_46);}},updateElement:function(_48,_49){if(_48){if(_49==""){twikiajaxcontrib.HTML.clearElement(_48);}else{_48.innerHTML=_49;}return _48;}},getHtmlOfElementWithId:function(_4a){var _4b=document.getElementById(_4a);if(_4b){return _4b.innerHTML;}},getHtmlOfElement:function(_4c){if(_4c){return _4c.innerHTML;}},clearElementWithId:function(_4d){var _4e=document.getElementById(_4d);if(_4e){return twikiajaxcontrib.HTML.clearElement(_4e);}},clearElement:function(_4f){if(_4f){while(_4f.hasChildNodes()){_4f.removeChild(_4f.firstChild);}return _4f;}},setNodeStylesInList:function(_50,_51){if(!_50){return;}var i,ilen=_50.length;for(i=0;i<ilen;++i){var _53=_50[i];for(var _54 in _51){_53.style[_54]=_51[_54];}}}};