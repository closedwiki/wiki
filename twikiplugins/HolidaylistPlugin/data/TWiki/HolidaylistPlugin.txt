%META:TOPICINFO{author="rohdedan" date="1121092319" format="1.0" version="1.25"}%
---+!! <nop>HolidaylistPlugin</nop>

%TOC%

The !HolidaylistPlugin handles the tag %<nop>HOLIDAYLIST</nop>% that inserts a vacation list on the current page. Smilies are used to indicate if a person is in work or on holiday. 

The plugin creates a table filled with Smilies and today's date will be the first column. There is a row in the table for each person and each day is flagged as either: :mad: (in work), :ok: (a day off) or 8-) (absent for some time), :-I (not at work; used if you type a location). You can also use other smilies (like :skull:).

*Example (image):*

<img src="%ATTACHURLPATH%/example.gif" alt="Example" title="Example" width="779" height="172"  />

---++ Usage Examples

To insert vacations into the table, create a bullet list. Three spaces and then a *.

The syntax is described below ([[#SyntaX][Syntax]]).

Example1: To list that John will be away on 1-July-2005
<verbatim>
	* 01 Jul 2005 - John
</verbatim>
Example2: To list that Mary will be away from 3-Sep - 9-Sep 2005
<verbatim>
	* 03 Sep 2005 - 09 Sep 2005 - Mary 
</verbatim>
Example3: To list that Jill will be in Paris from 10-Sep - 11-Sep 2005 and in Tokyo on 15 Sep 2005
<verbatim>
	* 10 Sep 2005 - 11 Sep 2005 - Jill - Paris

	* 15 Sep 2005 - Jill - Tokyo
</verbatim>
Example4: To list that Eve will be ill from 12-Sep - 20-Sep 2005  with her's own 'smily'
<verbatim>
	* 12 Sep 2005 - 20 Sep 2005 - Eve - is ill - :scull:
</verbatim>
Example5: To list that Lisa will by not at work from April to June and the complete December 2005:
<verbatim>
	* Apr 2005 - Jun 2005 - Lisa
	* Dec 2005 - Lisa
</verbatim>

Example6: There are several attributes (see [[#AttriButes][Attributes]]) like =days= (defaults to 30days) and =tablecaption= (defaults to null). 

=%<nop>HOLIDAYLIST{days="90" tablecaption="Planned Holidays"}</nop>%=

#SyntaX
---++ Syntax
The syntax follows that of the !CalendarPlugin. See TWiki:Plugins.CalendarPlugin for more details.



| *Entry type* | *Syntax* | *Example* |
| Single entry | ==&nbsp;* dd MMM yyyy - name== | ==&nbsp;* 01 Jul 2005 - Jane== |
|^| ==&nbsp;* dd MMM yyyy - name - location== | ==&nbsp;* 01 Jul 2005 - Sarah - in Paris== |
|^| ==&nbsp;* dd MMM yyyy - name - location - icon== | ==&nbsp;* 01 Jul 2005 - Eve - ill - :scull:== |
| Interval entry | ==&nbsp;* dd MMM yyyy - dd MMM yyyy - name== | ==&nbsp;* 01 Aug 2005 - 22 Aug 2005 - !EvaMaria== |
|^| ==&nbsp;* dd MMM yyyy - dd MMM yyyy - name - location== | ==&nbsp;* 02 Sep 2005 - 10 Sep 2005 - !JohnDo - in London== |
|^| ==&nbsp;* dd MMM yyyy - dd MMM yyyy - name - location - icon== | ==&nbsp;* 02 Oct 2005 - 22 Oct 2005 - Fred - is ill - :scull:== |
|^| ==&nbsp;* MMM yyyy - name== | ==&nbsp;* May 2005 - Carl== |
|^| ==&nbsp;* MMM yyyy - name - location== | ==&nbsp;* Jun 2005 - Sam - in Sidney== | 
|^| ==&nbsp;* MMM yyyy - name - location - icon== | ==&nbsp;* Nov 2005 - Lisa - is ill for a complete month - :scull:== |
|^| ==&nbsp;* MMM yyyy - MMM yyyy - name== | ==&nbsp;* Jun 2005 - Jul 2005 - Lily== |
|^| ==&nbsp;* MMM yyyy - MMM yyyy - name -location== | ==&nbsp;* Feb 2005 - Apr 2005 - Lisa - is not at work==|
|^| ==&nbsp;* MMM yyyy - MMM yyyy - name - location - icon==| ==&nbsp;* Nov 2005 - Dec 2005 - Lola - is 2 month not at work - :yes:== |
| Exception | insert the following before the name field and after a date (range): \
  ==&nbsp;X { dd MMM yyyy, dd MMM yyy - dd MMM yyyy }== | ==&nbsp;* Dec 2005 X { 5 Dec 2005 - 7 Dec 2005, 12 Dec 2005 } - Sarah - will be away for the complete december except between 5 Dec and 7 Dec and on 12 Dec 2005== |


*Notes and Hints:*
	* At least one space character have to stay before and after a seperator ('-'). This allows you to use a '-' in names, locations or icons,
	  e.g. if you have a composite name like Eva-Maria.
	* If you enable the compatmode (see [[#AttriButes][Attributes]]) you can use all event types of the TWiki:Plugins.CalendarPlugin
	* If you change the default language ('lang' attribute; see [[#AttriButes][Attributes]]) you can use your language specific month and day names or the abbriviations for any entry type (including TWiki:Plugins.CalendarPlugin event types).
	* If you change the month names or day names ('monthnames' and 'daynames' attributes; see [[#AttriButes][Attributes]]) you can
	  use it for your entries (including TWiki:Plugins.CalendarPlugin event types).
	  

#AttriButes
---++ Attributes

| *Attribute* | *Comment* | *Default / Example* |
| adayofficon |a day off icon | adayofficon=":ok:" |
| border | table border | border="1" |
| cellpadding | table cell padding | cellpadding="1" |
| cellspacing | tabel cell spacing | cellspacing="0" |
| compatmode  | if set to "1" all TWiki:Plugins.CalendarPlugin event types are supported | compatmode="0" |
| compatmodeicon | icon used for TWiki:Plugins.CalendarPlugin event types (only used if compatmode is enabled) | compatmodeicon="8-)" |
| daynames | costum daynames (a list separated by a '&brvbar;' and starting on Monday) | daynames="M&brvbar;T&brvbar;W&brvbar;T&brvbar;F&brvbar;S&brvbar;S" |
| days | number of days to show |days="30" |
| headerformat | table header format of a day; a subset of strftime conversion specifiers is supported (only date not time specificiers; see manual page or TWiki:Codev.ConvergeDateTimeFormattingModels) | headerformat="&lt;font&nbsp;size=\"-2\">%b&lt;br/&gt;%a&lt;br/&gt;%e&lt;/font&gt;" |
| holidayicon | holiday icon | holidayicon="8-)" |
| lang | language | lang="English" |
| month | set a month (e.g. Jan, Feb ... or 01, 02, ... 12 ) or a month offset (e.g. +1, -2,...) *Note:* If you use this month attribute the days attribute will be ignored (days will be set to the duration of the month). | month="+1" |
| monthnames | costum month names (a list separated by '&brvbar;' and starting on January) | monthnames="J&brvbar;F&brvbar;M&brvbar;A&brvbar;M&brvbar;J&brvbar;J&brvbar;A&brvbar;S&brvbar;O&brvbar;N&brvbar;D" |
| name | header content of the first cell header |name="Name" |
| notatworkicon | not at work icon (only used if you type a location) | notatworkicon=":-I" |
| nwidth | cell width of the first column | nwidth="120px" |
| removeatwork | set to "1" to remove persons without calendar entries from table | removeatwork="0" |
| showweekends | show weekends if set to 1 | showweekends="0" |
| startdate | a start date (e.g. '1 Oct 2005') or a day offset (e.g. '10', '+30' or '-30') | startdate="+0" |
| tablebgcolor | table background color | tablebgcolor="white" |
| tablecaption | table caption | tablecaption="&amp;nbsp;" |
| tablecaptionalign | table caption alignment (top, bottom, left, right) | tablecaptionalign="top" |
| tableheadercolor | color of the table header | tableheadercolor="%<nop>WEBBGCOLOR%" |
| tcwidth | width of the icon table cells | tcwidth="33px" |
| todaybgcolor | background color for today cells (usefull if you use startdate attribute) | todaybgcolor="white" |
| todayfgcolor | foreground color for today cells (usefull for a dark todaybgcolor) | todayfgcolor="black" |
| topic | a comma separated list of source topics | topic="%<nop>TOPIC%" |
| weekendbgcolor | background color of weekend header and data table cells | weekendbgcolor="%<nop>WEBBGCOLOR%" |
| width | width of table in pixels or percent | width="100%" |
| workicon | in work icon | workicon="&amp;nbsp;" |
| year | set a year (e.g. 2005, 2006 ...) or a year offset (e.g. +1, -1, ...) | year="0" |

*Hints:* 
	* You can use TWiki.TextFormattingRules for some attribute values: tablecaption, name, holidayicon, adayofficon, workicon, notatworkicon, compatmodeicon
	* Every attribute of %<nop>HOLIDAYLIST% can also be used as plugin setting. You only have to use capital letters.

---++ Example

%HOLIDAYLIST{startdate="1 Jun 2005"}%

	* 02 Jan 2005 - 28 Feb 2005 - Bill
	* 27 Mar 2005 - 20 Apr 2005 - Bob
	* 10 May 2005 - 01 Jun 2005 - Mary
	* 13 Jun 2005 - 12 Jun 2006 - Jill's Motherhood 
	* 08 Jun 2005 - Bill
	* 10 Jun 2005 - 15 Jun 2005 - Bob
	* 12 Jun 2005 - 14 Jun 2005 - Alice - Paris
	* 17 Jun 2005 - Bob - is ill - :scull:
	* 10 Jul 2005 - Mary
	* 20 Jul 2005 - 02 Sep 2005 - Bob
	* 15 Sep 2005 - 15 Oct 2005 - Mary
	* 30 Oct 2005 - Jane
	* 19 Nov 2005 - Bob
	* 29 Nov 2005 - 20 Dec 2005 - Bill
	* 25 Dec 2005 - Bob

---++ Plugin Settings

	* One line description, is shown in the %TWIKIWEB%.TextFormattingRules topic:
		* Set SHORTDESCRIPTION = Create a table with a list of people on holidays

	* Days to show (default: 30)
		* # Set DAYS = 30

	* Language (default: English - *see manuale page of Date::Calc perl module, e.g: English, Deutsch, Franais, Espaol, Nederlands, Dansk, suomi, ...). 
		* # Set LANG = Deutsch

	* Content of the first cell (default: Name):
		* # Set NAME = Name

	* Set work icon (default: &amp;nbsp; - old behavior: <verbatim>:mad:</verbatim>):
		* # Set WORKICON = :mad:

	* Set compatibility mode (default: 0; disables all TWiki:Plugins.CalendarPlugin event types) and icon (default: <verbatim>8-)</verbatim>)
		* # Set COMPATMODE = 1
		* # Set COMPATMODEICON = 8-)

	* Set unknown parameter message (default: <verbatim>%RED% Sorry, some parameters are unknown: %UNKNOWNPARAMSLIST% %ENDCOLOR% &lt;br/&gt; Allowed parameters are (see TWiki.HolidaylistPlugin topic for more details): %KNOWNPARAMSLIST%</verbatim>)
		* # Set UNKNOWNPARAMSMSG = %RED% Following parameter(s) is/are unknown: %UNKNOWNPARAMSLIST% %ENDCOLOR%
  
*Note:* Every attribute of %<nop>HOLIDAYLIST% can also be used as plugin setting. You only have to use capital letters.

---++ Plugin Installation Instructions
	
	* Install required CPAN modules (e.g. <verbatim>perl -MCPAN -e "install Date::Calc"</verbatim>)
	* Download the ZIP file from the Plugin web (see below)
	* Unzip ==%TOPIC%.zip== in your twiki installation directory. Content:
	  | *File:* | *Description:* |
	  | ==data/TWiki/%TOPIC%.txt== | Plugin topic |
	  | ==lib/TWiki/Plugins/%TOPIC%.pm== | Plugin Perl module |
	  | ==pub/TWiki/%TOPIC%/example.gif== | Example image |
	* Test if the plugin is correctly installed: Copy the example above into a new topic and change
	  the year number to the current year.


---++ Plugin Info

|  Plugin Author: | TWiki:Main.PeterJones, TWiki:Main.DanielRohde |
|  Plugin Version: | v1.011 (11 Jul 2005) |
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
|  v1.011 (11 Jul 2005) | improved performance; fixed major periodic repeater bug; added parameter check; fixed flag parameter handling; allowed language specific month and day names for entries; fixed minor repeater bugs; added new attributes: monthnames, daynames, width, unknownparamsmsg (TWiki:Main.DanielRohde) |
|  v1.010 (5 Jul 2005): | added exception handling; added compatibility mode (new attributes: compatmode, compatmodeicon) with full CalendarPlugin event type support; added documentation (TWiki:Main.DanielRohde) |
|  v1.009 (29 Jun 2005): | fixed major bug (!WikiNames and forced links in names) reported by TWiki:Main.KennethLavrsen; fixed documentation bugs; added INCLUDE expansion (for topics in topic attribute value); added name rendering (TWiki:Main.DanielRohde) |
|  v1.008 (23 Jun 2005): | added new attributes (nwidth,tcwidth,removeatwork,tablecaptionalign,headerformat); performance fixes; allowed digits in month attribute (TWiki:Main.DanielRohde) |
|  v1.007 (17 Jun 2005):  | personal icon support; new attributes (month,year); icon tooltips with dates/person/location/icon; fixed '-' bug (TWiki:Main.DanielRohde) |
|  v1.006 (16 Jun 2005): | added new features (location support; today(fg/bg)color) (TWiki:Main.DanielRohde) |
|  v1.005 (16 Jun 2005): | added new features (start date support; weekendbgcolor); fixed documentation bugs; (TWiki:Main.DanielRohde) |
|  v1.004 (14 Jun 2005): | some performance improvements; code cleanup; documentation (TWiki:Main.DanielRohde) |
|  v1.003 (13 Jun 2005): | fix plugin preference handling; rename some subroutines (TWiki:Main.DanielRohde) |
|  v1.002 (13 Jun 2005): | renders some options; fixes some documentation bugs and a white space bug (TWiki:Main.DanielRohde) |
|  v1.001 (10 Jun 2005): | A complete reimplementation with many bug fixes and some new features. (TWiki:Main.DanielRohde) |
|  v1.021 (01 Jun 2005): | Initial version (TWiki:Main.PeterJones) |
|  CPAN Dependencies: | CPAN:Date::Calc |
|  Other Dependencies: | %TWIKIWEB%.SmiliesPlugin |
|  Perl Version: | 5.0 and up|
|  TWiki:Plugins/Benchmark: | %TWIKIWEB%.GoodStyle 100%, %TWIKIWEB%.FormattedSearch 100%, %TOPIC% 99% |
|  Plugin Home: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC% |
|  Feedback: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev |
|  Appraisal: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal |

__Related Topics:__ %TWIKIWEB%.SmiliesPlugin, %TWIKIWEB%.TWikiPlugins, TWiki:Plugins.CalendarPlugin
 
-- TWiki:Main.PeterJones - 01 Jun 2005
%BR% -- TWiki:Main.DanielRohde - 10 Jun 2005
 

%META:FILEATTACHMENT{name="example.gif" attr="h" comment="Example" date="1119006048" path="example.gif" size="15447" user="rohdedan" version="1.1"}%
