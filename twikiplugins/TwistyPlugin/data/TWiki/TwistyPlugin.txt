%META:TOPICINFO{author="TWikiContributors" date="1130850299" format="1.1" version="1.2"}%
---+!! <nop>%TOPIC%

*A "twisty" is an interface element that shows and hides its content with a button.*

!TwistyPlugin gives you several options to control the appearance of a twisty:
   * use link text or buttons
   * position an icon left or right
   * remember the state at the next visit of the page
   * start the Twisty open or closed
   * start the Twisty open or closed for the first visit
   * use a span or div for the content
   * set a class for the content span or div

Twisty has a fallback mechanism in case javascript is not available: the content is displayed while the control buttons are hidden. Unless parameter =noscript="hide"= is used to specifically say the content should be hidden.

<div style="border:1px solid #ccc; padding:.5em 1em;">
*What's new in this version (1.1):*
   * Speed increase
   * New parameters:
    | *Parameter* | *Value* | *Description* | *Remark* |
    | =start= | ="hide"= or ="show"= | Initial state of the Twisty; this will override any setting stored in a cookie (see =remember=).  | optional, default no initial state |
    | =firststart= | ="hide"= or ="show"= | Initial state of the Twisty the first time the visitor gets to see the Twisty; this will NOT override cookie settings (see =remember=).  | optional, default no initial state |
    | =noscript= | ="hide"= | Make content hidden in case use does not have javascript on | optional, default content is shown with no javascript |
    | =class= | CSS class name | Class for content div or span | optional, default none |
</div>

%TOC{title="On this page:"}%

---++ Syntax Overview
---+++ Triad
A twisty consists of 3 elements:
   1 Show button
   1 Hide button
   1 Collapsing content ('Toggle')
   
The typical !TwistyPlugin triad will look like this (pseudo code):
<verbatim>
%TWISTYSHOW{}% %TWISTYHIDE{}%
(there may be other things between buttons and content)
%TWISTYTOGGLE{}% my content %ENDTWISTYTOGGLE%
</verbatim>

You must pass a unique identifier for each triad:
<verbatim>
%TWISTYSHOW{id="mytwisty"}% %TWISTYHIDE{id="mytwisty"}%
(there may be other things between buttons and content)
%TWISTYTOGGLE{id="mytwisty"}% my content %ENDTWISTYTOGGLE%
</verbatim>

---+++ Complete Twisty (simple)
<verbatim>
%TWISTYSHOW{id="complete" link="Show"}% %TWISTYHIDE{id="complete" link="Hide"}%
%TWISTYTOGGLE{id="complete" mode="div"}% my simple twisty content %ENDTWISTYTOGGLE%
</verbatim>
and that will look like this:

%TWISTYSHOW{id="complete_ex" link="Show"}% %TWISTYHIDE{id="complete_ex" link="Hide"}%
%TWISTYTOGGLE{id="complete_ex" mode="div"}% my simple Twisty content %ENDTWISTYTOGGLE%

---+++ Complete Twisty (with icons)
Complete with link text and icons:
<verbatim>
%TWISTYSHOW{id="completewithicons" link="Show" imgleft="%ICONURLPATH{toggleopen-small}%"}%
%TWISTYHIDE{id="completewithicons" link="Hide" imgleft="%ICONURLPATH{toggleclose-small}%"}%
%TWISTYTOGGLE{id="completewithicons" mode="div"}% my complete Twisty content %ENDTWISTYTOGGLE%
</verbatim>
it looks like this:

%TWISTYSHOW{id="completewithicons_ex" link="Show" imgleft="%ICONURLPATH{toggleopen-small}%"}% %TWISTYHIDE{id="completewithicons_ex" link="Hide" imgleft="%ICONURLPATH{toggleclose-small}%"}%
%TWISTYTOGGLE{id="completewithicons_ex" mode="div"}% my complete Twisty content %ENDTWISTYTOGGLE%

---+++ Make it simple
All this typing can be cut back with shorthand syntax =%<nop>TWISTY{my parameters}%= my content =%<nop>ENDTWISTY{}%=:
<verbatim>
%TWISTY{id="mytwistyshort" showlink="Show" showimg="%ICONURLPATH{toggleopen-small}%"
hidelink="Hide" hideimg="%ICONURLPATH{toggleclose-small}%"
mode="div"}%
my shorthand twisty content %ENDTWISTY%
</verbatim>

---+++ Make it remember
To store the last state in a cookie, add the parameter =remember="on"=.%BR%
Test (reload the page after toggling):
<verbatim>
%TWISTY{id="remembered" showlink="Show" hidelink="Hide" mode="div" remember="on"}% 
my remembered Twisty content %ENDTWISTY%
</verbatim>

%TWISTY{id="remembered_ex" showlink="Show" hidelink="Hide" mode="div" remember="on"}% 
my remembered Twisty content %ENDTWISTY%

---+++ Make it obey
To let the Twisty start with its content folded open, add parameter =start="show"=. Likewise use =start="hide"= to start with hidden content.

---+++ Make it obey only the first time
To let the Twisty start with its content folded open the first time the visitor sees the Twisty, add the parameter =firststart="show"=. If =remember="on"=, subsequential visits to the page will display the Twisty according the cookie setting.

---+++ Other use: hide interface parts in case of no javascript
You can use Twisty to show interface elements that will only work with javascript enabled. For instance the textbox control buttons in the edit screen need javascript to work. If a visitor does not have javascript on it would not make sense to show these buttons.

Put the "javascript content" in an almost bare bones Twisty:
<verbatim>
%TWISTY{id="controls" mode="span" noscript="hide" start="show"}%
<input type="submit" class="twikiButton" value="You surely have javascript" />
%ENDTWISTY%
</verbatim>
Do not forget to set =start="show"= to show the Twisty content at all. 

Result: %TWISTY{id="controls_ex" mode="span" noscript="hide" start="show"}%<input type="submit" class="twikiButton" value="You surely have javascript" />%ENDTWISTY%

When javascript is off, the button should be invisible.

---+++ Styling the Twisty
Use parameter =class= to style the content div or class:
<verbatim>
%TWISTY{id="styled" mode="div" class="twikiHelp" showlink="Show" hidelink="Hide"}%
Help text Twisty
%ENDTWISTY%
</verbatim>
generates: %BR%
%TWISTY{id="styled_ex" mode="div" class="twikiHelp" showlink="Show" hidelink="Hide"}%
Help text Twisty
%ENDTWISTY%

---++ Syntax in Detail

#VarTWISTY
---+++ TWISTY
*Shorthand version for TWISTYSHOW &amp; TWISTYHIDE &amp; TWISTYTOGGLE.*
This renders the button as well as the toggled content section contained within this and the closing ENDTWISTY tag.
	* Syntax: =%<nop>TWISTY{id="myid" ... }%=
    | *Parameter* | *Value* | *Description* | *Remark* |
    | =id= | Unique identifier | Used to link [[#VarTWISTYBUTTON][TWISTYBUTTON]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]] | required  |
    | =link= | Link label | The text to be used in the Twisty button link, when there is no need for separate 'hide' and 'show' buttons  | optional |
    | =hidelink= | Link label | The text to be used in the Twisty hide link  | optional |
    | =showlink= | Link label | The text to be used in the Twisty show link  | optional |
    | =mode= | ="div"= or ="span"= | Specify if the Twisty Toggle section will use a =&lt;div&gt;= or a =&lt;span&gt;= tag.  | optional, defaults to =&lt;span&gt;= |
    | =img= | Image url | Specify the url of an image that will be displayed at the *right side* of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =imgleft= | Image url | Specify the url of an image that will be displayed at the left side of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =imgright= | Image url | Specify the url of an image that will be displayed at the right side of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =hideimg= | Image url | Specify the image to be show in the Twisty hide link | optional, defaults to =img= value |
    | =showimg= | Image url | Specify the image to be show in the Twisty show link | optional, defaults to =img= value |
    | =remember= | ="on"= | When the Twisty is clicked its state is remembered the next time the page is shown.<br /> *Note:* when used, think carefully about a unique name (id) for the Twisty, otherwise the cookie that is set might affect other Twisties with the same name. Also note that only interaction is stored, not the state of the Twisty when left unclicked. | optional, defaults to forget |
    | =start= | ="hide"= or ="show"= | Initial state of the Twisty; this will override any setting stored in a cookie (see =remember=).  | optional, default no initial state |
    | =firststart= | ="hide"= or ="show"= | Initial state of the Twisty the first time the visitor gets to see the Twisty; this will NOT override cookie settings (see =remember=).  | optional, default no initial state |
    | =noscript= | ="hide"= | Make content hidden in case use does not have javascript on | optional, default content is shown with no javascript |
    | =class= | CSS class name | Class for Twisty div or span | optional, default none |
	* Related [[#VarTWISTYSHOW][TWISTYBUTTON]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]]

#VarENDTWISTY
---+++ ENDTWISTY
*Twisty closure, complements the opening TWISTY tag.*
	* Syntax: =%<nop>VarENDTWISTY%=

See [[#VarENDTWISTYTOGGLE][ENDTWISTYTOGGLE]].

#VarTWISTYBUTTON
---+++ TWISTYBUTTON
*Shorthand version for TWISTYSHOW &amp; TWISTYHIDE*
This is useful if both the show and the hide button take the same arguments.
	* Supported parameters: all parameters supported by [[#VarTWISTYSHOW][TWISTY]], except for =noscript= and =class= (only used for 'toggle' content)
	* Parameter differences:
	   * =mode=: button mode defaults to span
	* Syntax: =%<nop>TWISTYBUTTON{id="myid" ... }%=
	* Supported parameters:
    | *Parameter* | *Value* | *Description* | *Remark* |
    | =mode= | ="div"= or ="span"= | Specify if the *Twisty button* will use a =&lt;div&gt;= or a =&lt;span&gt;= tag  | optional, defaults to =&lt;span&gt;= |
	* Related: [[#VarTWISTYSHOW][TWISTYSHOW]] and [[#VarTWISTYHIDE][TWISTYHIDE]]

#VarTWISTYSHOW
---+++ TWISTYSHOW
*Show/open link*
	* Syntax: =%<nop>TWISTYSHOW{id="myid" ... }%=
	* Supported parameters:
    | *Parameter* | *Value* | *Description* | *Remark* |
    | =id= | Unique identifier | Used to link [[#VarTWISTYSHOW][TWISTYSHOW]], [[#VarTWISTYHIDE ][TWISTYHIDE ]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]] | required  |
    | =link= | Link label | The text to be used in the Twisty Show link  | optional |
    | =mode= | ="div"= or ="span"= | Specify if the Twisty Show link will use a =&lt;div&gt;= or a =&lt;span&gt;= tag  | optional, defaults to =&lt;span&gt;= |
    | =img= | Image url | Specify the url of an image that will be displayed at the *right side* of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =imgleft=| Image url | Specify the url of an image that will be displayed at the left side of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =imgright= | Image url | Specify the url of an image that will be displayed at the right side of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =remember= | ="on"= | When the Twisty is clicked its state is remembered the next time the page is shown.<br /> *Note:* when used, think carefully about a unique name (id) for the Twisty, otherwise the cookie that is set might affect other Twisties with the same name. Also note that only interaction is stored, not the state of the Twisty when left unclicked. | optional, defaults to forget |
    | =start= | ="hide"= or ="show"= | Initial state of the Twisty; this will override any setting stored in a cookie (see =remember=).  | optional, default no initial state |
    | =firststart= | ="hide"= or ="show"= | Initial state of the Twisty the first time the visitor gets to see the Twisty; this will NOT override cookie settings (see =remember=).  | optional, default no initial state |
	* Example: =%<nop>TWISTYSHOW{id="demo" link=" Click to Unfold " imgleft="%<nop>ICONURLPATH{toggleopen}%"}%=
	* Related: [[#VarTWISTYHIDE][TWISTYHIDE]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]]

#VarTWISTYHIDE
---+++ TWISTYHIDE
*Hide/close link*
	* Syntax: =%<nop>TWISTYHIDE{id="myid" ... }%=
	* Supported parameters:
    | *Parameter* | *Value* | *Description* | *Remark* |
    | =id= | Unique identifier | Used to link [[#VarTWISTYSHOW][TWISTYSHOW]], [[#VarTWISTYHIDE ][TWISTYHIDE ]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]] | required  |
    | =link= | Link label | The text to be used in the Twisty Hide link  | optional |
    | =mode= | ="div"= or ="span"= | Specify if the Twisty Hide link will use a =&lt;div&gt;= or a =&lt;span&gt;= tag  | optional, defaults to =&lt;span&gt;= |
    | =img= | Image url | Specify the url of an image that will be displayed at the *right side* of the link. <br />You may use [[%TWIKIWEB%.TWikiVariables#VarICONURLPATH][ICONURLPATH]] to display one of the %TWIKIWEB%.TWikiDocGraphics icons. Alternatively use an image attached to the topic. | optional, defaults to no image |
    | =remember= | ="on"= | When the Twisty is clicked its state is remembered the next time the page is shown.<br /> *Note:* when used, think carefully about a unique name (id) for the Twisty, otherwise the cookie that is set might affect other Twisties with the same name. Also note that only interaction is stored, not the state of the Twisty when left unclicked. | optional, defaults to forget |
    | =start= | ="hide"= or ="show"= | Initial state of the Twisty; this will override any setting stored in a cookie (see =remember=).  | optional, default no initial state |
    | =firststart= | ="hide"= or ="show"= | Initial state of the Twisty the first time the visitor gets to see the Twisty; this will NOT override cookie settings (see =remember=).  | optional, default no initial state |
	* Example: =%<nop>TWISTYHIDE{id="demo" link=" Click to Fold " imgleft="%<nop>ICONURLPATH{toggleclose}%"}%=
	* Related: [[#VarTWISTYSHOW][TWISTYSHOW]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]]

#VarTWISTYTOGGLE
---+++ TWISTYTOGGLE
*Twisty Toggle contents section*
	* Syntax: =%<nop>TWISTYTOGGLE{id="myid"}%=
	* Supported parameters:
    | *Parameter* | *Value* | *Description* | *Remark* |
    | =id= | Unique identifier | Used to link [[#VarTWISTYSHOW][TWISTYSHOW]], [[#VarTWISTYHIDE ][TWISTYHIDE ]] and [[#VarTWISTYTOGGLE][TWISTYTOGGLE]].  | required  |
    | =mode= | ="div"= or ="span"= | Specify if the Twisty Toggle section will use a =&lt;div&gt;= or a =&lt;span&gt;= tag.  | optional, defaults to =&lt;span&gt;= |
    | =class= | CSS class name | Class for content div or span | optional, default none |
    | =remember= | ="on"= | When the Twisty is clicked its state is remembered the next time the page is shown.<br /> *Note:* when used, think carefully about a unique name (id) for the Twisty, otherwise the cookie that is set might affect other Twisties with the same name. Also note that only interaction is stored, not the state of the Twisty when left unclicked. | optional, defaults to forget |
    | =start= | ="hide"= or ="show"= | Initial state of the Twisty; this will override any setting stored in a cookie (see =remember=).  | optional, default no initial state |
    | =firststart= | ="hide"= or ="show"= | Initial state of the Twisty the first time the visitor gets to see the Twisty; this will NOT override cookie settings (see =remember=).  | optional, default no initial state |
    | =noscript= | ="hide"= | Make content hidden in case use does not have javascript on | optional, default content is shown with no javascript |
	* Example: =%<nop>TWISTYTOGGLE{id="demo" mode="div" remember="on"}%My content%<nop>ENDTWISTYTOGGLE%=
	* Related: [[#VarTWISTYHIDE][TWISTYHIDE]], [[#VarTWISTYHIDE][TWISTYHIDE]] an [[#VarENDTWISTYTOGGLE][ENDTWISTYTOGGLE]]

#VarENDTWISTYTOGGLE
---+++ ENDTWISTYTOGGLE
*The Twisty closure*
	* Syntax: =%<nop>ENDTWISTYTOGGLE%=
		* Will end the most inner unclosed Twisty Toggle section, using the proper tag
	* Example: =%<nop>ENDTWISTYTOGGLE%=
	* Related: [[#VarTWISTYTOGGLE][TWISTYTOGGLE]]

---++ The Fine Print

!TwistyPlugin is a convenience plugin for TWiki:Plugins.TwistyContrib.

It has two major features:
	* When active, the Twisty javascript library is included in every topic
	* Provides a convenience syntax to define Twisty areas

---++ Plugin Settings

Plugin settings are stored as preferences variables. To reference
a plugin setting write ==%<nop>&lt;plugin&gt;_&lt;setting&gt;%==, i.e. ==%<nop>TWISTYPLUGIN_SHORTDESCRIPTION%==

	* Set SHORTDESCRIPTION = Twisty section javascript library to open/close content dynamically
	* Set DEBUG = 0

---++ Plugin Installation Instructions
	* Download the ZIP file from the Plugin web (see below)
	* Unzip ==%TOPIC%.zip== in your root ($TWIKI_ROOT) directory. Content:
   | *File:* | *Description:* |
%$MANIFEST%
	* Optionally, if it exists, run ==%TOPIC%_installer== to automatically check and install other TWiki modules that this module depends on. You can also do this step manually.
	* Alternatively, manually make sure the dependencies listed in the table below are resolved.
   %$DEPENDENCIES%
	* (Dakar) Visit =configure= in your TWiki installation, and enable the plugin in the {Plugins} section.


---++ Plugin Info

| Authors: | TWiki:Main.RafaelAlvarez, TWiki:Main.ArthurClemens |
| Copyright &copy;: | 2005 Rafael Alvarez, 2006 Arthur Clemens |
| License: | [[http://www.gnu.org/copyleft/gpl.html][GPL]] |
| Dependencies: | %$DEPENDENCIES% |
| 11 June 2006 | 1.100 Added parameters =start=, =firststart=, =noscript= and =class=; complete javascript rewrite for speed |
| 12 Sep 2005 | 1.000 First Version |
| Home: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC% |
| Feedback: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev |
| Appraisal: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Appraisal |
