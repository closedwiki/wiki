%META:TOPICINFO{author="TWikiGuest" date="1092070800" format="1.0" version="1.1"}%
%META:TOPICPARENT{name="Main.MartinCleaver"}%
---+!! TWiki Release Tracker Plugin

This plugin tells you exactly how your install differs from every production and beta release of TWiki.

If you find it useful, please send me (Martin AT Cleaver.org) a note of thanks. 
Donations towards the beer fund can be sent to the same paypal address.

%TOC%

---++ Settings
One line description, is shown in the TextFormattingRules topic: 
		* Set SHORTDESCRIPTION = Plugin telling you how similar your install is to past releases of TWiki 

See the Parameters section for descriptions of the rest of these:
		* Set STATUSFILTER = FSCD,FDCS,FDCM
		* Set FROM = localInstallation
		* Set TO = ,

---+++ Checking against particular versions

The TRT is shipped with data about many versions of TWiki. By default it compares that specified by 
the WIKIVERSION variable against your local installation but it can also do a multi-dimensional comparison

---++ Features and Benefits
	* By generating a content identifier for every file in all TWiki distributions (core beta and release versions, plus all the plugins), the system advises where every file in your install has come from.
	* By providing navigation from installation file content to distribution file content, the system provides the means to generate diffs from your install to a distro. This means that not only can you tell where your version is behind a distribution, but also shows you where you have altered your version. The downloadable diff provides the opportunity to feed back to the TWiki community the change you've made back, meaning for the patch owner less rework the next time TWiki is released and, for the community as a whole, better capture of changes leading to more progress .

---++ How it works
The TRT centres on the concept of a unique CONTENT identifier - instead of identifying a file *by its filename*, identities are based on *file content*. This means that a file copied to another place has the same unique content identifier. The system used md5 signatures as the identifier.


The system is comprised of two parts:
	1 a twiki plugin that provides a web interface to the API of the comparator.
		Unlike previoius versions, this one includes in situ building of indexes for the local machine using the web interface.
	1 a command line indexer that builds and saves indexes. This is used to generate the md5 files included in pub/TWiki/TWikiReleaseTrackerPlugin

---++ Set up
	* %SCRIPTURL%/view%SCRIPTSUFFIX%/TWiki/TRTChangesFromDistribution?mode=indexLocalInstallation

---++ Testing
	1 Even before you have built the index for your own installation, you can use the TRT to determine what changes were made between versions: %SCRIPTURL%/view%SCRIPTSUFFIX%/TWiki/TRTChangesFromDistribution?from=TWiki19990901&to=TWiki20000501&statusFilter=all <!-- N.B. use of TWiki/ not TWiki. because athens did not support its use -->
	2 Ensure you have built your index (see above)
	3 Run %SCRIPTURL%/view%SCRIPTSUFFIX%/TWiki/TRTChangesFromDistribution?from=localInstallation&statusFilter=FSCD ; pick the appropriate 'to' parameter 


---++ Parameters

	* The page TRTChangesFromDistribution has a GUI that sets up some useful default parameters (overriding the defaults listed on this page). All parameters specified below can also be overridden on the URL line.

All parameters can be sourced from one of three places:
	1 Defaults listed on the plugin home page
	2 Parameters specified on the %DIFFWIKI{} line
	3 Parameters recognised as a CGI.pm parameter (e.g. on the URL line)

---+++ Parameters to the %DIFFWIKI directive

| *Parameter name* | *Values* | *Default* |
| *Mode = listing* | listing, file | listing |
| fscsFormat | string to show when file is FSCS | &pipe; $relativeFile &pipe; FSCS &pipe; $locations &pipe; |
| fscdFormat | string to show when file is FSCS | &pipe; $relativeFile &pipe; FSCDCALLBACK &pipe; FSCDDIST &pipe; |
| - | FSCDDIST, FSCDCALLBACK and FDCSDIFF have interesting effects in this setting |
| fdcsFormat | | &pipe; $relativeFile &pipe; FDCS &pipe; $locations &pipe; |
| fdcdFormat | | &pipe; ($relativeFile name not recognised, and no content match)  &pipe; FDCD &pipe; &pipe; |
| fdcmFormat | | &pipe; $relativeFile &pipe; FSCM &pipe; $locations &pipe; |
| headerFormat | | &pipe; *File* &pipe; *Status* &pipe; *Also Occurs In* &pipe; |
| from | TWiki distribution name (e.g. TWiki20011201), or the string 'localInstallation' | localInstallation |
| to | (see "from") | , - this says match against all distributions |
| indexTopic | topic containing the md5 files | defaults to the plugin page |
| debug | on, off, 2 | off |
| statusFilter | "FSCS,FSCD,FSCM,FDCS,FDCD,all" (Filename Same/Different, Content Same/Matches (other dist)/Different) | FDCD,FSCS,FDCM |
| *Mode = file* |  ||
| file | filename to compare | - |
| *Mode = dumpIndex* | Shows indexes loaded | - |
| *Mode = indexLocalDistribution* | Regenerates the localInstallation.md5 file, use after modifying files | |

---+++ Parameters to the %DIFFWIKI directive

---++ Limitations
| *Issue* | *Future Plan* | *Impact* |
| To compare specific file changes (FSCD = File Same, Content Different), you need to have pre-downloaded all of the releases. | My plan is to have the plugin pull them down as needed, but I need a web address for a specific twiki version / file; currently this is not available (partly due to the switch to subversion) | High - file mode not yet functional |
| The MD5 for specific releases (i.e. releases.md5) needs pregenerating. | Release the code (actually a merge for the TWiki:Codev.SharedCode) when I have cleaned it up | Low - releases are not very often |
| If you want an unspecified destination (to) or source (from) distro you must set the param to "," | check for undef, not "" | Medium - ugly non-obvious workaround available |
| The results are not sorted | sort them | Low - workaround available: Use table sort function |
| The underlying data structures could do with some optimisation | Review | Low - Page load is slow in some cases |

---++ Future plans
	* Make the TRT detect inconsistent indexes and offer to regenerate the localInstallation md5 file if necessary
	* Make test suite TWiki:Plugins.BuildContrib <nop>TestRunner compatible
	* Make use of TWiki:Plugins.AttrsContrib
	* Investigate why the -w flag to diff is necessary
	* md5 files will be pulled from a server rather than distributed

---++ Manifest
%$MANIFEST%

---++ Plugin Info

|  Plugin Author: | TWiki:Main.MartinCleaver |
|  Plugin Version: | %$DATE% (%$VERSION%) |
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
|  25 Aug 2004: | Diff is now passed the -w flag to ignore whitespace changes | 
|  24 Aug 2004: | Bugfix when comparing two arbitrary versions |
|  23 Aug 2004: | First standalone version, this no longer requires download of zips to do comparisons against |
|  01 Aug 2004: | Initial version |
|  TWiki Dependency: | %$DEPENDENCIES% |
|  CPAN Dependencies: | none |
|  Other Dependencies: | none |
|  Perl Version: | 5.005 |
|  TWiki:Plugins/Benchmark: | %TWIKIWEB%.GoodStyle nn%, %TWIKIWEB%.FormattedSearch nn%, %TOPIC% nn% |
|  Plugin Home: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC% |
|  Feedback: | http://TWiki.org/cgi-bin/view/Plugins/%TOPIC%Dev |

__Related Topics:__ %TWIKIWEB%.TWikiPreferences, %TWIKIWEB%.TWikiPlugins

If you have comments or questions, please put them at TWiki:Plugins.TWikiReleaseTrackerPluginDev
%META:FILEATTACHMENT{name="localInstallation.md5" attr="" comment="" date="1090726845" path="There no API to add attachments from plugins, so I hacked it" size="592" user="MartinCleaver" version="1.1"}%
%META:FILEATTACHMENT{name="releases.md5" attr="" comment="" date="1090726845" path="There no API to add attachments from plugins, so I hacked it" size="592" user="MartinCleaver" version="1.1"}%
%META:FILEATTACHMENT{name="plugins.md5" attr="" comment="" date="1090726845" path="There no API to add attachments from plugins, so I hacked it" size="592" user="MartinCleaver" version="1.1"}%
