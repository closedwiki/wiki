---+!! !UpdateAttachmentsPlugin
<!--
One line description, required for extensions repository catalog.
   * Set SHORTDESCRIPTION = A batched alternative to AutoAttachments (adds and removes attachements)
-->
%SHORTDESCRIPTION%

%TOC%

---++ Usage

This plugin provides a rest handler that can replace the inbuilt ={AutoAttachPubFiles}= functionality with a batched update.

Doing this may provide a speed advantage as it will remove the need for TWiki to scan the requested topics' attachment directory.

Also, it will (optionally) remove attachment references to files that no longer exist in the topic's attachment directory.

Warning: because TWiki does deal well with attachments with special characters (or even spaces) in them, these will be ignored on update.

Warning: checking 28500 topics (many with attachments) takes around 2-3 minutes on my test system, with no plugins that have an beforeSave or afterSave handler registered.

---+++ Triggering an Attachement Update
As this is a TWiki.RestHandler based plugin, you can trigger it to run from a suitably authenticated url (it will only update topics
your user as permission to edit) - for example, to update the Sandbox web
   * %SCRIPTURL{rest}%/UpdateAttachmentsPlugin/update?topic=Sandbox.WebHome

Or using a cronjob - make sure the cronjob is running as the same user as twiki's web access is
   * =./rest UpdateAttachmentsPlugin.update topic Sandbox.WebHome=
   
(if you get a 500 or premature end of script error, chances are your current user does not have permission to change the web or topics)

---++ Settings
These settings are in the configure web interface in the <nop>Update Attachments Plugin section of [[%SCRIPTURL{configure}%][configure]].
   * =$TWiki::cfg{Plugins}{UpdateAttachmentsPlugin}{RemoveMissing}= - will remove attachment references in a topic that no longer exist
   * =$TWiki::cfg{Plugins}{UpdateAttachmentsPlugin}{UseDangerousNoHandlersSave}= - use with extreme caution, _if_ you understand what the results of a no_handler save are, and _if_ you are able to recover your TWiki if it fails.
   * =$TWiki::cfg{Plugins}{UpdateAttachmentsPlugin}{Debug}= - to see what topics are updated (edit LocalSite.cfg by hand to add this setting).
   
It is recomended to disable $TWiki::cfg{AutoAttachPubFiles}.

---++ Installation Instructions

This plugin _may_ not function correctly if =$TWiki::cfg{AutoAttachPubFiles}= is on, predominantly on the WebHome and WebPreferences topics.

%$INSTALL_INSTRUCTIONS%

---++ Plugin Info

|  Plugin Author(s): | TWiki:Main.SvenDowideit - SvenDowideit@distributedINFORMATION.com a [[http://WikiRing.com][WikiRing]] founding partner  |
|  Copyright: | &copy; SvenDowideit@distributedINFORMATION.com |
|  License: | [[http://www.gnu.org/licenses/gpl.html][GPL (Gnu General Public License)]] |
|  Plugin Version: | %$VERSION% |
|  Change History: | <!-- versions below in reverse order -->&nbsp; |
|  initial release: | November 2007 |
|  Dependencies: | %$DEPENDENCIES% |
|  Plugin Home: | http://twiki.org/cgi-bin/view/Plugins/UpdateAttachmentsPlugin |
|  Feedback: | http://twiki.org/cgi-bin/view/Plugins/UpdateAttachmentsPluginDev |
|  Appraisal: | http://twiki.org/cgi-bin/view/Plugins/UpdateAttachmentsPluginAppraisal |

__Related Topics:__ %TWIKIWEB%.TWikiPlugins, %TWIKIWEB%.DeveloperDocumentationCategory, %TWIKIWEB%.AdminDocumentationCategory, %TWIKIWEB%.TWikiPreferences

<!-- Do _not_ attempt to edit this topic; it is auto-generated. Please add comments/questions/remarks to the feedback topic on twiki.org instead. -->
